{"version":3,"sources":["webpack:///./node_modules/terriajs-cesium/Source/Core/CornerType.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeProperty.js","webpack:///./node_modules/terriajs-cesium/Source/Scene/ColorBlendMode.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositePositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ReferenceProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ScaledPositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PositionPropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/Core/HermitePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/LagrangePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/Spherical.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CheckerboardMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/GridMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineArrowMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineDashMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineOutlineMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/Rotation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeOrientation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityVectorProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityOrientationProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CzmlDataSource.js","webpack:///./node_modules/terriajs-cesium/Source/ThirdParty/Autolinker.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlCamera.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlLookAt.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTour.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourFlyTo.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourWait.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlDataSource.js"],"names":["Object","ROUNDED","MITERED","BEVELED","CompositeProperty","this","_eventHelper","_definitionChanged","_intervals","changedEvent","addEventListener","prototype","_intervalsChanged","defineProperties","isConstant","get","isEmpty","definitionChanged","intervals","getValue","time","result","innerProperty","findDataForIntervalContainingDate","equals","other","property","eventHelper","callback","raiseEvent","items","removeAll","length","i","interval","data","indexOf","add","subscribeAll","ColorBlendMode","HIGHLIGHT","REPLACE","MIX","colorBlendMode","colorBlendAmount","clamp","EPSILON4","CompositePositionProperty","referenceFrame","_referenceFrame","FIXED","_composite","_raiseDefinitionChanged","set","value","getValueInReferenceFrame","resolve","that","targetProperty","_targetProperty","targetEntity","_targetEntity","_targetCollection","getById","_targetId","undefined","ReferenceProperty","_onTargetEntityDefinitionChanged","targetPropertyNames","_targetPropertyNames","len","targetCollection","targetId","collectionChanged","_onCollectionChanged","target","resolvedProperty","fromString","referenceString","identifier","values","inIdentifier","isEscaped","token","c","charAt","push","getType","names","otherNames","name","oldValue","collection","added","removed","removeEventListener","ScaledPositionProperty","_value","_removeSubscription","setValue","WGS84","scaleToGeodeticSurface","PositionPropertyArray","Array","x","itemValue","slice","arrayEquals","factorial","calculateCoefficientTerm","zIndices","xTable","derivOrder","termOrder","reservedIndices","reserved","j","splice","HermitePolynomialApproximation","type","degree","inputOrder","defaultValue","Math","max","floor","yTable","yStride","d","s","index","defined","coefficients","l","zIndicesLength","highestNonZeroCoef","nonZeroCoefficients","numerator","zj","zn","tempTerm","coeff","arrayScratch","interpolate","outputOrder","resultLength","r","zIndiceslength","highestNonZero","tmp","dimOne","coefIndex","dimTwo","coefficient","dimTwoMinusOne","fillCoefficientList","loopStop","min","coef","LagrangePolynomialApproximation","diffX","Spherical","clock","cone","magnitude","fromCartesian3","cartesian3","y","z","radialSquared","atan2","sqrt","clone","spherical","normalize","left","right","equalsEpsilon","epsilon","abs","toString","defaultEvenColor","Color","WHITE","defaultOddColor","BLACK","defaultRepeat","Cartesian2","CheckerboardMaterialProperty","options","EMPTY_OBJECT","Event","_evenColor","_evenColorSubscription","_oddColor","_oddColorSubscription","_repeat","_repeatSubscription","evenColor","oddColor","repeat","Property","createPropertyDescriptor","lightColor","getValueOrClonedDefault","darkColor","getValueOrDefault","CompositeMaterialProperty","defaultColor","defaultLineCount","defaultLineOffset","defaultLineThickness","GridMaterialProperty","_color","_colorSubscription","_cellAlpha","_cellAlphaSubscription","_lineCount","_lineCountSubscription","_lineThickness","_lineThicknessSubscription","_lineOffset","_lineOffsetSubscription","color","cellAlpha","lineCount","lineThickness","lineOffset","PolylineArrowMaterialProperty","defaultGapColor","TRANSPARENT","PolylineDashMaterialProperty","_gapColor","_gapColorSubscription","_dashLength","_dashLengthSubscription","_dashPattern","_dashPatternSubscription","gapColor","dashLength","dashPattern","defaultOutlineColor","PolylineOutlineMaterialProperty","_outlineColor","_outlineColorSubscription","_outlineWidth","_outlineWidthSubscription","outlineColor","outlineWidth","PropertyArray","EventHelper","packedLength","pack","array","startingIndex","unpack","convertPackedArrayForInterpolation","packedArray","lastIndex","previousValue","PI","TWO_PI","unpackInterpolationResult","sourceArray","firstIndex","HORIZONTAL","VERTICAL","defaultOrientation","StripeMaterialProperty","_orientation","_orientationSubscription","_offset","_offsetSubscription","orientation","offset","horizontal","VelocityVectorProperty","position","_position","_subscription","_normalize","position1Scratch","Cartesian3","position2Scratch","timeScratch","JulianDate","_getValue","velocityResult","positionResult","ZERO","position1","position2","addSeconds","velocity","subtract","divideByScalar","VelocityOrientationProperty","ellipsoid","_velocityVectorProperty","_ellipsoid","Ellipsoid","positionScratch","velocityScratch","rotationScratch","Matrix3","Transforms","rotationMatrixFromPositionVelocity","Quaternion","fromRotationMatrix","currentId","UnitCartesian3","createReferenceProperty","entityCollection","createSpecializedProperty","packetData","reference","velocityReference","referenceProperty","RuntimeError","JSON","stringify","scratchCartesian","scratchSpherical","scratchCartographic","Cartographic","scratchTimeInterval","TimeInterval","scratchQuaternion","unwrapUriInterval","czmlInterval","sourceUri","uri","getDerivedResource","url","Resource","createIfNeeded","unwrapCartesianInterval","cartesian","cartesianVelocity","unitCartesian","unitSpherical","fromSpherical","convertUnitSphericalToCartesian","convertSphericalToCartesian","cartographicRadians","longitude","latitude","height","cartographicToCartesian","convertCartographicRadiansToCartesian","cartographicDegrees","toRadians","convertCartographicDegreesToCartesian","normalizePackedCartesianArray","normalizePackedQuaternionArray","getPropertyType","Boolean","Number","String","hasOwnProperty","BoundingRectangle","ArcType","ClassificationType","CornerType","HeightReference","HorizontalOrigin","LabelStyle","NearFarScalar","DistanceDisplayCondition","ShadowMode","Rectangle","Uri","VerticalOrigin","unwrapInterval","arcType","boundingRectangle","cartesian2","unwrapUnitCartesianInterval","rgbaf","rgba","byteToFloat","unwrapColorInterval","classificationType","cornerType","heightReference","horizontalOrigin","Image","fromIso8601","date","labelStyle","number","nearFarScalar","distanceDisplayCondition","object","unitQuaternion","unwrapQuaternionInterval","wsen","wsenDegrees","unwrapRectangleInterval","shadowMode","shadows","string","stripeOrientation","verticalOrigin","interpolators","HERMITE","LAGRANGE","LINEAR","LinearApproximation","updateInterpolationSettings","interpolationAlgorithm","interpolationDegree","setInterpolationOptions","forwardExtrapolationType","ExtrapolationType","forwardExtrapolationDuration","backwardExtrapolationType","backwardExtrapolationDuration","iso8601Scratch","iso8601","intervalFromString","intervalString","wrapPropertyInInfiniteInterval","Iso8601","MAXIMUM_INTERVAL","convertPropertyToComposite","composite","addInterval","convertPositionPropertyToComposite","processProperty","propertyName","constrainedInterval","unwrappedInterval","unwrappedIntervalLength","combinedInterval","intersect","isValue","hasInterval","delete","removePropertyData","SampledProperty","removeSamples","TimeIntervalCollectionProperty","removeInterval","intersection","isSampled","needsUnpacking","epoch","packetEpoch","addSamplesPackedArray","ConstantProperty","findInterval","processPacketData","isArray","processPositionProperty","numberOfDerivatives","removePositionPropertyData","SampledPositionProperty","TimeIntervalCollectionPositionProperty","ReferenceFrame","ConstantPositionProperty","processPositionPacketData","processMaterialProperty","existingMaterial","existingInterval","materialData","thisIntervals","start","stop","solidColor","ColorMaterialProperty","grid","image","ImageMaterialProperty","transparent","stripe","polylineOutline","polylineGlow","PolylineGlowMaterialProperty","glowPower","taperPower","polylineArrow","polylineDash","checkerboard","processMaterialPacketData","processReferencesArrayPacketData","references","PropertyArrayType","CompositePropertyArrayType","properties","map","processArrayPacketData","processArray","processPositionArrayPacketData","unpackArray","fromRadiansArrayHeights","fromDegreesArrayHeights","processPositionArray","unpackCartesianArray","unpackCartographicRadiansArray","unpackCartographicDegreesArray","processPositionArrayOfArraysPacketData","referenceArray","tempObj","positions","processNodeTransformations","model","nodeTransformationsData","nodeTransformations","nodeNames","keys","nodeName","nodeTransformationData","PropertyBag","hasProperty","addProperty","nodeTransformation","NodeTransformationProperty","translation","rotation","scale","processArticulations","articulationsData","articulations","key","articulationStageData","PolygonHierarchyProperty","polygon","adaptFollowSurfaceToArcType","followSurface","GEODESIC","NONE","processCzmlPacket","packet","updaterFunctions","dataSource","objectId","id","createGuid","_version","removeById","version","tokens","split","documentPacket","_documentPacket","clockPacket","currentTime","range","step","multiplier","processDocument","entity","getOrCreateEntity","parentId","parent","load","czml","clear","promise","credit","Credit","_credit","fetchJson","resourceCredits","_resourceCredits","credits","DataSource","setLoading","when","_entityCollection","DocumentPacket","CzmlDataSource","_processCzml","raiseChangedEvent","_clock","availability","computeAvailability","MINIMUM_VALUE","startTime","stopTime","totalSeconds","secondsDifference","round","DataSourceClock","clockRange","ClockRange","LOOP_STOP","clockStep","ClockStep","SYSTEM_CLOCK_MULTIPLIER","MAXIMUM_VALUE","updateClock","_name","getFilenameFromUri","getUrlComponent","_changed","loadCzml","otherwise","error","_error","console","log","reject","_isLoading","_loading","EntityCollection","_entityCluster","EntityCluster","_positions","holes","_holes","holePositions","PolygonHierarchy","entities","isLoading","errorEvent","loadingEvent","show","clustering","updaters","billboardData","billboard","BillboardGraphics","pixelOffset","eyeOffset","processAlignedAxis","alignedAxis","sizeInMeters","width","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","disableDepthTestDistance","boxData","box","BoxGraphics","dimensions","fill","material","outline","corridorData","corridor","CorridorGraphics","extrudedHeight","extrudedHeightReference","granularity","zIndex","cylinderData","cylinder","CylinderGraphics","topRadius","bottomRadius","numberOfVerticalLines","slices","ellipseData","ellipse","EllipseGraphics","semiMajorAxis","semiMinorAxis","stRotation","ellipsoidData","EllipsoidGraphics","radii","innerRadii","minimumClock","maximumClock","minimumCone","maximumCone","stackPartitions","slicePartitions","subdivisions","labelData","label","LabelGraphics","text","font","style","showBackground","backgroundColor","backgroundPadding","fillColor","modelData","ModelGraphics","gltf","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","silhouetteColor","silhouetteSize","nameData","descriptionData","description","pathData","path","PathGraphics","leadTime","trailTime","resolution","pointData","point","PointGraphics","pixelSize","polygonData","PolygonGraphics","processPositionArrayOfArrays","hierarchy","perPositionHeight","closeTop","closeBottom","polylineData","polyline","adapterFunction","PolylineGraphics","depthFailMaterial","clampToGround","CallbackProperty","propertiesData","propertyData","rectangleData","rectangle","RectangleGraphics","coordinates","positionData","tilesetData","tileset","Cesium3DTilesetGraphics","maximumScreenSpaceError","viewFromData","viewFrom","wallData","wall","WallGraphics","minimumHeights","maximumHeights","orientationData","TimeIntervalCollection","process","Autolinker","arr","element","remove","fn","throwUnhandledCaseError","theValue","Error","HtmlTag","cfg","tagName","attrs","innerHTML","whitespaceRegex","innerHtml","setTagName","getTagName","setAttr","attrName","attrValue","getAttrs","getAttr","setAttrs","assign","setClass","cssClass","addClass","newClass","classAttr","getClass","classes","newClasses","shift","join","removeClass","removeClasses","idx","hasClass","setInnerHTML","html","setInnerHtml","getInnerHTML","getInnerHtml","toAnchorString","attrsStr","buildAttrsStr","attrsArr","prop","AnchorTagBuilder","newWindow","truncate","className","build","match","createAttrs","processAnchorText","getAnchorText","getAnchorHref","createCssClass","returnClasses","cssClassSuffixes","getCssClassSuffixes","anchorText","doTruncate","truncateLength","truncateLocation","location","truncateLen","ellipsisChars","ellipsisLengthBeforeParsing","ellipsisLength","buildUrl","urlObj","scheme","host","query","fragment","buildSegment","segment","remainingAvailableLength","remainingAvailableLengthHalf","startOffset","ceil","endOffset","end","substr","availableLength","urlSub","parse_url","matchQuery","replace","str","pathAndQuery","truncateSmart","truncateMiddle","substring","ellipsis","truncateEnd","Match","__jsduckDummyDocProp","matchedText","tagBuilder","getMatchedText","setOffset","getOffset","buildTag","extendStatics","b","setPrototypeOf","__proto__","p","__extends","__","constructor","create","__assign","t","n","arguments","call","apply","EmailMatch","_super","_this","email","getEmail","HashtagMatch","serviceName","hashtag","getServiceName","getHashtag","MentionMatch","mention","getMention","PhoneMatch","plusSign","getPhoneNumber","getNumber","UrlMatch","urlMatchType","protocolUrlMatch","protocolRelativeMatch","stripPrefix","www","stripTrailingSlash","decodePercentEncoding","schemePrefixRegex","wwwPrefixRegex","protocolRelativeRegex","protocolPrepended","getUrlMatchType","getUrl","stripProtocolRelativePrefix","stripSchemePrefix","stripWwwPrefix","removeTrailingSlash","removePercentEncoding","preProcessedEntityAnchorText","decodeURIComponent","e","Matcher","letterRe","digitRe","whitespaceRe","quoteRe","controlCharsRe","alphaCharsStr","source","alphaCharsAndMarksStr","decimalNumbersStr","alphaNumericCharsStr","alphaNumericAndMarksCharsStr","ipStr","domainLabelStr","getDomainLabelStr","group","getDomainNameStr","domainNameCharRegex","RegExp","tldRegex","EmailMatcher","localPartCharRegex","strictTldRegex","parseMatches","matches","noCurrentEmailMatch","CurrentEmailMatch","mailtoTransitions","charIdx","state","currentEmailMatch","char","stateNonEmailAddress","stateMailTo","stateLocalPart","stateLocalPartDot","stateAtSign","stateDomainChar","stateDomainHyphen","stateDomainDot","captureMatchIfValidAndReset","beginEmailMatch","test","prevChar","hasMailtoPrefix","resetToNonEmailMatchState","hasDomainDot","newState","emailAddress","emailAddressNormalized","pop","toLowerCase","doesEmailHaveValidTld","UrlMatchValidator","isValid","urlMatch","isValidUriScheme","urlMatchDoesNotHaveProtocolOrDot","urlMatchDoesNotHaveAtLeastOneWordChar","isValidIpAddress","containsMultipleDots","uriSchemeMatch","newRegex","hasFullProtocolRegex","ipRegex","stringBeforeSlash","uriSchemeMatchArr","uriSchemeRegex","uriScheme","hasWordCharAfterProtocolRegex","UrlMatcher","urlSuffixRegex","matcherRegex","wordCharRegExp","_loop_1","matchStr","schemeUrlMatch","wwwUrlMatch","wwwProtocolRelativeMatch","tldProtocolRelativeMatch","this_1","matchHasUnbalancedClosingParen","pos","matchHasInvalidCharAfterTld","foundCommonScheme","find","commonScheme","indexOfSchemeStart","exec","startChar","endChar","numOpenBraces","res","HashtagMatcher","nonWordCharRegex","PhoneMatcher","cleanNumber","before","after","contextClear","testMatch","MentionMatcher","matcherRegexes","parseHtml","_a","onOpenTag","onCloseTag","onText","onComment","onDoctype","noCurrentTag","CurrentTag","currentDataIdx","currentTag","stateData","stateTagOpen","stateEndTagOpen","stateTagName","stateBeforeAttributeName","stateAttributeName","stateAfterAttributeName","stateBeforeAttributeValue","stateAttributeValueDoubleQuoted","stateAttributeValueSingleQuoted","stateAttributeValueUnquoted","stateAfterAttributeValueQuoted","stateSelfClosingStartTag","toUpperCase","resetToDataState","stateCommentStart","stateCommentStartDash","stateComment","stateCommentEndDash","stateCommentEnd","stateCommentEndBang","stateDoctype","startNewTag","isClosing","isOpening","captureTagName","emitTagAndPreviousTextNode","textBeforeTag","startIdx","urls","phone","replaceFn","context","matchers","normalizeUrlsCfg","normalizeStripPrefixCfg","normalizeTruncateCfg","link","textOrHtml","parse","schemeMatches","wwwMatches","tldMatches","dest","src","defaults","POSITIVE_INFINITY","skipTagNames","skipTagsStackCount","textSplit","splitRegex","global","lastIdx","splitAndCapture","currentOffset_1","forEach","splitText","textNodeMatches","parseText","compactMatches","removeUnwantedMatches","sort","a","matchedTextLength","endIdx","removeIdx","m","getMatchers","numMatchers","textMatches","numTextMatches","newHtml","createMatchReturnVal","replaceFnResult","getTagBuilder","matcher","Email","Hashtag","Mention","Phone","Url","factory","headingPitchRoll","headingPitchRange","KmlTour","playlistIndex","playlist","tourStart","tourEnd","entryStart","entryEnd","_activeEntries","cancelAllEntries","activeEntries","entry","playEntry","viewer","cameraOptions","allDone","_playNext","playNext","bind","blocking","play","scene","camera","tour","indx","terminated","addPlaylistEntry","KmlTourFlyTo","duration","flyToMode","view","activeCamera","activeCallback","done","self","getCameraOptions","flyTo","BoundingSphere","flyToBoundingSphere","cancelFlight","complete","easingFunction","EasingFunction","LINEAR_NONE","destination","combine","KmlTourWait","timeout","setTimeout","clearTimeout","parser","MimeTypes","avi","bmp","bz2","chm","css","csv","doc","dvi","eps","flv","gif","gz","htm","ico","jnlp","jpeg","jpg","m3u","m4v","mathml","mid","midi","mov","mp3","mp4","mp4v","mpeg","mpg","odp","ods","odt","ogg","pdf","png","pps","ppt","ps","qt","rdf","rss","rtf","svg","swf","tif","tiff","txt","wav","wma","wmv","xml","zip","detectFromFilename","filename","ext","getExtensionFromUri","DOMParser","autolinker","kmlNamespaces","gxNamespaces","namespaces","kml","gx","atom","kmlgx","concat","featureTypes","Document","Folder","node","processingData","deferredLoading","processFeature","newProcessingData","parentEntity","Placemark","placemark","styleEntity","hasGeometry","childNodes","childNode","item","geometryProcessor","geometryTypes","localName","merge","processPositionGraphics","NetworkLink","networkEntity","sourceResource","uriResolver","queryFirstNode","viewRefreshMode","viewBoundScale","href","queryStringValue","newSourceUri","resolveHref","defaultViewFormat","viewFormat","httpQuery","setQueryParameters","queryToObject","cleanupString","processNetworkLinkQueryString","_camera","_canvas","_lastCameraView","bbox","networkLinkCollection","then","rootElement","newEntities","suspendEvents","newEntity","mergeAvailabilityWithParent","resumeEvents","refreshMode","refreshInterval","queryNumericValue","networkLinkControl","hasNetworkLinkControl","now","networkLinkInfo","cookie","lastUpdated","updating","needsUpdate","cameraUpdateTime","minRefreshPeriod","RefreshMode","expires","diff","oneTimeWarning","_networkLinks","addPromise","GroundOverlay","groundOverlay","geometry","isLatLonQuad","readCoordinates","createDefaultPolygon","latLonBox","west","south","east","north","negativePiToPi","clampToLatitudeRange","rotationRadians","iconNode","getIconHref","w","h","queryColorValue","altitudeMode","PhotoOverlay","processUnsupportedFeature","ScreenOverlay","Tour","queryStringAttribute","playlistNode","entryNode","playlistNodeProcessor","playlistNodeProcessors","kmlTours","DeferredLoading","_dataSource","_deferred","defer","_stack","_promises","_timeoutSet","_used","_started","_timeThreshold","insertNamespaces","firstPart","lastPart","declaration","namespaceMap","xsi","removeDuplicateNamespaces","namespace","startIndex","endIndex","endDeclaration","loadDataUriFromZip","deferred","mimeType","getData","Data64URIWriter","dataUri","embedDataUris","div","elementType","attributeName","baseUri","elements","querySelectorAll","getAttribute","setAttribute","applyBasePath","resource","createEntity","Entity","KmlFeatureData","isExtrudable","gxAltitudeMode","readCoordinate","fromDegrees","digits","parseFloat","isNaN","tuples","textContent","resultIndex","queryNumericAttribute","q","child","namespaceURI","queryNodes","getElementsByTagNameNS","queryChildNodes","resultNode","trim","queryBooleanValue","blob","addNodes","nodes","wait","all","isFirstCall","KmlDataSource","_getTimestamp","_process","_giveUpTime","_nextNode","stack","top","_pop","featureProcessor","colorOptions","maximumRed","red","maximumGreen","green","maximumBlue","blue","parseColorString","isRandom","alpha","parseInt","fromRandom","createDefaultBillboard","createDefaultLabel","LEFT","FILL_AND_OUTLINE","canRefresh","palette","hrefResource","processBillboardIcon","heading","icon","xOffset","yOffset","hotSpotNode","hotSpotX","hotSpotY","hotSpotXUnit","hotSpotYUnit","UNIT_Z","BILLBOARD_SIZE","applyStyle","styleNode","bgColor","textColor","balloonStyle","listItemType","processExternalStyles","styleCollection","fetchXML","styleKml","processStyles","isExternal","styleNodes","styleNodesLength","styleMaps","styleMapsLength","styleMap","pairs","pair","styleUrl","base","promises","styleUrlNodes","getElementsByTagName","styleUrlNodesLength","styleReference","createDropLine","entityPosition","surfacePosition","heightReferenceFromAltitudeMode","CLAMP_TO_GROUND","RELATIVE_TO_GROUND","createPositionPropertyFromAltitudeMode","_pinBuilder","fromColor","YELLOW","_clampToGround","processPathGraphics","processLineStringOrLinearRing","geometryNode","coordinatesNode","extrude","tessellate","canExtrude","polylineGraphics","propertiesLength","createPositionPropertyArrayFromAltitudeMode","addToMultiTrack","times","dropShowProperty","includeEndPoints","addSamples","isStartIncluded","isStopIncluded","scratchDiv","Point","coordinatesString","LineString","LinearRing","Polygon","outerBoundaryIsNode","linearRingNode","innerBoundaryIsNodes","k","Track","coordNodes","angleNodes","timeNodes","MultiTrack","lastStop","lastStopPosition","trackNodes","needDropLine","trackNode","MultiGeometry","childEntity","Model","featureNode","kmlData","placeMark","styleIndex","inlineStyleNode","externalStyle","computeFinalStyle","beginNode","beginDate","endNode","endDate","lessThan","processTimeSpan","whenString","processTimeStamp","visibility","ancestryIsVisible","authorNode","author","linkNode","hreflang","rel","title","address","phoneNumber","snippet","extendedDataNode","dataNodes","dataNode","displayName","extendedData","processExtendedData","background","foreground","isDisplayName","links","toCssColorString","processDescription","processLookAt","processCamera","document","createElement","FlyTo","lookAt","flyto","Wait","SoundCue","processTourUnsupportedNode","AnimatedUpdate","TourControl","lon","lat","altitude","tilt","roll","hpr","HeadingPitchRoll","HeadingPitchRange","PI_OVER_TWO","viewPoint","_unsupportedNode","sFirst","zeroRectangle","scratchCartesian2","scratchCartesian3","canvas","fixLatitude","fixLongitude","queryString","objectToQuery","queryParameters","_mode","SceneMode","MORPHING","centerCartesian","centerCartographic","clientWidth","clientHeight","pickEllipsoid","cartesianToCartographic","center","EPSILON9","newHalfWidth","newHalfHeight","toDegrees","pitch","distance","positionWC","frustum","aspectRatio","horizFov","vertFov","fov","loadKml","documentElement","_DeferredLoading","processFeatureNode","loadKmz","createReader","BlobReader","reader","getEntries","entries","docEntry","docDefer","directory","innerDefer","TextWriter","parseFromString","loadXmlFromZip","close","fetchBlob","DEFAULT","dataToLoad","Blob","magicBlob","size","FileReader","DataView","getUint32","readAsArrayBuffer","isZip","readAsText","readBlobAsText","body","msg","firstChild","nodeValue","innerText","_refresh","PinBuilder","AssociativeArray","direction","directionWC","up","upWC","computeViewRectangle","MAX_VALUE","parentAvailability","childAvailability","refreshEvent","unsupportedNodeEvent","oldName","isMinStart","isMaxStop","Date","setHours","fromDate","changed","entitiesToIgnore","update","networkLinks","cameraViewUpdate","lastCameraView","EPSILON7","newNetworkLinks","networkLink","contains","doUpdate","greaterThan","recurseIgnoreEntities","children","_children","count","newEntityCollection","processedHref","networkLinkEntity","entitiesCopy","entityToRemove","removeChildren","getNetworkLinkUpdateCallback","getTimestamp"],"mappings":"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","file":"2.TerriaJS-specs.js","sourcesContent":["\n    /**\n     * Style options for corners.\n     *\n     * @demo The {@link https://sandcastle.cesium.com/index.html?src=Corridor.html&label=Geometries|Corridor Demo}\n     * demonstrates the three corner types, as used by {@link CorridorGraphics}.\n     *\n     * @exports CornerType\n     */\n    var CornerType = {\n        /**\n         * <img src=\"Images/CornerTypeRounded.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner has a smooth edge.\n         * @type {Number}\n         * @constant\n         */\n        ROUNDED : 0,\n\n        /**\n         * <img src=\"Images/CornerTypeMitered.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner point is the intersection of adjacent edges.\n         * @type {Number}\n         * @constant\n         */\n        MITERED : 1,\n\n        /**\n         * <img src=\"Images/CornerTypeBeveled.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner is clipped.\n         * @type {Number}\n         * @constant\n         */\n        BEVELED : 2\n    };\nexport default Object.freeze(CornerType);\n","import defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport Property from './Property.js';\n\n    function subscribeAll(property, eventHelper, definitionChanged, intervals) {\n        function callback() {\n            definitionChanged.raiseEvent(property);\n        }\n        var items = [];\n        eventHelper.removeAll();\n        var length = intervals.length;\n        for (var i = 0; i < length; i++) {\n            var interval = intervals.get(i);\n            if (defined(interval.data) && items.indexOf(interval.data) === -1) {\n                eventHelper.add(interval.data.definitionChanged, callback);\n            }\n        }\n    }\n\n    /**\n     * A {@link Property} which is defined by a {@link TimeIntervalCollection}, where the\n     * data property of each {@link TimeInterval} is another Property instance which is\n     * evaluated at the provided time.\n     *\n     * @alias CompositeProperty\n     * @constructor\n     *\n     *\n     * @example\n     * var constantProperty = ...;\n     * var sampledProperty = ...;\n     *\n     * //Create a composite property from two previously defined properties\n     * //where the property is valid on August 1st, 2012 and uses a constant\n     * //property for the first half of the day and a sampled property for the\n     * //remaining half.\n     * var composite = new Cesium.CompositeProperty();\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T00:00:00.00Z/2012-08-01T12:00:00.00Z',\n     *     data : constantProperty\n     * }));\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T12:00:00.00Z/2012-08-02T00:00:00.00Z',\n     *     isStartIncluded : false,\n     *     isStopIncluded : false,\n     *     data : sampledProperty\n     * }));\n     *\n     * @see CompositeMaterialProperty\n     * @see CompositePositionProperty\n     */\n    function CompositeProperty() {\n        this._eventHelper = new EventHelper();\n        this._definitionChanged = new Event();\n        this._intervals = new TimeIntervalCollection();\n        this._intervals.changedEvent.addEventListener(CompositeProperty.prototype._intervalsChanged, this);\n    }\n\n    Object.defineProperties(CompositeProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._intervals.isEmpty;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeProperty && //\n                this._intervals.equals(other._intervals, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeProperty.prototype._intervalsChanged = function() {\n        subscribeAll(this, this._eventHelper, this._definitionChanged, this._intervals);\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeProperty;\n","import CesiumMath from '../Core/Math.js';\n\n    /**\n     * Defines different modes for blending between a target color and a primitive's source color.\n     *\n     * HIGHLIGHT multiplies the source color by the target color\n     * REPLACE replaces the source color with the target color\n     * MIX blends the source color and target color together\n     *\n     * @exports ColorBlendMode\n     *\n     * @see Model.colorBlendMode\n     */\n    var ColorBlendMode = {\n        HIGHLIGHT : 0,\n        REPLACE : 1,\n        MIX : 2\n    };\n\n    /**\n     * @private\n     */\n    ColorBlendMode.getColorBlend = function(colorBlendMode, colorBlendAmount) {\n        if (colorBlendMode === ColorBlendMode.HIGHLIGHT) {\n            return 0.0;\n        } else if (colorBlendMode === ColorBlendMode.REPLACE) {\n            return 1.0;\n        } else if (colorBlendMode === ColorBlendMode.MIX) {\n            // The value 0.0 is reserved for highlight, so clamp to just above 0.0.\n            return CesiumMath.clamp(colorBlendAmount, CesiumMath.EPSILON4, 1.0);\n        }\n    };\nexport default Object.freeze(ColorBlendMode);\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link PositionProperty}.\n     *\n     * @alias CompositePositionProperty\n     * @constructor\n     *\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function CompositePositionProperty(referenceFrame) {\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositePositionProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    Object.defineProperties(CompositePositionProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite.intervals;\n            }\n        },\n        /**\n         * Gets or sets the reference frame which this position presents itself as.\n         * Each PositionProperty making up this object has it's own reference frame,\n         * so this property merely exposes a \"preferred\" reference frame for clients\n         * to use.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {ReferenceFrame}\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            },\n            set : function(value) {\n                this._referenceFrame = value;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time in the fixed frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValueInReferenceFrame(time, referenceFrame, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositePositionProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositePositionProperty && //\n                this._referenceFrame === other._referenceFrame && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositePositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositePositionProperty;\n","import defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport Property from './Property.js';\n\n    function resolve(that) {\n        var targetProperty = that._targetProperty;\n\n        if (!defined(targetProperty)) {\n            var targetEntity = that._targetEntity;\n\n            if (!defined(targetEntity)) {\n                targetEntity = that._targetCollection.getById(that._targetId);\n\n                if (!defined(targetEntity)) {\n                    // target entity not found\n                    that._targetEntity = that._targetProperty = undefined;\n                    return;\n                }\n\n                // target entity was found. listen for changes to entity definition\n                targetEntity.definitionChanged.addEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, that);\n                that._targetEntity = targetEntity;\n            }\n\n            // walk the list of property names and resolve properties\n            var targetPropertyNames = that._targetPropertyNames;\n            targetProperty = that._targetEntity;\n            for (var i = 0, len = targetPropertyNames.length; i < len && defined(targetProperty); ++i) {\n                targetProperty = targetProperty[targetPropertyNames[i]];\n            }\n\n            // target property may or may not be defined, depending on if it was found\n            that._targetProperty = targetProperty;\n        }\n\n        return targetProperty;\n    }\n\n    /**\n     * A {@link Property} which transparently links to another property on a provided object.\n     *\n     * @alias ReferenceProperty\n     * @constructor\n     *\n     * @param {EntityCollection} targetCollection The entity collection which will be used to resolve the reference.\n     * @param {String} targetId The id of the entity which is being referenced.\n     * @param {String[]} targetPropertyNames The names of the property on the target entity which we will use.\n     *\n     * @example\n     * var collection = new Cesium.EntityCollection();\n     *\n     * //Create a new entity and assign a billboard scale.\n     * var object1 = new Cesium.Entity({id:'object1'});\n     * object1.billboard = new Cesium.BillboardGraphics();\n     * object1.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object1);\n     *\n     * //Create a second entity and reference the scale from the first one.\n     * var object2 = new Cesium.Entity({id:'object2'});\n     * object2.model = new Cesium.ModelGraphics();\n     * object2.model.scale = new Cesium.ReferenceProperty(collection, 'object1', ['billboard', 'scale']);\n     * collection.add(object2);\n     *\n     * //Create a third object, but use the fromString helper function.\n     * var object3 = new Cesium.Entity({id:'object3'});\n     * object3.billboard = new Cesium.BillboardGraphics();\n     * object3.billboard.scale = Cesium.ReferenceProperty.fromString(collection, 'object1#billboard.scale');\n     * collection.add(object3);\n     *\n     * //You can refer to an entity with a # or . in id and property names by escaping them.\n     * var object4 = new Cesium.Entity({id:'#object.4'});\n     * object4.billboard = new Cesium.BillboardGraphics();\n     * object4.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object4);\n     *\n     * var object5 = new Cesium.Entity({id:'object5'});\n     * object5.billboard = new Cesium.BillboardGraphics();\n     * object5.billboard.scale = Cesium.ReferenceProperty.fromString(collection, '\\\\#object\\\\.4#billboard.scale');\n     * collection.add(object5);\n     */\n    function ReferenceProperty(targetCollection, targetId, targetPropertyNames) {\n        \n\n        this._targetCollection = targetCollection;\n        this._targetId = targetId;\n        this._targetPropertyNames = targetPropertyNames;\n        this._targetProperty = undefined;\n        this._targetEntity = undefined;\n        this._definitionChanged = new Event();\n\n        targetCollection.collectionChanged.addEventListener(ReferenceProperty.prototype._onCollectionChanged, this);\n    }\n\n    Object.defineProperties(ReferenceProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof ReferenceProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(resolve(this));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever the referenced property's definition is changed.\n         * @memberof ReferenceProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame that the position is defined in.\n         * This property is only valid if the referenced property is a {@link PositionProperty}.\n         * @memberof ReferenceProperty.prototype\n         * @type {ReferenceFrame}\n         * @readonly\n         */\n        referenceFrame : {\n            get : function() {\n                var target = resolve(this);\n                return defined(target) ? target.referenceFrame : undefined;\n            }\n        },\n        /**\n         * Gets the id of the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {String}\n         * @readonly\n         */\n        targetId : {\n            get : function() {\n                return this._targetId;\n            }\n        },\n        /**\n         * Gets the collection containing the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {EntityCollection}\n         * @readonly\n         */\n        targetCollection : {\n            get : function() {\n                return this._targetCollection;\n            }\n        },\n        /**\n         * Gets the array of property names used to retrieve the referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {String[]}\n         * @readonly\n         */\n        targetPropertyNames : {\n            get : function() {\n                return this._targetPropertyNames;\n            }\n        },\n        /**\n         * Gets the resolved instance of the underlying referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {Property}\n         * @readonly\n         */\n        resolvedProperty : {\n            get : function() {\n                return resolve(this);\n            }\n        }\n    });\n\n    /**\n     * Creates a new instance given the entity collection that will\n     * be used to resolve it and a string indicating the target entity id and property.\n     * The format of the string is \"objectId#foo.bar\", where # separates the id from\n     * property path and . separates sub-properties.  If the reference identifier or\n     * or any sub-properties contains a # . or \\ they must be escaped.\n     *\n     * @param {EntityCollection} targetCollection\n     * @param {String} referenceString\n     * @returns {ReferenceProperty} A new instance of ReferenceProperty.\n     *\n     * @exception {DeveloperError} invalid referenceString.\n     */\n    ReferenceProperty.fromString = function(targetCollection, referenceString) {\n        \n\n        var identifier;\n        var values = [];\n\n        var inIdentifier = true;\n        var isEscaped = false;\n        var token = '';\n        for (var i = 0; i < referenceString.length; ++i) {\n            var c = referenceString.charAt(i);\n\n            if (isEscaped) {\n                token += c;\n                isEscaped = false;\n            } else if (c === '\\\\') {\n                isEscaped = true;\n            } else if (inIdentifier && c === '#') {\n                identifier = token;\n                inIdentifier = false;\n                token = '';\n            } else if (!inIdentifier && c === '.') {\n                values.push(token);\n                token = '';\n            } else {\n                token += c;\n            }\n        }\n        values.push(token);\n\n        return new ReferenceProperty(targetCollection, identifier, values);\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValue = function(time, result) {\n        var target = resolve(this);\n        return defined(target) ? target.getValue(time, result) : undefined;\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     * This method is only valid if the property being referenced is a {@link PositionProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        var target = resolve(this);\n        return defined(target) ? target.getValueInReferenceFrame(time, referenceFrame, result) : undefined;\n    };\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     * This method is only valid if the property being referenced is a {@link MaterialProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    ReferenceProperty.prototype.getType = function(time) {\n        var target = resolve(this);\n        return defined(target) ? target.getType(time) : undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    ReferenceProperty.prototype.equals = function(other) {\n        if (this === other) {\n            return true;\n        }\n\n        var names = this._targetPropertyNames;\n        var otherNames = other._targetPropertyNames;\n\n        if (this._targetCollection !== other._targetCollection || //\n            this._targetId !== other._targetId || //\n            names.length !== otherNames.length) {\n            return false;\n        }\n\n        var length = this._targetPropertyNames.length;\n        for (var i = 0; i < length; i++) {\n            if (names[i] !== otherNames[i]) {\n                return false;\n            }\n        }\n\n        return true;\n    };\n\n    ReferenceProperty.prototype._onTargetEntityDefinitionChanged = function(targetEntity, name, value, oldValue) {\n        if (defined(this._targetProperty) && this._targetPropertyNames[0] === name) {\n            this._targetProperty = undefined;\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ReferenceProperty.prototype._onCollectionChanged = function(collection, added, removed) {\n        var targetEntity = this._targetEntity;\n        if (defined(targetEntity) && removed.indexOf(targetEntity) !== -1) {\n            targetEntity.definitionChanged.removeEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, this);\n            this._targetEntity = this._targetProperty = undefined;\n        } else if (!defined(targetEntity)) {\n            targetEntity = resolve(this);\n            if (defined(targetEntity)) {\n                this._definitionChanged.raiseEvent(this);\n            }\n        }\n    };\nexport default ReferenceProperty;\n","import defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * This is a temporary class for scaling position properties to the WGS84 surface.\n     * It will go away or be refactored to support data with arbitrary height references.\n     * @private\n     */\n    function ScaledPositionProperty(value) {\n        this._definitionChanged = new Event();\n        this._value = undefined;\n        this._removeSubscription = undefined;\n        this.setValue(value);\n    }\n\n    Object.defineProperties(ScaledPositionProperty.prototype, {\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._value);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        referenceFrame : {\n            get : function() {\n                return defined(this._value) ? this._value.referenceFrame : ReferenceFrame.FIXED;\n            }\n        }\n    });\n\n    ScaledPositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    ScaledPositionProperty.prototype.setValue = function(value) {\n        if (this._value !== value) {\n            this._value = value;\n\n            if (defined(this._removeSubscription)) {\n                this._removeSubscription();\n                this._removeSubscription = undefined;\n            }\n\n            if (defined(value)) {\n                this._removeSubscription = value.definitionChanged.addEventListener(this._raiseDefinitionChanged, this);\n            }\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ScaledPositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        if (!defined(this._value)) {\n            return undefined;\n        }\n\n        result = this._value.getValueInReferenceFrame(time, referenceFrame, result);\n        return defined(result) ? Ellipsoid.WGS84.scaleToGeodeticSurface(result, result) : undefined;\n    };\n\n    ScaledPositionProperty.prototype.equals = function(other) {\n        return this === other || (other instanceof ScaledPositionProperty && this._value === other._value);\n    };\n\n    ScaledPositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default ScaledPositionProperty;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link PositionProperty} whose value is an array whose items are the computed value\n     * of other PositionProperty instances.\n     *\n     * @alias PositionPropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function PositionPropertyArray(value, referenceFrame) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this.setValue(value);\n    }\n\n    Object.defineProperties(PositionPropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame in which the position is defined.\n         * @memberof PositionPropertyArray.prototype\n         * @type {ReferenceFrame}\n         * @default ReferenceFrame.FIXED;\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = value[i];\n            var itemValue = property.getValueInReferenceFrame(time, referenceFrame, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PositionPropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PositionPropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PositionPropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PositionPropertyArray && //\n                this._referenceFrame === other._referenceFrame && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PositionPropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PositionPropertyArray;\n","import defaultValue from './defaultValue.js';\nimport defined from './defined.js';\nimport DeveloperError from './DeveloperError.js';\nimport CesiumMath from './Math.js';\n\n    var factorial = CesiumMath.factorial;\n\n    function calculateCoefficientTerm(x, zIndices, xTable, derivOrder, termOrder, reservedIndices) {\n        var result = 0;\n        var reserved;\n        var i;\n        var j;\n\n        if (derivOrder > 0) {\n            for (i = 0; i < termOrder; i++) {\n                reserved = false;\n                for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                    if (i === reservedIndices[j]) {\n                        reserved = true;\n                    }\n                }\n\n                if (!reserved) {\n                    reservedIndices.push(i);\n                    result += calculateCoefficientTerm(x, zIndices, xTable, derivOrder - 1, termOrder, reservedIndices);\n                    reservedIndices.splice(reservedIndices.length - 1, 1);\n                }\n            }\n\n            return result;\n        }\n\n        result = 1;\n        for (i = 0; i < termOrder; i++) {\n            reserved = false;\n            for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                if (i === reservedIndices[j]) {\n                    reserved = true;\n                }\n            }\n\n            if (!reserved) {\n                result *= x - xTable[zIndices[i]];\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Hermite interpolation.\n     *\n     * @exports HermitePolynomialApproximation\n     */\n    var HermitePolynomialApproximation = {\n        type : 'Hermite'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @param {Number} [inputOrder=0]  The order of the inputs (0 means just the data, 1 means the data and its derivative, etc).\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     * @exception {DeveloperError} degree must be 0 or greater.\n     * @exception {DeveloperError} inputOrder must be 0 or greater.\n     */\n    HermitePolynomialApproximation.getRequiredDataPoints = function(degree, inputOrder) {\n        inputOrder = defaultValue(inputOrder, 0);\n\n        \n\n        return Math.max(Math.floor((degree + 1) / (inputOrder + 1)), 2);\n    };\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var d;\n        var s;\n        var len;\n        var index;\n        var length = xTable.length;\n        var coefficients = new Array(yStride);\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n\n            var l = new Array(length);\n            coefficients[i] = l;\n            for (j = 0; j < length; j++) {\n                l[j] = [];\n            }\n        }\n\n        var zIndicesLength = length, zIndices = new Array(zIndicesLength);\n\n        for (i = 0; i < zIndicesLength; i++) {\n            zIndices[i] = i;\n        }\n\n        var highestNonZeroCoef = length - 1;\n        for (s = 0; s < yStride; s++) {\n            for (j = 0; j < zIndicesLength; j++) {\n                index = zIndices[j] * yStride + s;\n                coefficients[s][0].push(yTable[index]);\n            }\n\n            for (i = 1; i < zIndicesLength; i++) {\n                var nonZeroCoefficients = false;\n                for (j = 0; j < zIndicesLength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficients[s][i].push(numerator / factorial(i));\n                    } else {\n                        numerator = (coefficients[s][i - 1][j + 1] - coefficients[s][i - 1][j]);\n                        coefficients[s][i].push(numerator / (zn - zj));\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0);\n                }\n\n                if (!nonZeroCoefficients) {\n                    highestNonZeroCoef = i - 1;\n                }\n            }\n        }\n\n        for (d = 0, len = 0; d <= len; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, []);\n                for (s = 0; s < yStride; s++) {\n                    var coeff = coefficients[s][i][0];\n                    result[s + d * yStride] += coeff * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    var arrayScratch = [];\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number} inputOrder The number of derivatives supplied for input.\n     * @param {Number} outputOrder The number of derivatives desired for output.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     *\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolate = function(x, xTable, yTable, yStride, inputOrder, outputOrder, result) {\n        var resultLength = yStride * (outputOrder + 1);\n        if (!defined(result)) {\n            result = new Array(resultLength);\n        }\n        for (var r = 0; r < resultLength; r++) {\n            result[r] = 0;\n        }\n\n        var length = xTable.length;\n        // The zIndices array holds copies of the addresses of the xTable values\n        // in the range we're looking at. Even though this just holds information already\n        // available in xTable this is a much more convenient format.\n        var zIndices = new Array(length * (inputOrder + 1));\n        var i;\n        for (i = 0; i < length; i++) {\n            for (var j = 0; j < (inputOrder + 1); j++) {\n                zIndices[i * (inputOrder + 1) + j] = i;\n            }\n        }\n\n        var zIndiceslength = zIndices.length;\n        var coefficients = arrayScratch;\n        var highestNonZeroCoef = fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder);\n        var reservedIndices = [];\n\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n        var loopStop = Math.min(highestNonZeroCoef, outputOrder);\n        for (var d = 0; d <= loopStop; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                reservedIndices.length = 0;\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, reservedIndices);\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n\n                for (var s = 0; s < yStride; s++) {\n                    var dimOne = Math.floor(s * tmp);\n                    var coef = coefficients[dimOne + dimTwo];\n                    result[s + d * yStride] += coef * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    function fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder) {\n        var j;\n        var index;\n        var highestNonZero = -1;\n        var zIndiceslength = zIndices.length;\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n\n        for (var s = 0; s < yStride; s++) {\n            var dimOne = Math.floor(s * tmp);\n\n            for (j = 0; j < zIndiceslength; j++) {\n                index = zIndices[j] * yStride * (inputOrder + 1) + s;\n                coefficients[dimOne + j] = yTable[index];\n            }\n\n            for (var i = 1; i < zIndiceslength; i++) {\n                var coefIndex = 0;\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n                var nonZeroCoefficients = false;\n\n                for (j = 0; j < zIndiceslength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    var coefficient;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride * (inputOrder + 1) + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficient = (numerator / CesiumMath.factorial(i));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    } else {\n                        var dimTwoMinusOne = Math.floor((i - 1) * (2 - i) / 2) + (zIndiceslength * (i - 1));\n                        numerator = coefficients[dimOne + dimTwoMinusOne + j + 1] - coefficients[dimOne + dimTwoMinusOne + j];\n                        coefficient = (numerator / (zn - zj));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0.0);\n                }\n\n                if (nonZeroCoefficients) {\n                    highestNonZero = Math.max(highestNonZero, i);\n                }\n            }\n        }\n\n        return highestNonZero;\n    }\nexport default HermitePolynomialApproximation;\n","import defined from './defined.js';\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Lagrange interpolation.\n     *\n     * @exports LagrangePolynomialApproximation\n     */\n    var LagrangePolynomialApproximation = {\n        type : 'Lagrange'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     */\n    LagrangePolynomialApproximation.getRequiredDataPoints = function(degree) {\n        return Math.max(degree + 1.0, 2);\n    };\n\n    /**\n     * Interpolates values using Lagrange Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    LagrangePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var length = xTable.length;\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n        }\n\n        for (i = 0; i < length; i++) {\n            var coefficient = 1;\n\n            for (j = 0; j < length; j++) {\n                if (j !== i) {\n                    var diffX = xTable[i] - xTable[j];\n                    coefficient *= (x - xTable[j]) / diffX;\n                }\n            }\n\n            for (j = 0; j < yStride; j++) {\n                result[j] += coefficient * yTable[i * yStride + j];\n            }\n        }\n\n        return result;\n    };\nexport default LagrangePolynomialApproximation;\n","import Check from './Check.js';\nimport defaultValue from './defaultValue.js';\nimport defined from './defined.js';\n\n    /**\n     * A set of curvilinear 3-dimensional coordinates.\n     *\n     * @alias Spherical\n     * @constructor\n     *\n     * @param {Number} [clock=0.0] The angular coordinate lying in the xy-plane measured from the positive x-axis and toward the positive y-axis.\n     * @param {Number} [cone=0.0] The angular coordinate measured from the positive z-axis and toward the negative z-axis.\n     * @param {Number} [magnitude=1.0] The linear coordinate measured from the origin.\n     */\n    function Spherical(clock, cone, magnitude) {\n        /**\n         * The clock component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.clock = defaultValue(clock, 0.0);\n        /**\n         * The cone component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.cone = defaultValue(cone, 0.0);\n        /**\n         * The magnitude component.\n         * @type {Number}\n         * @default 1.0\n         */\n        this.magnitude = defaultValue(magnitude, 1.0);\n    }\n\n    /**\n     * Converts the provided Cartesian3 into Spherical coordinates.\n     *\n     * @param {Cartesian3} cartesian3 The Cartesian3 to be converted to Spherical.\n     * @param {Spherical} [result] The object in which the result will be stored, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter, or a new instance if one was not provided.\n     */\n    Spherical.fromCartesian3 = function(cartesian3, result) {\n        \n\n        var x = cartesian3.x;\n        var y = cartesian3.y;\n        var z = cartesian3.z;\n        var radialSquared = x * x + y * y;\n\n        if (!defined(result)) {\n            result = new Spherical();\n        }\n\n        result.clock = Math.atan2(y, x);\n        result.cone = Math.atan2(Math.sqrt(radialSquared), z);\n        result.magnitude = Math.sqrt(radialSquared + z * z);\n        return result;\n    };\n\n    /**\n     * Creates a duplicate of a Spherical.\n     *\n     * @param {Spherical} spherical The spherical to clone.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined. (Returns undefined if spherical is undefined)\n     */\n    Spherical.clone = function(spherical, result) {\n        if (!defined(spherical)) {\n            return undefined;\n        }\n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, spherical.magnitude);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = spherical.magnitude;\n        return result;\n    };\n\n    /**\n     * Computes the normalized version of the provided spherical.\n     *\n     * @param {Spherical} spherical The spherical to be normalized.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.normalize = function(spherical, result) {\n      \n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, 1.0);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = 1.0;\n        return result;\n    };\n\n    /**\n     * Returns true if the first spherical is equal to the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @returns {Boolean} true if the first spherical is equal to the second spherical, false otherwise.\n     */\n    Spherical.equals = function(left, right) {\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (left.clock === right.clock) &&\n                (left.cone === right.cone) &&\n                (left.magnitude === right.magnitude));\n    };\n\n    /**\n     * Returns true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @param {Number} [epsilon=0.0] The epsilon to compare against.\n     * @returns {Boolean} true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     */\n    Spherical.equalsEpsilon = function(left, right, epsilon) {\n        epsilon = defaultValue(epsilon, 0.0);\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (Math.abs(left.clock - right.clock) <= epsilon) &&\n                (Math.abs(left.cone - right.cone) <= epsilon) &&\n                (Math.abs(left.magnitude - right.magnitude) <= epsilon));\n    };\n\n    /**\n     * Returns true if this spherical is equal to the provided spherical, false otherwise.\n     *\n     * @param {Spherical} other The Spherical to be compared.\n     * @returns {Boolean} true if this spherical is equal to the provided spherical, false otherwise.\n     */\n    Spherical.prototype.equals = function(other) {\n        return Spherical.equals(this, other);\n    };\n\n    /**\n     * Creates a duplicate of this Spherical.\n     *\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.prototype.clone = function(result) {\n        return Spherical.clone(this, result);\n    };\n\n    /**\n    * Returns true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    *\n    * @param {Spherical} other The Spherical to be compared.\n    * @param {Number} epsilon The epsilon to compare against.\n    * @returns {Boolean} true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    */\n    Spherical.prototype.equalsEpsilon = function(other, epsilon) {\n        return Spherical.equalsEpsilon(this, other, epsilon);\n    };\n\n    /**\n    * Returns a string representing this instance in the format (clock, cone, magnitude).\n    *\n    * @returns {String} A string representing this instance.\n    */\n    Spherical.prototype.toString = function() {\n        return '(' + this.clock + ', ' + this.cone + ', ' + this.magnitude + ')';\n    };\nexport default Spherical;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultRepeat = new Cartesian2(2.0, 2.0);\n\n    /**\n     * A {@link MaterialProperty} that maps to checkerboard {@link Material} uniforms.\n     * @alias CheckerboardMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.repeat=new Cartesian2(2.0, 2.0)] A {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n     */\n    function CheckerboardMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.repeat = options.repeat;\n    }\n\n    Object.defineProperties(CheckerboardMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(2.0, 2.0)\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CheckerboardMaterialProperty.prototype.getType = function(time) {\n        return 'Checkerboard';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CheckerboardMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.lightColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.lightColor);\n        result.darkColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.darkColor);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CheckerboardMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CheckerboardMaterialProperty && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default CheckerboardMaterialProperty;\n","import defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link MaterialProperty}.\n     *\n     * @alias CompositeMaterialProperty\n     * @constructor\n     */\n    function CompositeMaterialProperty() {\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositeMaterialProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    Object.defineProperties(CompositeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CompositeMaterialProperty.prototype.getType = function(time) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getType(time);\n        }\n        return undefined;\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeMaterialProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeMaterialProperty && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeMaterialProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeMaterialProperty;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultCellAlpha = 0.1;\n    var defaultLineCount = new Cartesian2(8, 8);\n    var defaultLineOffset = new Cartesian2(0, 0);\n    var defaultLineThickness = new Cartesian2(1, 1);\n\n    /**\n     * A {@link MaterialProperty} that maps to grid {@link Material} uniforms.\n     * @alias GridMaterialProperty\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the grid {@link Color}.\n     * @param {Property} [options.cellAlpha=0.1] A numeric Property specifying cell alpha values.\n     * @param {Property} [options.lineCount=new Cartesian2(8, 8)] A {@link Cartesian2} Property specifying the number of grid lines along each axis.\n     * @param {Property} [options.lineThickness=new Cartesian2(1.0, 1.0)] A {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n     * @param {Property} [options.lineOffset=new Cartesian2(0.0, 0.0)] A {@link Cartesian2} Property specifying starting offset of grid lines along each axis.\n     *\n     * @constructor\n     */\n    function GridMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._cellAlpha = undefined;\n        this._cellAlphaSubscription = undefined;\n        this._lineCount = undefined;\n        this._lineCountSubscription = undefined;\n        this._lineThickness = undefined;\n        this._lineThicknessSubscription = undefined;\n        this._lineOffset = undefined;\n        this._lineOffsetSubscription = undefined;\n\n        this.color = options.color;\n        this.cellAlpha = options.cellAlpha;\n        this.lineCount = options.lineCount;\n        this.lineThickness = options.lineThickness;\n        this.lineOffset = options.lineOffset;\n    }\n\n    Object.defineProperties(GridMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) &&\n                       Property.isConstant(this._cellAlpha) &&\n                       Property.isConstant(this._lineCount) &&\n                       Property.isConstant(this._lineThickness) &&\n                       Property.isConstant(this._lineOffset);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the grid {@link Color}.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the numeric Property specifying cell alpha values.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.1\n         */\n        cellAlpha : createPropertyDescriptor('cellAlpha'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the number of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(8.0, 8.0)\n         */\n        lineCount : createPropertyDescriptor('lineCount'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(1.0, 1.0)\n         */\n        lineThickness : createPropertyDescriptor('lineThickness'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the starting offset of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(0.0, 0.0)\n         */\n        lineOffset : createPropertyDescriptor('lineOffset')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    GridMaterialProperty.prototype.getType = function(time) {\n        return 'Grid';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    GridMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.cellAlpha = Property.getValueOrDefault(this._cellAlpha, time, defaultCellAlpha);\n        result.lineCount = Property.getValueOrClonedDefault(this._lineCount, time, defaultLineCount, result.lineCount);\n        result.lineThickness = Property.getValueOrClonedDefault(this._lineThickness, time, defaultLineThickness, result.lineThickness);\n        result.lineOffset = Property.getValueOrClonedDefault(this._lineOffset, time, defaultLineOffset, result.lineOffset);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    GridMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n        (other instanceof GridMaterialProperty && //\n        Property.equals(this._color, other._color) && //\n        Property.equals(this._cellAlpha, other._cellAlpha) && //\n        Property.equals(this._lineCount, other._lineCount) && //\n        Property.equals(this._lineThickness, other._lineThickness) && //\n        Property.equals(this._lineOffset, other._lineOffset));\n    };\nexport default GridMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link MaterialProperty} that maps to PolylineArrow {@link Material} uniforms.\n     *\n     * @param {Property} [color=Color.WHITE] The {@link Color} Property to be used.\n     *\n     * @alias PolylineArrowMaterialProperty\n     * @constructor\n     */\n    function PolylineArrowMaterialProperty(color) {\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n\n        this.color = color;\n    }\n\n    Object.defineProperties(PolylineArrowMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the {@link Color} {@link Property}.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineArrowMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineArrow';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineArrowMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, Color.WHITE, result.color);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineArrowMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineArrowMaterialProperty && //\n                Property.equals(this._color, other._color));\n    };\nexport default PolylineArrowMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultGapColor = Color.TRANSPARENT;\n    var defaultDashLength = 16.0;\n    var defaultDashPattern = 255.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline dash {@link Material} uniforms.\n     * @alias PolylineDashMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.gapColor=Color.TRANSPARENT] A Property specifying the {@link Color} of the gaps in the line.\n     * @param {Property} [options.dashLength=16.0] A numeric Property specifying the length of the dash pattern in pixels.\n     * @param {Property} [options.dashPattern=255.0] A numeric Property specifying a 16 bit pattern for the dash\n     */\n    function PolylineDashMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._gapColor = undefined;\n        this._gapColorSubscription = undefined;\n        this._dashLength = undefined;\n        this._dashLengthSubscription = undefined;\n        this._dashPattern = undefined;\n        this._dashPatternSubscription = undefined;\n\n        this.color = options.color;\n        this.gapColor = options.gapColor;\n        this.dashLength = options.dashLength;\n        this.dashPattern = options.dashPattern;\n    }\n\n    Object.defineProperties(PolylineDashMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return (Property.isConstant(this._color) &&\n                        Property.isConstant(this._gapColor) &&\n                        Property.isConstant(this._dashLength) &&\n                        Property.isConstant(this._dashPattern));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the gaps in the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        gapColor : createPropertyDescriptor('gapColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the length of a dash cycle\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashLength : createPropertyDescriptor('dashLength'),\n\n        /**\n         * Gets or sets the numeric Property specifying a dash pattern\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashPattern : createPropertyDescriptor('dashPattern')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineDashMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineDash';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineDashMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.gapColor = Property.getValueOrClonedDefault(this._gapColor, time, defaultGapColor, result.gapColor);\n        result.dashLength = Property.getValueOrDefault(this._dashLength, time, defaultDashLength, result.dashLength);\n        result.dashPattern = Property.getValueOrDefault(this._dashPattern, time, defaultDashPattern, result.dashPattern);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineDashMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineDashMaterialProperty &&\n                Property.equals(this._color, other._color) &&\n                Property.equals(this._gapColor, other._gapColor) &&\n                Property.equals(this._dashLength, other._dashLength) &&\n                Property.equals(this._dashPattern, other._dashPattern));\n    };\nexport default PolylineDashMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultOutlineColor = Color.BLACK;\n    var defaultOutlineWidth = 1.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline outline {@link Material} uniforms.\n     * @alias PolylineOutlineMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.outlineColor=Color.BLACK] A Property specifying the {@link Color} of the outline.\n     * @param {Property} [options.outlineWidth=1.0] A numeric Property specifying the width of the outline, in pixels.\n     */\n    function PolylineOutlineMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._outlineColor = undefined;\n        this._outlineColorSubscription = undefined;\n        this._outlineWidth = undefined;\n        this._outlineWidthSubscription = undefined;\n\n        this.color = options.color;\n        this.outlineColor = options.outlineColor;\n        this.outlineWidth = options.outlineWidth;\n    }\n\n    Object.defineProperties(PolylineOutlineMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) && Property.isConstant(this._outlineColor) && Property.isConstant(this._outlineWidth);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        outlineColor : createPropertyDescriptor('outlineColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the width of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        outlineWidth : createPropertyDescriptor('outlineWidth')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineOutlineMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineOutline';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineOutlineMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.outlineColor = Property.getValueOrClonedDefault(this._outlineColor, time, defaultOutlineColor, result.outlineColor);\n        result.outlineWidth = Property.getValueOrDefault(this._outlineWidth, time, defaultOutlineWidth);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineOutlineMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineOutlineMaterialProperty && //\n                Property.equals(this._color, other._color) && //\n                Property.equals(this._outlineColor, other._outlineColor) && //\n                Property.equals(this._outlineWidth, other._outlineWidth));\n    };\nexport default PolylineOutlineMaterialProperty;\n","import defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} whose value is an array whose items are the computed value\n     * of other property instances.\n     *\n     * @alias PropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     */\n    function PropertyArray(value) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this.setValue(value);\n    }\n\n    Object.defineProperties(PropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object[]} The modified result parameter, which is an array of values produced by evaluating each of the contained properties at the given time or a new instance if the result parameter was not supplied.\n     */\n    PropertyArray.prototype.getValue = function(time, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = this._value[i];\n            var itemValue = property.getValue(time, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PropertyArray && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PropertyArray;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport CesiumMath from '../Core/Math.js';\n\n    /**\n     * Represents a {@link Packable} number that always interpolates values\n     * towards the shortest angle of rotation. This object is never used directly\n     * but is instead passed to the constructor of {@link SampledProperty}\n     * in order to represent a two-dimensional angle of rotation.\n     *\n     * @exports Rotation\n     *\n     *\n     * @example\n     * var time1 = Cesium.JulianDate.fromIso8601('2010-05-07T00:00:00');\n     * var time2 = Cesium.JulianDate.fromIso8601('2010-05-07T00:01:00');\n     * var time3 = Cesium.JulianDate.fromIso8601('2010-05-07T00:02:00');\n     *\n     * var property = new Cesium.SampledProperty(Cesium.Rotation);\n     * property.addSample(time1, 0);\n     * property.addSample(time3, Cesium.Math.toRadians(350));\n     *\n     * //Getting the value at time2 will equal 355 degrees instead\n     * //of 175 degrees (which is what you get if you construct\n     * //a SampledProperty(Number) instead.  Note, the actual\n     * //return value is in radians, not degrees.\n     * property.getValue(time2);\n     *\n     * @see PackableForInterpolation\n     */\n    var Rotation = {\n        /**\n         * The number of elements used to pack the object into an array.\n         * @type {Number}\n         */\n        packedLength : 1,\n\n        /**\n         * Stores the provided instance into the provided array.\n         *\n         * @param {Rotation} value The value to pack.\n         * @param {Number[]} array The array to pack into.\n         * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n         *\n         * @returns {Number[]} The array that was packed into\n         */\n        pack : function(value, array, startingIndex) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            array[startingIndex] = value;\n\n            return array;\n        },\n\n        /**\n         * Retrieves an instance from a packed array.\n         *\n         * @param {Number[]} array The packed array.\n         * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpack : function(array, startingIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            return array[startingIndex];\n        },\n\n        /**\n         * Converts a packed array into a form suitable for interpolation.\n         *\n         * @param {Number[]} packedArray The packed array.\n         * @param {Number} [startingIndex=0] The index of the first element to be converted.\n         * @param {Number} [lastIndex=packedArray.length] The index of the last element to be converted.\n         * @param {Number[]} result The object into which to store the result.\n         */\n        convertPackedArrayForInterpolation : function(packedArray, startingIndex, lastIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            lastIndex = defaultValue(lastIndex, packedArray.length);\n\n            var previousValue;\n            for (var i = 0, len = lastIndex - startingIndex + 1; i < len; i++) {\n                var value = packedArray[startingIndex + i];\n                if (i === 0 || Math.abs(previousValue - value) < Math.PI) {\n                    result[i] = value;\n                } else {\n                    result[i] = value - CesiumMath.TWO_PI;\n                }\n                previousValue = value;\n            }\n        },\n\n        /**\n         * Retrieves an instance from a packed array converted with {@link Rotation.convertPackedArrayForInterpolation}.\n         *\n         * @param {Number[]} array The array previously packed for interpolation.\n         * @param {Number[]} sourceArray The original packed array.\n         * @param {Number} [firstIndex=0] The firstIndex used to convert the array.\n         * @param {Number} [lastIndex=packedArray.length] The lastIndex used to convert the array.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpackInterpolationResult : function(array, sourceArray, firstIndex, lastIndex, result) {\n            \n\n            result = array[0];\n            if (result < 0) {\n                return result + CesiumMath.TWO_PI;\n            }\n            return result;\n        }\n    };\nexport default Rotation;\n","\n    /**\n     * Defined the orientation of stripes in {@link StripeMaterialProperty}.\n     *\n     * @exports StripeOrientation\n     */\n    var StripeOrientation = {\n        /**\n         * Horizontal orientation.\n         * @type {Number}\n         */\n        HORIZONTAL : 0,\n\n        /**\n         * Vertical orientation.\n         * @type {Number}\n         */\n        VERTICAL : 1\n    };\nexport default Object.freeze(StripeOrientation);\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\nimport StripeOrientation from './StripeOrientation.js';\n\n    var defaultOrientation = StripeOrientation.HORIZONTAL;\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultOffset = 0;\n    var defaultRepeat = 1;\n\n    /**\n     * A {@link MaterialProperty} that maps to stripe {@link Material} uniforms.\n     * @alias StripeMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.orientation=StripeOrientation.HORIZONTAL] A Property specifying the {@link StripeOrientation}.\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.offset=0] A numeric Property specifying how far into the pattern to start the material.\n     * @param {Property} [options.repeat=1] A numeric Property specifying how many times the stripes repeat.\n     */\n    function StripeMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._orientation = undefined;\n        this._orientationSubscription = undefined;\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._offset = undefined;\n        this._offsetSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.orientation = options.orientation;\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.offset = options.offset;\n        this.repeat = options.repeat;\n    }\n\n    Object.defineProperties(StripeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._orientation) && //\n                       Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._offset) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the {@link StripeOrientation}/\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default StripeOrientation.HORIZONTAL\n         */\n        orientation : createPropertyDescriptor('orientation'),\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the point into the pattern\n         * to begin drawing; with 0.0 being the beginning of the even color, 1.0 the beginning\n         * of the odd color, 2.0 being the even color again, and any multiple or fractional values\n         * being in between.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.0\n         */\n        offset : createPropertyDescriptor('offset'),\n\n        /**\n         * Gets or sets the numeric Property specifying how many times the stripes repeat.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    StripeMaterialProperty.prototype.getType = function(time) {\n        return 'Stripe';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    StripeMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.horizontal = Property.getValueOrDefault(this._orientation, time, defaultOrientation) === StripeOrientation.HORIZONTAL;\n        result.evenColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.evenColor);\n        result.oddColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.oddColor);\n        result.offset = Property.getValueOrDefault(this._offset, time, defaultOffset);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    StripeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof StripeMaterialProperty && //\n                       Property.equals(this._orientation, other._orientation) && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._offset, other._offset) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default StripeMaterialProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Cartesian3} vector\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityVectorProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the velocity.\n     * @param {Boolean} [normalize=true] Whether to normalize the computed velocity vector.\n     *\n     * @example\n     * //Create an entity with a billboard rotated to match its velocity.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   billboard : {\n     *     image : 'image.png',\n     *     alignedAxis : new Cesium.VelocityVectorProperty(position, true) // alignedAxis must be a unit vector\n     *   }\n     * }));\n     */\n    function VelocityVectorProperty(position, normalize) {\n        this._position = undefined;\n        this._subscription = undefined;\n        this._definitionChanged = new Event();\n        this._normalize = defaultValue(normalize, true);\n\n        this.position = position;\n    }\n\n    Object.defineProperties(VelocityVectorProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._position);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute the velocity vector.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._position;\n            },\n            set : function(value) {\n                var oldValue = this._position;\n                if (oldValue !== value) {\n                    if (defined(oldValue)) {\n                        this._subscription();\n                    }\n\n                    this._position = value;\n\n                    if (defined(value)) {\n                        this._subscription = value._definitionChanged.addEventListener(function() {\n                            this._definitionChanged.raiseEvent(this);\n                        }, this);\n                    }\n\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets or sets whether the vector produced by this property\n         * will be normalized or not.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         */\n        normalize : {\n            get : function() {\n                return this._normalize;\n            },\n            set : function(value) {\n                if (this._normalize === value) {\n                    return;\n                }\n\n                this._normalize = value;\n                this._definitionChanged.raiseEvent(this);\n            }\n        }\n    });\n\n    var position1Scratch = new Cartesian3();\n    var position2Scratch = new Cartesian3();\n    var timeScratch = new JulianDate();\n    var step = 1.0 / 60.0;\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityVectorProperty.prototype.getValue = function(time, result) {\n        return this._getValue(time, result);\n    };\n\n    /**\n     * @private\n     */\n    VelocityVectorProperty.prototype._getValue = function(time, velocityResult, positionResult) {\n        \n\n        if (!defined(velocityResult)) {\n            velocityResult = new Cartesian3();\n        }\n\n        var property = this._position;\n        if (Property.isConstant(property)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        var position1 = property.getValue(time, position1Scratch);\n        var position2 = property.getValue(JulianDate.addSeconds(time, step, timeScratch), position2Scratch);\n\n        //If we don't have a position for now, return undefined.\n        if (!defined(position1)) {\n            return undefined;\n        }\n\n        //If we don't have a position for now + step, see if we have a position for now - step.\n        if (!defined(position2)) {\n            position2 = position1;\n            position1 = property.getValue(JulianDate.addSeconds(time, -step, timeScratch), position2Scratch);\n\n            if (!defined(position1)) {\n                return undefined;\n            }\n        }\n\n        if (Cartesian3.equals(position1, position2)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        if (defined(positionResult)) {\n            position1.clone(positionResult);\n        }\n\n        var velocity = Cartesian3.subtract(position2, position1, velocityResult);\n        if (this._normalize) {\n            return Cartesian3.normalize(velocity, velocityResult);\n        }\n\n        return Cartesian3.divideByScalar(velocity, step, velocityResult);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityVectorProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityVectorProperty &&\n                Property.equals(this._position, other._position));\n    };\nexport default VelocityVectorProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport Matrix3 from '../Core/Matrix3.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Transforms from '../Core/Transforms.js';\nimport Property from './Property.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Quaternion} rotation\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityOrientationProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the orientation.\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid used to determine which way is up.\n     *\n     * @example\n     * //Create an entity with position and orientation.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   orientation : new Cesium.VelocityOrientationProperty(position)\n     * }));\n     */\n    function VelocityOrientationProperty(position, ellipsoid) {\n        this._velocityVectorProperty = new VelocityVectorProperty(position, true);\n        this._subscription = undefined;\n        this._ellipsoid = undefined;\n        this._definitionChanged = new Event();\n\n        this.ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\n\n        var that = this;\n        this._velocityVectorProperty.definitionChanged.addEventListener(function() {\n            that._definitionChanged.raiseEvent(that);\n        });\n    }\n\n    Object.defineProperties(VelocityOrientationProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._velocityVectorProperty);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute orientation.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._velocityVectorProperty.position;\n            },\n            set : function(value) {\n                this._velocityVectorProperty.position = value;\n            }\n        },\n        /**\n         * Gets or sets the ellipsoid used to determine which way is up.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        ellipsoid : {\n            get : function() {\n                return this._ellipsoid;\n            },\n            set : function(value) {\n                var oldValue = this._ellipsoid;\n                if (oldValue !== value) {\n                    this._ellipsoid = value;\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        }\n    });\n\n    var positionScratch = new Cartesian3();\n    var velocityScratch = new Cartesian3();\n    var rotationScratch = new Matrix3();\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Quaternion} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Quaternion} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityOrientationProperty.prototype.getValue = function(time, result) {\n        var velocity = this._velocityVectorProperty._getValue(time, velocityScratch, positionScratch);\n\n        if (!defined(velocity)) {\n            return undefined;\n        }\n\n        Transforms.rotationMatrixFromPositionVelocity(positionScratch, velocity, this._ellipsoid, rotationScratch);\n        return Quaternion.fromRotationMatrix(rotationScratch, result);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityOrientationProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityOrientationProperty &&\n                Property.equals(this._velocityVectorProperty, other._velocityVectorProperty) &&\n                (this._ellipsoid === other._ellipsoid ||\n                 this._ellipsoid.equals(other._ellipsoid)));\n    };\nexport default VelocityOrientationProperty;\n","import ArcType from '../Core/ArcType.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport Color from '../Core/Color.js';\nimport CornerType from '../Core/CornerType.js';\nimport Credit from '../Core/Credit.js';\nimport createGuid from '../Core/createGuid.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport DistanceDisplayCondition from '../Core/DistanceDisplayCondition.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ExtrapolationType from '../Core/ExtrapolationType.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport HermitePolynomialApproximation from '../Core/HermitePolynomialApproximation.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport LagrangePolynomialApproximation from '../Core/LagrangePolynomialApproximation.js';\nimport LinearApproximation from '../Core/LinearApproximation.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport Spherical from '../Core/Spherical.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport ClassificationType from '../Scene/ClassificationType.js';\nimport ColorBlendMode from '../Scene/ColorBlendMode.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport ShadowMode from '../Scene/ShadowMode.js';\nimport VerticalOrigin from '../Scene/VerticalOrigin.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport BoxGraphics from './BoxGraphics.js';\nimport CallbackProperty from './CallbackProperty.js';\nimport CheckerboardMaterialProperty from './CheckerboardMaterialProperty.js';\nimport ColorMaterialProperty from './ColorMaterialProperty.js';\nimport CompositeMaterialProperty from './CompositeMaterialProperty.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport ConstantPositionProperty from './ConstantPositionProperty.js';\nimport ConstantProperty from './ConstantProperty.js';\nimport CorridorGraphics from './CorridorGraphics.js';\nimport CylinderGraphics from './CylinderGraphics.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport EllipseGraphics from './EllipseGraphics.js';\nimport EllipsoidGraphics from './EllipsoidGraphics.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport GridMaterialProperty from './GridMaterialProperty.js';\nimport ImageMaterialProperty from './ImageMaterialProperty.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport ModelGraphics from './ModelGraphics.js';\nimport NodeTransformationProperty from './NodeTransformationProperty.js';\nimport PathGraphics from './PathGraphics.js';\nimport PointGraphics from './PointGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineArrowMaterialProperty from './PolylineArrowMaterialProperty.js';\nimport PolylineDashMaterialProperty from './PolylineDashMaterialProperty.js';\nimport PolylineGlowMaterialProperty from './PolylineGlowMaterialProperty.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PolylineOutlineMaterialProperty from './PolylineOutlineMaterialProperty.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport Property from './Property.js';\nimport PropertyArray from './PropertyArray.js';\nimport PropertyBag from './PropertyBag.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport Rotation from './Rotation.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport SampledProperty from './SampledProperty.js';\nimport StripeMaterialProperty from './StripeMaterialProperty.js';\nimport StripeOrientation from './StripeOrientation.js';\nimport TimeIntervalCollectionPositionProperty from './TimeIntervalCollectionPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport VelocityOrientationProperty from './VelocityOrientationProperty.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\nimport WallGraphics from './WallGraphics.js';\nimport Cesium3DTilesetGraphics from './Cesium3DTilesetGraphics.js';\n\n    // A marker type to distinguish CZML properties where we need to end up with a unit vector.\n    // The data is still loaded into Cartesian3 objects but they are normalized.\n    function UnitCartesian3() {}\n    UnitCartesian3.packedLength = Cartesian3.packedLength;\n    UnitCartesian3.unpack = Cartesian3.unpack;\n    UnitCartesian3.pack = Cartesian3.pack;\n\n    // As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\n    var currentId;\n\n    function createReferenceProperty(entityCollection, referenceString) {\n        if (referenceString[0] === '#') {\n            referenceString = currentId + referenceString;\n        }\n        return ReferenceProperty.fromString(entityCollection, referenceString);\n    }\n\n    function createSpecializedProperty(type, entityCollection, packetData) {\n        if (defined(packetData.reference)) {\n            return createReferenceProperty(entityCollection, packetData.reference);\n        }\n\n        if (defined(packetData.velocityReference)) {\n            var referenceProperty = createReferenceProperty(entityCollection, packetData.velocityReference);\n            switch (type) {\n                case Cartesian3:\n                case UnitCartesian3:\n                    return new VelocityVectorProperty(referenceProperty, type === UnitCartesian3);\n                case Quaternion:\n                    return new VelocityOrientationProperty(referenceProperty);\n            }\n        }\n\n        throw new RuntimeError(JSON.stringify(packetData) + ' is not valid CZML.');\n    }\n\n    function createAdapterProperty(property, adapterFunction) {\n        return new CallbackProperty(function(time, result) {\n            return adapterFunction(property.getValue(time, result));\n        }, property.isConstant);\n    }\n\n    var scratchCartesian = new Cartesian3();\n    var scratchSpherical = new Spherical();\n    var scratchCartographic = new Cartographic();\n    var scratchTimeInterval = new TimeInterval();\n    var scratchQuaternion = new Quaternion();\n\n    function unwrapColorInterval(czmlInterval) {\n        var rgbaf = czmlInterval.rgbaf;\n        if (defined(rgbaf)) {\n            return rgbaf;\n        }\n\n        var rgba = czmlInterval.rgba;\n        if (!defined(rgba)) {\n            return undefined;\n        }\n\n        var length = rgba.length;\n        if (length === Color.packedLength) {\n            return [Color.byteToFloat(rgba[0]), Color.byteToFloat(rgba[1]), Color.byteToFloat(rgba[2]), Color.byteToFloat(rgba[3])];\n        }\n\n        rgbaf = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            rgbaf[i] = rgba[i];\n            rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n            rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n            rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n            rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n        }\n        return rgbaf;\n    }\n\n    function unwrapUriInterval(czmlInterval, sourceUri) {\n        var uri = defaultValue(czmlInterval.uri, czmlInterval);\n        if (defined(sourceUri)) {\n            return sourceUri.getDerivedResource({\n                url: uri\n            });\n        }\n\n        return Resource.createIfNeeded(uri);\n    }\n\n    function unwrapRectangleInterval(czmlInterval) {\n        var wsen = czmlInterval.wsen;\n        if (defined(wsen)) {\n            return wsen;\n        }\n\n        var wsenDegrees = czmlInterval.wsenDegrees;\n        if (!defined(wsenDegrees)) {\n            return undefined;\n        }\n\n        var length = wsenDegrees.length;\n        if (length === Rectangle.packedLength) {\n            return [CesiumMath.toRadians(wsenDegrees[0]), CesiumMath.toRadians(wsenDegrees[1]), CesiumMath.toRadians(wsenDegrees[2]), CesiumMath.toRadians(wsenDegrees[3])];\n        }\n\n        wsen = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            wsen[i] = wsenDegrees[i];\n            wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n            wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n            wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n            wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n        }\n        return wsen;\n    }\n\n    function convertUnitSphericalToCartesian(unitSpherical) {\n        var length = unitSpherical.length;\n        scratchSpherical.magnitude = 1.0;\n        if (length === 2) {\n            scratchSpherical.clock = unitSpherical[0];\n            scratchSpherical.cone = unitSpherical[1];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length / 3 * 4);\n        for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n            result[j] = unitSpherical[i];\n\n            scratchSpherical.clock = unitSpherical[i + 1];\n            scratchSpherical.cone = unitSpherical[i + 2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[j + 1] = scratchCartesian.x;\n            result[j + 2] = scratchCartesian.y;\n            result[j + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertSphericalToCartesian(spherical) {\n        var length = spherical.length;\n        if (length === 3) {\n            scratchSpherical.clock = spherical[0];\n            scratchSpherical.cone = spherical[1];\n            scratchSpherical.magnitude = spherical[2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = spherical[i];\n\n            scratchSpherical.clock = spherical[i + 1];\n            scratchSpherical.cone = spherical[i + 2];\n            scratchSpherical.magnitude = spherical[i + 3];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicRadiansToCartesian(cartographicRadians) {\n        var length = cartographicRadians.length;\n        if (length === 3) {\n            scratchCartographic.longitude = cartographicRadians[0];\n            scratchCartographic.latitude = cartographicRadians[1];\n            scratchCartographic.height = cartographicRadians[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicRadians[i];\n\n            scratchCartographic.longitude = cartographicRadians[i + 1];\n            scratchCartographic.latitude = cartographicRadians[i + 2];\n            scratchCartographic.height = cartographicRadians[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicDegreesToCartesian(cartographicDegrees) {\n        var length = cartographicDegrees.length;\n        if (length === 3) {\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[0]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n            scratchCartographic.height = cartographicDegrees[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicDegrees[i];\n\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[i + 1]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[i + 2]);\n            scratchCartographic.height = cartographicDegrees[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function unwrapCartesianInterval(czmlInterval) {\n        var cartesian = czmlInterval.cartesian;\n        if (defined(cartesian)) {\n            return cartesian;\n        }\n\n        var cartesianVelocity = czmlInterval.cartesianVelocity;\n        if (defined(cartesianVelocity)) {\n            return cartesianVelocity;\n        }\n\n        var unitCartesian = czmlInterval.unitCartesian;\n        if (defined(unitCartesian)) {\n            return unitCartesian;\n        }\n\n        var unitSpherical = czmlInterval.unitSpherical;\n        if (defined(unitSpherical)) {\n            return convertUnitSphericalToCartesian(unitSpherical);\n        }\n\n        var spherical = czmlInterval.spherical;\n        if (defined(spherical)) {\n            return convertSphericalToCartesian(spherical);\n        }\n\n        var cartographicRadians = czmlInterval.cartographicRadians;\n        if (defined(cartographicRadians)) {\n            return convertCartographicRadiansToCartesian(cartographicRadians);\n        }\n\n        var cartographicDegrees = czmlInterval.cartographicDegrees;\n        if (defined(cartographicDegrees)) {\n            return convertCartographicDegreesToCartesian(cartographicDegrees);\n        }\n\n        throw new RuntimeError(JSON.stringify(czmlInterval) + ' is not a valid CZML interval.');\n    }\n\n    function normalizePackedCartesianArray(array, startingIndex) {\n        Cartesian3.unpack(array, startingIndex, scratchCartesian);\n        Cartesian3.normalize(scratchCartesian, scratchCartesian);\n        Cartesian3.pack(scratchCartesian, array, startingIndex);\n    }\n\n    function unwrapUnitCartesianInterval(czmlInterval) {\n        var cartesian = unwrapCartesianInterval(czmlInterval);\n        if (cartesian.length === 3) {\n            normalizePackedCartesianArray(cartesian, 0);\n            return cartesian;\n        }\n\n        for (var i = 1; i < cartesian.length; i += 4) {\n            normalizePackedCartesianArray(cartesian, i);\n        }\n\n        return cartesian;\n    }\n\n    function normalizePackedQuaternionArray(array, startingIndex) {\n        Quaternion.unpack(array, startingIndex, scratchQuaternion);\n        Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n        Quaternion.pack(scratchQuaternion, array, startingIndex);\n    }\n\n    function unwrapQuaternionInterval(czmlInterval) {\n        var unitQuaternion = czmlInterval.unitQuaternion;\n        if (defined(unitQuaternion)) {\n            if (unitQuaternion.length === 4) {\n                normalizePackedQuaternionArray(unitQuaternion, 0);\n                return unitQuaternion;\n            }\n\n            for (var i = 1; i < unitQuaternion.length; i += 5) {\n                normalizePackedQuaternionArray(unitQuaternion, i);\n            }\n        }\n        return unitQuaternion;\n    }\n\n    function getPropertyType(czmlInterval) {\n        // The associations in this function need to be kept in sync with the\n        // associations in unwrapInterval.\n\n        // Intentionally omitted due to conficts in CZML property names:\n        // * Image (conflicts with Uri)\n        // * Rotation (conflicts with Number)\n        //\n        // cartesianVelocity is also omitted due to incomplete support for\n        // derivative information in CZML properties.\n        // (Currently cartesianVelocity is hacked directly into the position processing code)\n        if (typeof czmlInterval === 'boolean') {\n            return Boolean;\n        } else if (typeof czmlInterval === 'number') {\n            return Number;\n        } else if (typeof czmlInterval === 'string') {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('array')) {\n            return Array;\n        } else if (czmlInterval.hasOwnProperty('boolean')) {\n            return Boolean;\n        } else if (czmlInterval.hasOwnProperty('boundingRectangle')) {\n            return BoundingRectangle;\n        } else if (czmlInterval.hasOwnProperty('cartesian2')) {\n            return Cartesian2;\n        } else if (czmlInterval.hasOwnProperty('cartesian') ||\n                   czmlInterval.hasOwnProperty('spherical') ||\n                   czmlInterval.hasOwnProperty('cartographicRadians') ||\n                   czmlInterval.hasOwnProperty('cartographicDegrees')) {\n            return Cartesian3;\n        } else if (czmlInterval.hasOwnProperty('unitCartesian') ||\n                   czmlInterval.hasOwnProperty('unitSpherical')) {\n            return UnitCartesian3;\n        } else if (czmlInterval.hasOwnProperty('rgba') ||\n                   czmlInterval.hasOwnProperty('rgbaf')) {\n            return Color;\n        } else if (czmlInterval.hasOwnProperty('arcType')) {\n            return ArcType;\n        } else if (czmlInterval.hasOwnProperty('classificationType')) {\n            return ClassificationType;\n        } else if (czmlInterval.hasOwnProperty('colorBlendMode')) {\n            return ColorBlendMode;\n        } else if (czmlInterval.hasOwnProperty('cornerType')) {\n            return CornerType;\n        } else if (czmlInterval.hasOwnProperty('heightReference')) {\n            return HeightReference;\n        } else if (czmlInterval.hasOwnProperty('horizontalOrigin')) {\n            return HorizontalOrigin;\n        } else if (czmlInterval.hasOwnProperty('date')) {\n            return JulianDate;\n        } else if (czmlInterval.hasOwnProperty('labelStyle')) {\n            return LabelStyle;\n        } else if (czmlInterval.hasOwnProperty('number')) {\n            return Number;\n        } else if (czmlInterval.hasOwnProperty('nearFarScalar')) {\n            return NearFarScalar;\n        } else if (czmlInterval.hasOwnProperty('distanceDisplayCondition')) {\n            return DistanceDisplayCondition;\n        } else if (czmlInterval.hasOwnProperty('object') ||\n                   czmlInterval.hasOwnProperty('value')) {\n            return Object;\n        } else if (czmlInterval.hasOwnProperty('unitQuaternion')) {\n            return Quaternion;\n        } else if (czmlInterval.hasOwnProperty('shadowMode')) {\n            return ShadowMode;\n        } else if (czmlInterval.hasOwnProperty('string')) {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('stripeOrientation')) {\n            return StripeOrientation;\n        } else if (czmlInterval.hasOwnProperty('wsen') ||\n                   czmlInterval.hasOwnProperty('wsenDegrees')) {\n            return Rectangle;\n        } else if (czmlInterval.hasOwnProperty('uri')) {\n            return Uri;\n        } else if (czmlInterval.hasOwnProperty('verticalOrigin')) {\n            return VerticalOrigin;\n        }\n        // fallback case\n        return Object;\n    }\n\n    function unwrapInterval(type, czmlInterval, sourceUri) {\n        // The associations in this function need to be kept in sync with the\n        // associations in getPropertyType\n        switch (type) {\n            case ArcType:\n                return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n            case Array:\n                return czmlInterval.array;\n            case Boolean:\n                return defaultValue(czmlInterval['boolean'], czmlInterval);\n            case BoundingRectangle:\n                return czmlInterval.boundingRectangle;\n            case Cartesian2:\n                return czmlInterval.cartesian2;\n            case Cartesian3:\n                return unwrapCartesianInterval(czmlInterval);\n            case UnitCartesian3:\n                return unwrapUnitCartesianInterval(czmlInterval);\n            case Color:\n                return unwrapColorInterval(czmlInterval);\n            case ClassificationType:\n                return ClassificationType[defaultValue(czmlInterval.classificationType, czmlInterval)];\n            case ColorBlendMode:\n                return ColorBlendMode[defaultValue(czmlInterval.colorBlendMode, czmlInterval)];\n            case CornerType:\n                return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n            case HeightReference:\n                return HeightReference[defaultValue(czmlInterval.heightReference, czmlInterval)];\n            case HorizontalOrigin:\n                return HorizontalOrigin[defaultValue(czmlInterval.horizontalOrigin, czmlInterval)];\n            case Image:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case JulianDate:\n                return JulianDate.fromIso8601(defaultValue(czmlInterval.date, czmlInterval));\n            case LabelStyle:\n                return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n            case Number:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case NearFarScalar:\n                return czmlInterval.nearFarScalar;\n            case DistanceDisplayCondition:\n                return czmlInterval.distanceDisplayCondition;\n            case Object:\n                return defaultValue(defaultValue(czmlInterval.object, czmlInterval.value), czmlInterval);\n            case Quaternion:\n                return unwrapQuaternionInterval(czmlInterval);\n            case Rectangle:\n                return unwrapRectangleInterval(czmlInterval);\n            case Rotation:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case ShadowMode:\n                return ShadowMode[defaultValue(defaultValue(czmlInterval.shadowMode, czmlInterval.shadows), czmlInterval)];\n            case String:\n                return defaultValue(czmlInterval.string, czmlInterval);\n            case StripeOrientation:\n                return StripeOrientation[defaultValue(czmlInterval.stripeOrientation, czmlInterval)];\n            case Uri:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case VerticalOrigin:\n                return VerticalOrigin[defaultValue(czmlInterval.verticalOrigin, czmlInterval)];\n            default:\n                throw new RuntimeError(type);\n        }\n    }\n\n    var interpolators = {\n        HERMITE : HermitePolynomialApproximation,\n        LAGRANGE : LagrangePolynomialApproximation,\n        LINEAR : LinearApproximation\n    };\n\n    function updateInterpolationSettings(packetData, property) {\n        var interpolationAlgorithm = packetData.interpolationAlgorithm;\n        var interpolationDegree = packetData.interpolationDegree;\n        if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n            property.setInterpolationOptions({\n                interpolationAlgorithm : interpolators[interpolationAlgorithm],\n                interpolationDegree : interpolationDegree\n            });\n        }\n\n        var forwardExtrapolationType = packetData.forwardExtrapolationType;\n        if (defined(forwardExtrapolationType)) {\n            property.forwardExtrapolationType = ExtrapolationType[forwardExtrapolationType];\n        }\n\n        var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n        if (defined(forwardExtrapolationDuration)) {\n            property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n        }\n\n        var backwardExtrapolationType = packetData.backwardExtrapolationType;\n        if (defined(backwardExtrapolationType)) {\n            property.backwardExtrapolationType = ExtrapolationType[backwardExtrapolationType];\n        }\n\n        var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n        if (defined(backwardExtrapolationDuration)) {\n            property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n        }\n    }\n\n    var iso8601Scratch = {\n        iso8601 : undefined\n    };\n\n    function intervalFromString(intervalString) {\n        if (!defined(intervalString)) {\n            return undefined;\n        }\n        iso8601Scratch.iso8601 = intervalString;\n        return TimeInterval.fromIso8601(iso8601Scratch);\n    }\n\n    function wrapPropertyInInfiniteInterval(property) {\n        var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n        interval.data = property;\n        return interval;\n    }\n\n    function convertPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositeProperty();\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function convertPositionPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositePositionProperty(property.referenceFrame);\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function processProperty(type, object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var packedLength;\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n\n        // CZML properties can be defined in many ways.  Most ways represent a structure for\n        // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n        // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n        // Alternatively, there are ways of defining a property that require specialized\n        // client-side representation. Currently, these are ReferenceProperty,\n        // and client-side velocity computation properties such as VelocityVectorProperty.\n        var isValue = !defined(packetData.reference) && !defined(packetData.velocityReference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePropertyData(object[propertyName], combinedInterval);\n        }\n\n        var isSampled = false;\n\n        if (isValue) {\n            unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n            if (!defined(unwrappedInterval)) {\n                // not a known value type, bail\n                return;\n            }\n            packedLength = defaultValue(type.packedLength, 1);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = !defined(packetData.array) && (typeof unwrappedInterval !== 'string') && (unwrappedIntervalLength > packedLength) && (type !== Object);\n        }\n\n        // Rotation is a special case because it represents a native type (Number)\n        // and therefore does not need to be unpacked when loaded as a constant value.\n        var needsUnpacking = typeof type.unpack === 'function' && type !== Rotation;\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantProperty(needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval);\n            } else {\n                object[propertyName] = createSpecializedProperty(type, entityCollection, packetData);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledProperty)) {\n                object[propertyName] = property = new SampledProperty(type);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval;\n            } else {\n                combinedInterval.data = createSpecializedProperty(type, entityCollection, packetData);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                object[propertyName] = property = isValue ? new TimeIntervalCollectionProperty() : new CompositeProperty();\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionProperty) {\n                // If we created a collection, or it already was one, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositeProperty) {\n                // If the collection was already a CompositeProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositeProperty but preserve the existing data.\n                object[propertyName] = property = convertPropertyToComposite(property);\n\n                // Change the new data to a ConstantProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositeProperty();\n        }\n\n        // Create a CompositeProperty but preserve the existing data.\n        if (!(property instanceof CompositeProperty)) {\n            object[propertyName] = property = convertPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n            // If not, create a SampledProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledProperty(type);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePropertyData(property, interval) {\n        if (property instanceof SampledProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositeProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPacketData(type, object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processProperty(type, object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processProperty(type, object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPositionProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n        var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n        var isValue = !defined(packetData.reference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePositionPropertyData(object[propertyName], combinedInterval);\n        }\n\n        var referenceFrame;\n        var isSampled = false;\n\n        if (isValue) {\n            if (defined(packetData.referenceFrame)) {\n                referenceFrame = ReferenceFrame[packetData.referenceFrame];\n            }\n            referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n            unwrappedInterval = unwrapCartesianInterval(packetData);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = unwrappedIntervalLength > packedLength;\n        }\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantPositionProperty(Cartesian3.unpack(unwrappedInterval), referenceFrame);\n            } else {\n                object[propertyName] = createReferenceProperty(entityCollection, packetData.reference);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledPositionProperty) || (defined(referenceFrame) && property.referenceFrame !== referenceFrame)) {\n                object[propertyName] = property = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n            } else {\n                combinedInterval.data = createReferenceProperty(entityCollection, packetData.reference);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                if (isValue) {\n                    property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n                } else {\n                    property = new CompositePositionProperty(referenceFrame);\n                }\n                object[propertyName] = property;\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionPositionProperty && (defined(referenceFrame) && property.referenceFrame === referenceFrame)) {\n                // If we create a collection, or it already existed, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositePositionProperty) {\n                // If the collection was already a CompositePositionProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositePositionProperty but preserve the existing data.\n                object[propertyName] = property = convertPositionPropertyToComposite(property);\n\n                // Change the new data to a ConstantPositionProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositePositionProperty(referenceFrame);\n        } else if (!(property instanceof CompositePositionProperty)) {\n            // Create a CompositeProperty but preserve the existing data.\n            object[propertyName] = property = convertPositionPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledPositionProperty) || (defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame)) {\n            // If not, create a SampledPositionProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePositionPropertyData(property, interval) {\n        if (property instanceof SampledPositionProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositePositionProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePositionPropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPositionPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processPositionProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processPositionProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processMaterialProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var property = object[propertyName];\n        var existingMaterial;\n        var existingInterval;\n\n        if (defined(combinedInterval)) {\n            if (!(property instanceof CompositeMaterialProperty)) {\n                property = new CompositeMaterialProperty();\n                object[propertyName] = property;\n            }\n            //See if we already have data at that interval.\n            var thisIntervals = property.intervals;\n            existingInterval = thisIntervals.findInterval({\n                start : combinedInterval.start,\n                stop : combinedInterval.stop\n            });\n            if (defined(existingInterval)) {\n                //We have an interval, but we need to make sure the\n                //new data is the same type of material as the old data.\n                existingMaterial = existingInterval.data;\n            } else {\n                //If not, create it.\n                existingInterval = combinedInterval.clone();\n                thisIntervals.addInterval(existingInterval);\n            }\n        } else {\n            existingMaterial = property;\n        }\n\n        var materialData;\n        if (defined(packetData.solidColor)) {\n            if (!(existingMaterial instanceof ColorMaterialProperty)) {\n                existingMaterial = new ColorMaterialProperty();\n            }\n            materialData = packetData.solidColor;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.grid)) {\n            if (!(existingMaterial instanceof GridMaterialProperty)) {\n                existingMaterial = new GridMaterialProperty();\n            }\n            materialData = packetData.grid;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'cellAlpha', materialData.cellAlpha, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineCount', materialData.lineCount, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineThickness', materialData.lineThickness, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineOffset', materialData.lineOffset, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.image)) {\n            if (!(existingMaterial instanceof ImageMaterialProperty)) {\n                existingMaterial = new ImageMaterialProperty();\n            }\n            materialData = packetData.image;\n            processPacketData(Image, existingMaterial, 'image', materialData.image, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Boolean, existingMaterial, 'transparent', materialData.transparent, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.stripe)) {\n            if (!(existingMaterial instanceof StripeMaterialProperty)) {\n                existingMaterial = new StripeMaterialProperty();\n            }\n            materialData = packetData.stripe;\n            processPacketData(StripeOrientation, existingMaterial, 'orientation', materialData.orientation, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'offset', materialData.offset, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineOutline)) {\n            if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n                existingMaterial = new PolylineOutlineMaterialProperty();\n            }\n            materialData = packetData.polylineOutline;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'outlineColor', materialData.outlineColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'outlineWidth', materialData.outlineWidth, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineGlow)) {\n            if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n                existingMaterial = new PolylineGlowMaterialProperty();\n            }\n            materialData = packetData.polylineGlow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'glowPower', materialData.glowPower, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'taperPower', materialData.taperPower, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineArrow)) {\n            if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n                existingMaterial = new PolylineArrowMaterialProperty();\n            }\n            materialData = packetData.polylineArrow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.polylineDash)) {\n            if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n                existingMaterial = new PolylineDashMaterialProperty();\n            }\n            materialData = packetData.polylineDash;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n            processPacketData(Color, existingMaterial, 'gapColor', materialData.gapColor, undefined, undefined, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashLength', materialData.dashLength, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashPattern', materialData.dashPattern, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.checkerboard)) {\n            if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n                existingMaterial = new CheckerboardMaterialProperty();\n            }\n            materialData = packetData.checkerboard;\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        }\n\n        if (defined(existingInterval)) {\n            existingInterval.data = existingMaterial;\n        } else {\n            object[propertyName] = existingMaterial;\n        }\n    }\n\n    function processMaterialPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processMaterialProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processMaterialProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processName(entity, packet, entityCollection, sourceUri) {\n        var nameData = packet.name;\n        if (defined(nameData)) {\n            entity.name = packet.name;\n        }\n    }\n\n    function processDescription(entity, packet, entityCollection, sourceUri) {\n        var descriptionData = packet.description;\n        if (defined(descriptionData)) {\n            processPacketData(String, entity, 'description', descriptionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processPosition(entity, packet, entityCollection, sourceUri) {\n        var positionData = packet.position;\n        if (defined(positionData)) {\n            processPositionPacketData(entity, 'position', positionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processViewFrom(entity, packet, entityCollection, sourceUri) {\n        var viewFromData = packet.viewFrom;\n        if (defined(viewFromData)) {\n            processPacketData(Cartesian3, entity, 'viewFrom', viewFromData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processOrientation(entity, packet, entityCollection, sourceUri) {\n        var orientationData = packet.orientation;\n        if (defined(orientationData)) {\n            processPacketData(Quaternion, entity, 'orientation', orientationData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processProperties(entity, packet, entityCollection, sourceUri) {\n        var propertiesData = packet.properties;\n        if (defined(propertiesData)) {\n            if (!defined(entity.properties)) {\n                entity.properties = new PropertyBag();\n            }\n\n            // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n            // because each property of \"properties\" may vary separately.\n            // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n            for (var key in propertiesData) {\n                if (propertiesData.hasOwnProperty(key)) {\n                    if (!entity.properties.hasProperty(key)) {\n                        entity.properties.addProperty(key);\n                    }\n\n                    var propertyData = propertiesData[key];\n                    if (Array.isArray(propertyData)) {\n                        for (var i = 0, len = propertyData.length; i < len; ++i) {\n                            processProperty(getPropertyType(propertyData[i]), entity.properties, key, propertyData[i], undefined, sourceUri, entityCollection);\n                        }\n                    } else {\n                        processProperty(getPropertyType(propertyData), entity.properties, key, propertyData, undefined, sourceUri, entityCollection);\n                    }\n                }\n            }\n        }\n    }\n\n    function processReferencesArrayPacketData(object, propertyName, references, interval, entityCollection, PropertyArrayType, CompositePropertyArrayType) {\n        var properties = references.map(function(reference) {\n            return createReferenceProperty(entityCollection, reference);\n        });\n\n        if (defined(interval)) {\n            interval = intervalFromString(interval);\n            var property = object[propertyName];\n            if (!(property instanceof CompositePropertyArrayType)) {\n                // If the property was not already a CompositeProperty,\n                // create a CompositeProperty but preserve the existing data.\n\n                // Create the composite and add the old property, wrapped in an infinite interval.\n                var composite = new CompositePropertyArrayType();\n                composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n\n                object[propertyName] = property = composite;\n            }\n\n            interval.data = new PropertyArrayType(properties);\n            property.intervals.addInterval(interval);\n        } else {\n            object[propertyName] = new PropertyArrayType(properties);\n        }\n    }\n\n    function processArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PropertyArray, CompositeProperty);\n        } else {\n            processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n        }\n    }\n\n    function processArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processPositionArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = Cartesian3.fromRadiansArrayHeights(packetData.cartographicRadians);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = Cartesian3.fromDegreesArrayHeights(packetData.cartographicDegrees);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function unpackCartesianArray(array) {\n        return Cartesian3.unpackArray(array);\n    }\n\n    function unpackCartographicRadiansArray(array) {\n        return Cartesian3.fromRadiansArrayHeights(array);\n    }\n\n    function unpackCartographicDegreesArray(array) {\n        return Cartesian3.fromDegreesArrayHeights(array);\n    }\n\n    function processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            var properties = references.map(function(referenceArray) {\n                var tempObj = {};\n                processReferencesArrayPacketData(tempObj, 'positions', referenceArray, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n                return tempObj.positions;\n            });\n            object[propertyName] = new PositionPropertyArray(properties);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = packetData.cartesian.map(unpackCartesianArray);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = packetData.cartographicRadians.map(unpackCartographicRadiansArray);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = packetData.cartographicDegrees.map(unpackCartographicDegreesArray);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArrayOfArrays(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (Array.isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayOfArraysPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processAvailability(entity, packet, entityCollection, sourceUri) {\n        var packetData = packet.availability;\n        if (!defined(packetData)) {\n            return;\n        }\n\n        var intervals;\n        if (Array.isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                if (!defined(intervals)) {\n                    intervals = new TimeIntervalCollection();\n                }\n                intervals.addInterval(intervalFromString(packetData[i]));\n            }\n        } else {\n            intervals = new TimeIntervalCollection();\n            intervals.addInterval(intervalFromString(packetData));\n        }\n        entity.availability = intervals;\n    }\n\n    function processAlignedAxis(billboard, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        processPacketData(UnitCartesian3, billboard, 'alignedAxis', packetData, interval, sourceUri, entityCollection);\n    }\n\n    function processBillboard(entity, packet, entityCollection, sourceUri) {\n        var billboardData = packet.billboard;\n        if (!defined(billboardData)) {\n            return;\n        }\n\n        var interval = intervalFromString(billboardData.interval);\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            entity.billboard = billboard = new BillboardGraphics();\n        }\n\n        processPacketData(Boolean, billboard, 'show', billboardData.show, interval, sourceUri, entityCollection);\n        processPacketData(Image, billboard, 'image', billboardData.image, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'scale', billboardData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, billboard, 'pixelOffset', billboardData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, billboard, 'eyeOffset', billboardData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, billboard, 'horizontalOrigin', billboardData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, billboard, 'verticalOrigin', billboardData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, billboard, 'heightReference', billboardData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, billboard, 'color', billboardData.color, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, billboard, 'rotation', billboardData.rotation, interval, sourceUri, entityCollection);\n        processAlignedAxis(billboard, billboardData.alignedAxis, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, billboard, 'sizeInMeters', billboardData.sizeInMeters, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'width', billboardData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'height', billboardData.height, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'scaleByDistance', billboardData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'translucencyByDistance', billboardData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'pixelOffsetScaleByDistance', billboardData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(BoundingRectangle, billboard, 'imageSubRegion', billboardData.imageSubRegion, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, billboard, 'distanceDisplayCondition', billboardData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'disableDepthTestDistance', billboardData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processBox(entity, packet, entityCollection, sourceUri) {\n        var boxData = packet.box;\n        if (!defined(boxData)) {\n            return;\n        }\n\n        var interval = intervalFromString(boxData.interval);\n        var box = entity.box;\n        if (!defined(box)) {\n            entity.box = box = new BoxGraphics();\n        }\n\n        processPacketData(Boolean, box, 'show', boxData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, box, 'dimensions', boxData.dimensions, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, box, 'heightReference', boxData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'fill', boxData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(box, 'material', boxData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'outline', boxData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, box, 'outlineColor', boxData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, box, 'outlineWidth', boxData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, box, 'shadows', boxData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, box, 'distanceDisplayCondition', boxData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCorridor(entity, packet, entityCollection, sourceUri) {\n        var corridorData = packet.corridor;\n        if (!defined(corridorData)) {\n            return;\n        }\n\n        var interval = intervalFromString(corridorData.interval);\n        var corridor = entity.corridor;\n        if (!defined(corridor)) {\n            entity.corridor = corridor = new CorridorGraphics();\n        }\n\n        processPacketData(Boolean, corridor, 'show', corridorData.show, interval, sourceUri, entityCollection);\n        processPositionArray(corridor, 'positions', corridorData.positions, entityCollection);\n        processPacketData(Number, corridor, 'width', corridorData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'height', corridorData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'heightReference', corridorData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'extrudedHeight', corridorData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'extrudedHeightReference', corridorData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(CornerType, corridor, 'cornerType', corridorData.cornerType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'granularity', corridorData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'fill', corridorData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(corridor, 'material', corridorData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'outline', corridorData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, corridor, 'outlineColor', corridorData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'outlineWidth', corridorData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, corridor, 'shadows', corridorData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, corridor, 'distanceDisplayCondition', corridorData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, corridor, 'classificationType', corridorData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'zIndex', corridorData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processCylinder(entity, packet, entityCollection, sourceUri) {\n        var cylinderData = packet.cylinder;\n        if (!defined(cylinderData)) {\n            return;\n        }\n\n        var interval = intervalFromString(cylinderData.interval);\n        var cylinder = entity.cylinder;\n        if (!defined(cylinder)) {\n            entity.cylinder = cylinder = new CylinderGraphics();\n        }\n\n        processPacketData(Boolean, cylinder, 'show', cylinderData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'length', cylinderData.length, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'topRadius', cylinderData.topRadius, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'bottomRadius', cylinderData.bottomRadius, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, cylinder, 'heightReference', cylinderData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'fill', cylinderData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(cylinder, 'material', cylinderData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'outline', cylinderData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, cylinder, 'outlineColor', cylinderData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'outlineWidth', cylinderData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'numberOfVerticalLines', cylinderData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'slices', cylinderData.slices, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, cylinder, 'shadows', cylinderData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, cylinder, 'distanceDisplayCondition', cylinderData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processDocument(packet, dataSource) {\n        var version = packet.version;\n        if (defined(version)) {\n            if (typeof version === 'string') {\n                var tokens = version.split('.');\n                if (tokens.length === 2) {\n                    if (tokens[0] !== '1') {\n                        throw new RuntimeError('Cesium only supports CZML version 1.');\n                    }\n                    dataSource._version = version;\n                }\n            }\n        }\n\n        if (!defined(dataSource._version)) {\n            throw new RuntimeError('CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.');\n        }\n\n        var documentPacket = dataSource._documentPacket;\n\n        if (defined(packet.name)) {\n            documentPacket.name = packet.name;\n        }\n\n        var clockPacket = packet.clock;\n        if (defined(clockPacket)) {\n            var clock = documentPacket.clock;\n            if (!defined(clock)) {\n                documentPacket.clock = {\n                    interval : clockPacket.interval,\n                    currentTime : clockPacket.currentTime,\n                    range : clockPacket.range,\n                    step : clockPacket.step,\n                    multiplier : clockPacket.multiplier\n                };\n            } else {\n                clock.interval = defaultValue(clockPacket.interval, clock.interval);\n                clock.currentTime = defaultValue(clockPacket.currentTime, clock.currentTime);\n                clock.range = defaultValue(clockPacket.range, clock.range);\n                clock.step = defaultValue(clockPacket.step, clock.step);\n                clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n            }\n        }\n    }\n\n    function processEllipse(entity, packet, entityCollection, sourceUri) {\n        var ellipseData = packet.ellipse;\n        if (!defined(ellipseData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipseData.interval);\n        var ellipse = entity.ellipse;\n        if (!defined(ellipse)) {\n            entity.ellipse = ellipse = new EllipseGraphics();\n        }\n\n        processPacketData(Boolean, ellipse, 'show', ellipseData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMajorAxis', ellipseData.semiMajorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMinorAxis', ellipseData.semiMinorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'height', ellipseData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'heightReference', ellipseData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'extrudedHeight', ellipseData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'extrudedHeightReference', ellipseData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'rotation', ellipseData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'stRotation', ellipseData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'granularity', ellipseData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'fill', ellipseData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipse, 'material', ellipseData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'outline', ellipseData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipse, 'outlineColor', ellipseData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'outlineWidth', ellipseData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'numberOfVerticalLines', ellipseData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipse, 'shadows', ellipseData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipse, 'distanceDisplayCondition', ellipseData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, ellipse, 'classificationType', ellipseData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'zIndex', ellipseData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processEllipsoid(entity, packet, entityCollection, sourceUri) {\n        var ellipsoidData = packet.ellipsoid;\n        if (!defined(ellipsoidData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipsoidData.interval);\n        var ellipsoid = entity.ellipsoid;\n        if (!defined(ellipsoid)) {\n            entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n        }\n\n        processPacketData(Boolean, ellipsoid, 'show', ellipsoidData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'radii', ellipsoidData.radii, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'innerRadii', ellipsoidData.innerRadii, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumClock', ellipsoidData.minimumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumClock', ellipsoidData.maximumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumCone', ellipsoidData.minimumCone, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumCone', ellipsoidData.maximumCone, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipsoid, 'heightReference', ellipsoidData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'fill', ellipsoidData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipsoid, 'material', ellipsoidData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'outline', ellipsoidData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipsoid, 'outlineColor', ellipsoidData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'outlineWidth', ellipsoidData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'stackPartitions', ellipsoidData.stackPartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'slicePartitions', ellipsoidData.slicePartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'subdivisions', ellipsoidData.subdivisions, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipsoid, 'shadows', ellipsoidData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipsoid, 'distanceDisplayCondition', ellipsoidData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processLabel(entity, packet, entityCollection, sourceUri) {\n        var labelData = packet.label;\n        if (!defined(labelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(labelData.interval);\n        var label = entity.label;\n        if (!defined(label)) {\n            entity.label = label = new LabelGraphics();\n        }\n\n        processPacketData(Boolean, label, 'show', labelData.show, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'text', labelData.text, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'font', labelData.font, interval, sourceUri, entityCollection);\n        processPacketData(LabelStyle, label, 'style', labelData.style, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'scale', labelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, label, 'showBackground', labelData.showBackground, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'backgroundColor', labelData.backgroundColor, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'backgroundPadding', labelData.backgroundPadding, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'pixelOffset', labelData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, label, 'eyeOffset', labelData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, label, 'horizontalOrigin', labelData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, label, 'verticalOrigin', labelData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, label, 'heightReference', labelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'fillColor', labelData.fillColor, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'outlineColor', labelData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'outlineWidth', labelData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'translucencyByDistance', labelData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'pixelOffsetScaleByDistance', labelData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'scaleByDistance', labelData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, label, 'distanceDisplayCondition', labelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'disableDepthTestDistance', labelData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processModel(entity, packet, entityCollection, sourceUri) {\n        var modelData = packet.model;\n        if (!defined(modelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(modelData.interval);\n        var model = entity.model;\n        if (!defined(model)) {\n            entity.model = model = new ModelGraphics();\n        }\n\n        processPacketData(Boolean, model, 'show', modelData.show, interval, sourceUri, entityCollection);\n        processPacketData(Uri, model, 'uri', modelData.gltf, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'scale', modelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'minimumPixelSize', modelData.minimumPixelSize, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'maximumScale', modelData.maximumScale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'incrementallyLoadTextures', modelData.incrementallyLoadTextures, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'runAnimations', modelData.runAnimations, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'clampAnimations', modelData.clampAnimations, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, model, 'shadows', modelData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, model, 'heightReference', modelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'silhouetteColor', modelData.silhouetteColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'silhouetteSize', modelData.silhouetteSize, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'color', modelData.color, interval, sourceUri, entityCollection);\n        processPacketData(ColorBlendMode, model, 'colorBlendMode', modelData.colorBlendMode, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'colorBlendAmount', modelData.colorBlendAmount, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, model, 'distanceDisplayCondition', modelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n\n        var i, len;\n        var nodeTransformationsData = modelData.nodeTransformations;\n        if (defined(nodeTransformationsData)) {\n            if (Array.isArray(nodeTransformationsData)) {\n                for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n                    processNodeTransformations(model, nodeTransformationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processNodeTransformations(model, nodeTransformationsData, interval, sourceUri, entityCollection);\n            }\n        }\n\n        var articulationsData = modelData.articulations;\n        if (defined(articulationsData)) {\n            if (Array.isArray(articulationsData)) {\n                for (i = 0, len = articulationsData.length; i < len; ++i) {\n                    processArticulations(model, articulationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processArticulations(model, articulationsData, interval, sourceUri, entityCollection);\n            }\n        }\n    }\n\n    function processNodeTransformations(model, nodeTransformationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var nodeTransformations = model.nodeTransformations;\n        var nodeNames = Object.keys(nodeTransformationsData);\n        for (var i = 0, len = nodeNames.length; i < len; ++i) {\n            var nodeName = nodeNames[i];\n            if (nodeName === 'interval') {\n                continue;\n            }\n\n            var nodeTransformationData = nodeTransformationsData[nodeName];\n            if (!defined(nodeTransformationData)) {\n                continue;\n            }\n\n            if (!defined(nodeTransformations)) {\n                model.nodeTransformations = nodeTransformations = new PropertyBag();\n            }\n\n            if (!nodeTransformations.hasProperty(nodeName)) {\n                nodeTransformations.addProperty(nodeName);\n            }\n\n            var nodeTransformation = nodeTransformations[nodeName];\n            if (!defined(nodeTransformation)) {\n                nodeTransformations[nodeName] = nodeTransformation = new NodeTransformationProperty();\n            }\n\n            processPacketData(Cartesian3, nodeTransformation, 'translation', nodeTransformationData.translation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Quaternion, nodeTransformation, 'rotation', nodeTransformationData.rotation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Cartesian3, nodeTransformation, 'scale', nodeTransformationData.scale, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processArticulations(model, articulationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(articulationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var articulations = model.articulations;\n        var keys = Object.keys(articulationsData);\n        for (var i = 0, len = keys.length; i < len; ++i) {\n            var key = keys[i];\n            if (key === 'interval') {\n                continue;\n            }\n\n            var articulationStageData = articulationsData[key];\n            if (!defined(articulationStageData)) {\n                continue;\n            }\n\n            if (!defined(articulations)) {\n                model.articulations = articulations = new PropertyBag();\n            }\n\n            if (!articulations.hasProperty(key)) {\n                articulations.addProperty(key);\n            }\n\n            processPacketData(Number, articulations, key, articulationStageData, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPath(entity, packet, entityCollection, sourceUri) {\n        var pathData = packet.path;\n        if (!defined(pathData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pathData.interval);\n        var path = entity.path;\n        if (!defined(path)) {\n            entity.path = path = new PathGraphics();\n        }\n\n        processPacketData(Boolean, path, 'show', pathData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'leadTime', pathData.leadTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'trailTime', pathData.trailTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'width', pathData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'resolution', pathData.resolution, interval, sourceUri, entityCollection);\n        processMaterialPacketData(path, 'material', pathData.material, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, path, 'distanceDisplayCondition', pathData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processPoint(entity, packet, entityCollection, sourceUri) {\n        var pointData = packet.point;\n        if (!defined(pointData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pointData.interval);\n        var point = entity.point;\n        if (!defined(point)) {\n            entity.point = point = new PointGraphics();\n        }\n\n        processPacketData(Boolean, point, 'show', pointData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'pixelSize', pointData.pixelSize, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, point, 'heightReference', pointData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'color', pointData.color, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'outlineColor', pointData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'outlineWidth', pointData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'scaleByDistance', pointData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'translucencyByDistance', pointData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, point, 'distanceDisplayCondition', pointData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'disableDepthTestDistance', pointData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function PolygonHierarchyProperty(polygon) {\n        this.polygon = polygon;\n        this._definitionChanged = new Event();\n    }\n\n    Object.defineProperties(PolygonHierarchyProperty.prototype, {\n        isConstant : {\n            get : function() {\n                var positions = this.polygon._positions;\n                var holes = this.polygon._holes;\n                return (!defined(positions) || positions.isConstant) &&\n                       (!defined(holes) || holes.isConstant);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    PolygonHierarchyProperty.prototype.getValue = function(time, result) {\n        var positions;\n        if (defined(this.polygon._positions)) {\n            positions = this.polygon._positions.getValue(time);\n        }\n\n        var holes;\n        if (defined(this.polygon._holes)) {\n            holes = this.polygon._holes.getValue(time);\n            if (defined(holes)) {\n                holes = holes.map(function(holePositions) {\n                    return new PolygonHierarchy(holePositions);\n                });\n            }\n        }\n\n        if (!defined(result)) {\n            return new PolygonHierarchy(positions, holes);\n        }\n\n        result.positions = positions;\n        result.holes = holes;\n        return result;\n    };\n\n    PolygonHierarchyProperty.prototype.equals = function(other) {\n        return this === other ||\n               (other instanceof PolygonHierarchyProperty &&\n                Property.equals(this.polygon._positions, other.polygon._positions) &&\n                Property.equals(this.polygon._holes, other.polygon._holes));\n    };\n\n    function processPolygon(entity, packet, entityCollection, sourceUri) {\n        var polygonData = packet.polygon;\n        if (!defined(polygonData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polygonData.interval);\n        var polygon = entity.polygon;\n        if (!defined(polygon)) {\n            entity.polygon = polygon = new PolygonGraphics();\n        }\n\n        processPacketData(Boolean, polygon, 'show', polygonData.show, interval, sourceUri, entityCollection);\n\n        // adapt 'position' property producing Cartesian[]\n        // and 'holes' property producing Cartesian[][]\n        // to a single property producing PolygonHierarchy\n        processPositionArray(polygon, '_positions', polygonData.positions, entityCollection);\n        processPositionArrayOfArrays(polygon, '_holes', polygonData.holes, entityCollection);\n        if (defined(polygon._positions) || defined(polygon._holes)) {\n            polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n        }\n\n        processPacketData(Number, polygon, 'height', polygonData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'heightReference', polygonData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'extrudedHeight', polygonData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'extrudedHeightReference', polygonData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, polygon, 'stRotation', polygonData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'granularity', polygonData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'fill', polygonData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polygon, 'material', polygonData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'outline', polygonData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, polygon, 'outlineColor', polygonData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'outlineWidth', polygonData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'perPositionHeight', polygonData.perPositionHeight, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeTop', polygonData.closeTop, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeBottom', polygonData.closeBottom, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polygon, 'arcType', polygonData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polygon, 'shadows', polygonData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polygon, 'distanceDisplayCondition', polygonData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polygon, 'classificationType', polygonData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'zIndex', polygonData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function adaptFollowSurfaceToArcType(followSurface) {\n        return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n    }\n\n    function processPolyline(entity, packet, entityCollection, sourceUri) {\n        var polylineData = packet.polyline;\n        if (!defined(polylineData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polylineData.interval);\n        var polyline = entity.polyline;\n        if (!defined(polyline)) {\n            entity.polyline = polyline = new PolylineGraphics();\n        }\n\n        processPacketData(Boolean, polyline, 'show', polylineData.show, interval, sourceUri, entityCollection);\n        processPositionArray(polyline, 'positions', polylineData.positions, entityCollection);\n        processPacketData(Number, polyline, 'width', polylineData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'granularity', polylineData.granularity, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'material', polylineData.material, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'depthFailMaterial', polylineData.depthFailMaterial, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polyline, 'arcType', polylineData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polyline, 'clampToGround', polylineData.clampToGround, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polyline, 'shadows', polylineData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polyline, 'distanceDisplayCondition', polylineData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polyline, 'classificationType', polylineData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'zIndex', polylineData.zIndex, interval, sourceUri, entityCollection);\n\n        // for backwards compatibility, adapt CZML followSurface to arcType.\n        if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n            var tempObj = {};\n            processPacketData(Boolean, tempObj, 'followSurface', polylineData.followSurface, interval, sourceUri, entityCollection);\n            polyline.arcType = createAdapterProperty(tempObj.followSurface, adaptFollowSurfaceToArcType);\n        }\n    }\n\n    function processRectangle(entity, packet, entityCollection, sourceUri) {\n        var rectangleData = packet.rectangle;\n        if (!defined(rectangleData)) {\n            return;\n        }\n\n        var interval = intervalFromString(rectangleData.interval);\n        var rectangle = entity.rectangle;\n        if (!defined(rectangle)) {\n            entity.rectangle = rectangle = new RectangleGraphics();\n        }\n\n        processPacketData(Boolean, rectangle, 'show', rectangleData.show, interval, sourceUri, entityCollection);\n        processPacketData(Rectangle, rectangle, 'coordinates', rectangleData.coordinates, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'height', rectangleData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'heightReference', rectangleData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'extrudedHeight', rectangleData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'extrudedHeightReference', rectangleData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'rotation', rectangleData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'stRotation', rectangleData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'granularity', rectangleData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'fill', rectangleData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(rectangle, 'material', rectangleData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'outline', rectangleData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, rectangle, 'outlineColor', rectangleData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'outlineWidth', rectangleData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, rectangle, 'shadows', rectangleData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, rectangle, 'distanceDisplayCondition', rectangleData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, rectangle, 'classificationType', rectangleData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'zIndex', rectangleData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processTileset(entity, packet, entityCollection, sourceUri) {\n        var tilesetData = packet.tileset;\n        if (!defined(tilesetData)) {\n            return;\n        }\n\n        var interval = intervalFromString(tilesetData.interval);\n        var tileset = entity.tileset;\n        if (!defined(tileset)) {\n            entity.tileset = tileset = new Cesium3DTilesetGraphics();\n        }\n\n        processPacketData(Boolean, tileset, 'show', tilesetData.show, interval, sourceUri, entityCollection);\n        processPacketData(Uri, tileset, 'uri', tilesetData.uri, interval, sourceUri, entityCollection);\n        processPacketData(Number, tileset, 'maximumScreenSpaceError', tilesetData.maximumScreenSpaceError, interval, sourceUri, entityCollection);\n    }\n\n    function processWall(entity, packet, entityCollection, sourceUri) {\n        var wallData = packet.wall;\n        if (!defined(wallData)) {\n            return;\n        }\n\n        var interval = intervalFromString(wallData.interval);\n        var wall = entity.wall;\n        if (!defined(wall)) {\n            entity.wall = wall = new WallGraphics();\n        }\n\n        processPacketData(Boolean, wall, 'show', wallData.show, interval, sourceUri, entityCollection);\n        processPositionArray(wall, 'positions', wallData.positions, entityCollection);\n        processArray(wall, 'minimumHeights', wallData.minimumHeights, entityCollection);\n        processArray(wall, 'maximumHeights', wallData.maximumHeights, entityCollection);\n        processPacketData(Number, wall, 'granularity', wallData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'fill', wallData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(wall, 'material', wallData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'outline', wallData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, wall, 'outlineColor', wallData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, wall, 'outlineWidth', wallData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, wall, 'shadows', wallData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, wall, 'distanceDisplayCondition', wallData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCzmlPacket(packet, entityCollection, updaterFunctions, sourceUri, dataSource) {\n        var objectId = packet.id;\n        if (!defined(objectId)) {\n            objectId = createGuid();\n        }\n\n        currentId = objectId;\n\n        if (!defined(dataSource._version) && objectId !== 'document') {\n            throw new RuntimeError('The first CZML packet is required to be the document object.');\n        }\n\n        if (packet['delete'] === true) {\n            entityCollection.removeById(objectId);\n        } else if (objectId === 'document') {\n            processDocument(packet, dataSource);\n        } else {\n            var entity = entityCollection.getOrCreateEntity(objectId);\n\n            var parentId = packet.parent;\n            if (defined(parentId)) {\n                entity.parent = entityCollection.getOrCreateEntity(parentId);\n            }\n\n            for (var i = updaterFunctions.length - 1; i > -1; i--) {\n                updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n            }\n        }\n\n        currentId = undefined;\n    }\n\n    function updateClock(dataSource) {\n        var clock;\n        var clockPacket = dataSource._documentPacket.clock;\n        if (!defined(clockPacket)) {\n            if (!defined(dataSource._clock)) {\n                var availability = dataSource._entityCollection.computeAvailability();\n                if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n                    var startTime = availability.start;\n                    var stopTime = availability.stop;\n                    var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n                    var multiplier = Math.round(totalSeconds / 120.0);\n\n                    clock = new DataSourceClock();\n                    clock.startTime = JulianDate.clone(startTime);\n                    clock.stopTime = JulianDate.clone(stopTime);\n                    clock.clockRange = ClockRange.LOOP_STOP;\n                    clock.multiplier = multiplier;\n                    clock.currentTime = JulianDate.clone(startTime);\n                    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                    dataSource._clock = clock;\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        if (defined(dataSource._clock)) {\n            clock = dataSource._clock.clone();\n        } else {\n            clock = new DataSourceClock();\n            clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n            clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.clockRange = ClockRange.LOOP_STOP;\n            clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n            clock.multiplier = 1.0;\n        }\n\n        var interval = intervalFromString(clockPacket.interval);\n        if (defined(interval)) {\n            clock.startTime = interval.start;\n            clock.stopTime = interval.stop;\n        }\n\n        if (defined(clockPacket.currentTime)) {\n            clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n        }\n        if (defined(clockPacket.range)) {\n            clock.clockRange = defaultValue(ClockRange[clockPacket.range], ClockRange.LOOP_STOP);\n        }\n        if (defined(clockPacket.step)) {\n            clock.clockStep = defaultValue(ClockStep[clockPacket.step], ClockStep.SYSTEM_CLOCK_MULTIPLIER);\n        }\n        if (defined(clockPacket.multiplier)) {\n            clock.multiplier = clockPacket.multiplier;\n        }\n\n        if (!clock.equals(dataSource._clock)) {\n            dataSource._clock = clock.clone(dataSource._clock);\n            return true;\n        }\n\n        return false;\n    }\n\n    function load(dataSource, czml, options, clear) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        var promise = czml;\n        var sourceUri = options.sourceUri;\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        dataSource._credit = credit;\n\n        // If the czml is a URL\n        if (typeof czml === 'string' || (czml instanceof Resource)) {\n            czml = Resource.createIfNeeded(czml);\n            promise = czml.fetchJson();\n            sourceUri = defaultValue(sourceUri, czml.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = czml.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        DataSource.setLoading(dataSource, true);\n\n        return when(promise, function(czml) {\n            return loadCzml(dataSource, czml, sourceUri, clear);\n        }).otherwise(function(error) {\n            DataSource.setLoading(dataSource, false);\n            dataSource._error.raiseEvent(dataSource, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    }\n\n    function loadCzml(dataSource, czml, sourceUri, clear) {\n        DataSource.setLoading(dataSource, true);\n        var entityCollection = dataSource._entityCollection;\n\n        if (clear) {\n            dataSource._version = undefined;\n            dataSource._documentPacket = new DocumentPacket();\n            entityCollection.removeAll();\n        }\n\n        CzmlDataSource._processCzml(czml, entityCollection, sourceUri, undefined, dataSource);\n\n        var raiseChangedEvent = updateClock(dataSource);\n\n        var documentPacket = dataSource._documentPacket;\n        if (defined(documentPacket.name) && dataSource._name !== documentPacket.name) {\n            dataSource._name = documentPacket.name;\n            raiseChangedEvent = true;\n        } else if (!defined(dataSource._name) && defined(sourceUri)) {\n            dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n            raiseChangedEvent = true;\n        }\n\n        DataSource.setLoading(dataSource, false);\n        if (raiseChangedEvent) {\n            dataSource._changed.raiseEvent(dataSource);\n        }\n\n        return dataSource;\n    }\n\n    function DocumentPacket() {\n        this.name = undefined;\n        this.clock = undefined;\n    }\n\n    /**\n     * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n     * @alias CzmlDataSource\n     * @constructor\n     *\n     * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n     */\n    function CzmlDataSource(name) {\n        this._name = name;\n        this._changed = new Event();\n        this._error = new Event();\n        this._isLoading = false;\n        this._loading = new Event();\n        this._clock = undefined;\n        this._documentPacket = new DocumentPacket();\n        this._version = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._entityCluster = new EntityCluster();\n        this._credit = undefined;\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided CZML data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n     */\n    CzmlDataSource.load = function(czml, options) {\n        return new CzmlDataSource().load(czml, options);\n    };\n\n    Object.defineProperties(CzmlDataSource.prototype, {\n        /**\n         * Gets a human-readable name for this instance.\n         * @memberof CzmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n         * defined in the CZML, the combined availability of all objects is returned.  If\n         * only static data exists, this value is undefined.\n         * @memberof CzmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof CzmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Gets the array of CZML processing functions.\n     * @memberof CzmlDataSource\n     * @type Array\n     */\n    CzmlDataSource.updaters = [\n        processBillboard, //\n        processBox, //\n        processCorridor, //\n        processCylinder, //\n        processEllipse, //\n        processEllipsoid, //\n        processLabel, //\n        processModel, //\n        processName, //\n        processDescription, //\n        processPath, //\n        processPoint, //\n        processPolygon, //\n        processPolyline, //\n        processProperties, //\n        processRectangle, //\n        processPosition, //\n        processTileset, //\n        processViewFrom, //\n        processWall, //\n        processOrientation, //\n        processAvailability];\n\n    /**\n     * Processes the provided url or CZML object without clearing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.process = function(czml, options) {\n        return load(this, czml, options, false);\n    };\n\n    /**\n     * Loads the provided url or CZML object, replacing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.load = function(czml, options) {\n        return load(this, czml, options, true);\n    };\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link Property} from a CZML packet.\n     * @function\n     *\n     * @param {Function} type The constructor function for the property being processed.\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPacketData = processPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link PositionProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPositionPacketData = processPositionPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link MaterialProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\n    CzmlDataSource._processCzml = function(czml, entityCollection, sourceUri, updaterFunctions, dataSource) {\n        updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n        if (Array.isArray(czml)) {\n            for (var i = 0, len = czml.length; i < len; ++i) {\n                processCzmlPacket(czml[i], entityCollection, updaterFunctions, sourceUri, dataSource);\n            }\n        } else {\n            processCzmlPacket(czml, entityCollection, updaterFunctions, sourceUri, dataSource);\n        }\n    };\nexport default CzmlDataSource;\n","var tmp = {};\n\n/*!\n * Autolinker.js\n * 3.11.0\n *\n * Copyright(c) 2019 Gregory Jacobs <greg@greg-jacobs.com>\n * MIT License\n *\n * https-colon-slashslash github.com/gregjacobs/Autolinker.js\n */\n(function (global, factory) {\n    global.Autolinker = factory();\n}(tmp, function () { 'use strict';\n\n    /**\n     * Assigns (shallow copies) the properties of `src` onto `dest`, if the\n     * corresponding property on `dest` === `undefined`.\n     *\n     * @param {Object} dest The destination object.\n     * @param {Object} src The source object.\n     * @return {Object} The destination object (`dest`)\n     */\n    function defaults(dest, src) {\n        for (var prop in src) {\n            if (src.hasOwnProperty(prop) && dest[prop] === undefined) {\n                dest[prop] = src[prop];\n            }\n        }\n        return dest;\n    }\n    /**\n     * Truncates the `str` at `len - ellipsisChars.length`, and adds the `ellipsisChars` to the\n     * end of the string (by default, two periods: '..'). If the `str` length does not exceed\n     * `len`, the string will be returned unchanged.\n     *\n     * @param {String} str The string to truncate and add an ellipsis to.\n     * @param {Number} truncateLen The length to truncate the string at.\n     * @param {String} [ellipsisChars=...] The ellipsis character(s) to add to the end of `str`\n     *   when truncated. Defaults to '...'\n     */\n    function ellipsis(str, truncateLen, ellipsisChars) {\n        var ellipsisLength;\n        if (str.length > truncateLen) {\n            if (ellipsisChars == null) {\n                ellipsisChars = '&hellip;';\n                ellipsisLength = 3;\n            }\n            else {\n                ellipsisLength = ellipsisChars.length;\n            }\n            str = str.substring(0, truncateLen - ellipsisLength) + ellipsisChars;\n        }\n        return str;\n    }\n    /**\n     * Supports `Array.prototype.indexOf()` functionality for old IE (IE8 and below).\n     *\n     * @param {Array} arr The array to find an element of.\n     * @param {*} element The element to find in the array, and return the index of.\n     * @return {Number} The index of the `element`, or -1 if it was not found.\n     */\n    function indexOf(arr, element) {\n        if (Array.prototype.indexOf) {\n            return arr.indexOf(element);\n        }\n        else {\n            for (var i = 0, len = arr.length; i < len; i++) {\n                if (arr[i] === element)\n                    return i;\n            }\n            return -1;\n        }\n    }\n    /**\n     * Removes array elements based on a filtering function. Mutates the input\n     * array.\n     *\n     * Using this instead of the ES5 Array.prototype.filter() function, to allow\n     * Autolinker compatibility with IE8, and also to prevent creating many new\n     * arrays in memory for filtering.\n     *\n     * @param {Array} arr The array to remove elements from. This array is\n     *   mutated.\n     * @param {Function} fn A function which should return `true` to\n     *   remove an element.\n     * @return {Array} The mutated input `arr`.\n     */\n    function remove(arr, fn) {\n        for (var i = arr.length - 1; i >= 0; i--) {\n            if (fn(arr[i]) === true) {\n                arr.splice(i, 1);\n            }\n        }\n    }\n    /**\n     * Performs the functionality of what modern browsers do when `String.prototype.split()` is called\n     * with a regular expression that contains capturing parenthesis.\n     *\n     * For example:\n     *\n     *     // Modern browsers:\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', ',', 'b', ',', 'c' ]\n     *\n     *     // Old IE (including IE8):\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', 'b', 'c' ]\n     *\n     * This method emulates the functionality of modern browsers for the old IE case.\n     *\n     * @param {String} str The string to split.\n     * @param {RegExp} splitRegex The regular expression to split the input `str` on. The splitting\n     *   character(s) will be spliced into the array, as in the \"modern browsers\" example in the\n     *   description of this method.\n     *   Note #1: the supplied regular expression **must** have the 'g' flag specified.\n     *   Note #2: for simplicity's sake, the regular expression does not need\n     *   to contain capturing parenthesis - it will be assumed that any match has them.\n     * @return {String[]} The split array of strings, with the splitting character(s) included.\n     */\n    function splitAndCapture(str, splitRegex) {\n        if (!splitRegex.global)\n            throw new Error(\"`splitRegex` must have the 'g' flag set\");\n        var result = [], lastIdx = 0, match;\n        while (match = splitRegex.exec(str)) {\n            result.push(str.substring(lastIdx, match.index));\n            result.push(match[0]); // push the splitting char(s)\n            lastIdx = match.index + match[0].length;\n        }\n        result.push(str.substring(lastIdx));\n        return result;\n    }\n    /**\n     * Function that should never be called but is used to check that every\n     * enum value is handled using TypeScript's 'never' type.\n     */\n    function throwUnhandledCaseError(theValue) {\n        throw new Error(\"Unhandled case for value: '\" + theValue + \"'\");\n    }\n\n    /**\n     * @class Autolinker.HtmlTag\n     * @extends Object\n     *\n     * Represents an HTML tag, which can be used to easily build/modify HTML tags programmatically.\n     *\n     * Autolinker uses this abstraction to create HTML tags, and then write them out as strings. You may also use\n     * this class in your code, especially within a {@link Autolinker#replaceFn replaceFn}.\n     *\n     * ## Examples\n     *\n     * Example instantiation:\n     *\n     *     var tag = new Autolinker.HtmlTag( {\n     *         tagName : 'a',\n     *         attrs   : { 'href': 'http-colon-slashslash google.com', 'class': 'external-link' },\n     *         innerHtml : 'Google'\n     *     } );\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *     // Individual accessor methods\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *\n     * Using mutator methods (which may be used in combination with instantiation config properties):\n     *\n     *     var tag = new Autolinker.HtmlTag();\n     *     tag.setTagName( 'a' );\n     *     tag.setAttr( 'href', 'http-colon-slashslash google.com' );\n     *     tag.addClass( 'external-link' );\n     *     tag.setInnerHtml( 'Google' );\n     *\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *\n     * ## Example use within a {@link Autolinker#replaceFn replaceFn}\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance, configured with the Match's href and anchor text\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     *\n     *\n     * ## Example use with a new tag for the replacement\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = new Autolinker.HtmlTag( {\n     *                 tagName : 'button',\n     *                 attrs   : { 'title': 'Load URL: ' + match.getAnchorHref() },\n     *                 innerHtml : 'Load URL: ' + match.getAnchorText()\n     *             } );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <button title=\"Load URL: http-colon-slashslash google.com\">Load URL: google.com</button>\n     */\n    var HtmlTag = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration properties for this class, in an Object (map)\n         */\n        function HtmlTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {String} tagName\n             *\n             * The tag name. Ex: 'a', 'button', etc.\n             *\n             * Not required at instantiation time, but should be set using {@link #setTagName} before {@link #toAnchorString}\n             * is executed.\n             */\n            this.tagName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object.<String, String>} attrs\n             *\n             * An key/value Object (map) of attributes to create the tag with. The keys are the attribute names, and the\n             * values are the attribute values.\n             */\n            this.attrs = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} innerHTML\n             *\n             * The inner HTML for the tag.\n             */\n            this.innerHTML = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} whitespaceRegex\n             *\n             * Regular expression used to match whitespace in a string of CSS classes.\n             */\n            this.whitespaceRegex = /\\s+/; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagName = cfg.tagName || '';\n            this.attrs = cfg.attrs || {};\n            this.innerHTML = cfg.innerHtml || cfg.innerHTML || ''; // accept either the camelCased form or the fully capitalized acronym as in the DOM\n        }\n        /**\n         * Sets the tag name that will be used to generate the tag with.\n         *\n         * @param {String} tagName\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setTagName = function (tagName) {\n            this.tagName = tagName;\n            return this;\n        };\n        /**\n         * Retrieves the tag name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getTagName = function () {\n            return this.tagName || '';\n        };\n        /**\n         * Sets an attribute on the HtmlTag.\n         *\n         * @param {String} attrName The attribute name to set.\n         * @param {String} attrValue The attribute value to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttr = function (attrName, attrValue) {\n            var tagAttrs = this.getAttrs();\n            tagAttrs[attrName] = attrValue;\n            return this;\n        };\n        /**\n         * Retrieves an attribute from the HtmlTag. If the attribute does not exist, returns `undefined`.\n         *\n         * @param {String} attrName The attribute name to retrieve.\n         * @return {String} The attribute's value, or `undefined` if it does not exist on the HtmlTag.\n         */\n        HtmlTag.prototype.getAttr = function (attrName) {\n            return this.getAttrs()[attrName];\n        };\n        /**\n         * Sets one or more attributes on the HtmlTag.\n         *\n         * @param {Object.<String, String>} attrs A key/value Object (map) of the attributes to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttrs = function (attrs) {\n            Object.assign(this.getAttrs(), attrs);\n            return this;\n        };\n        /**\n         * Retrieves the attributes Object (map) for the HtmlTag.\n         *\n         * @return {Object.<String, String>} A key/value object of the attributes for the HtmlTag.\n         */\n        HtmlTag.prototype.getAttrs = function () {\n            return this.attrs || (this.attrs = {});\n        };\n        /**\n         * Sets the provided `cssClass`, overwriting any current CSS classes on the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to set (overwrite).\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setClass = function (cssClass) {\n            return this.setAttr('class', cssClass);\n        };\n        /**\n         * Convenience method to add one or more CSS classes to the HtmlTag. Will not add duplicate CSS classes.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to add.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.addClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), newClasses = cssClass.split(whitespaceRegex), newClass;\n            while (newClass = newClasses.shift()) {\n                if (indexOf(classes, newClass) === -1) {\n                    classes.push(newClass);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to remove one or more CSS classes from the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to remove.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.removeClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), removeClasses = cssClass.split(whitespaceRegex), removeClass;\n            while (classes.length && (removeClass = removeClasses.shift())) {\n                var idx = indexOf(classes, removeClass);\n                if (idx !== -1) {\n                    classes.splice(idx, 1);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to retrieve the CSS class(es) for the HtmlTag, which will each be separated by spaces when\n         * there are multiple.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getClass = function () {\n            return this.getAttrs()['class'] || \"\";\n        };\n        /**\n         * Convenience method to check if the tag has a CSS class or not.\n         *\n         * @param {String} cssClass The CSS class to check for.\n         * @return {Boolean} `true` if the HtmlTag has the CSS class, `false` otherwise.\n         */\n        HtmlTag.prototype.hasClass = function (cssClass) {\n            return (' ' + this.getClass() + ' ').indexOf(' ' + cssClass + ' ') !== -1;\n        };\n        /**\n         * Sets the inner HTML for the tag.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHTML = function (html) {\n            this.innerHTML = html;\n            return this;\n        };\n        /**\n         * Backwards compatibility method name.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHtml = function (html) {\n            return this.setInnerHTML(html);\n        };\n        /**\n         * Retrieves the inner HTML for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHTML = function () {\n            return this.innerHTML || \"\";\n        };\n        /**\n         * Backward compatibility method name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHtml = function () {\n            return this.getInnerHTML();\n        };\n        /**\n         * Override of superclass method used to generate the HTML string for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.toAnchorString = function () {\n            var tagName = this.getTagName(), attrsStr = this.buildAttrsStr();\n            attrsStr = (attrsStr) ? ' ' + attrsStr : ''; // prepend a space if there are actually attributes\n            return ['<', tagName, attrsStr, '>', this.getInnerHtml(), '</', tagName, '>'].join(\"\");\n        };\n        /**\n         * Support method for {@link #toAnchorString}, returns the string space-separated key=\"value\" pairs, used to populate\n         * the stringified HtmlTag.\n         *\n         * @protected\n         * @return {String} Example return: `attr1=\"value1\" attr2=\"value2\"`\n         */\n        HtmlTag.prototype.buildAttrsStr = function () {\n            if (!this.attrs)\n                return \"\"; // no `attrs` Object (map) has been set, return empty string\n            var attrs = this.getAttrs(), attrsArr = [];\n            for (var prop in attrs) {\n                if (attrs.hasOwnProperty(prop)) {\n                    attrsArr.push(prop + '=\"' + attrs[prop] + '\"');\n                }\n            }\n            return attrsArr.join(\" \");\n        };\n        return HtmlTag;\n    }());\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed at a section within\n     * the URL making it still somewhat human readable.\n     *\n     * @param {String} url\t\t\t\t\t\t A URL.\n     * @param {Number} truncateLen\t\t The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars\t The characters to place within the url, e.g. \"...\".\n     * @return {String} The truncated URL.\n     */\n    function truncateSmart(url, truncateLen, ellipsisChars) {\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLength = 3;\n            ellipsisLengthBeforeParsing = 8;\n        }\n        else {\n            ellipsisLength = ellipsisChars.length;\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n        }\n        var parse_url = function (url) {\n            var urlObj = {};\n            var urlSub = url;\n            var match = urlSub.match(/^([a-z]+):\\/\\//i);\n            if (match) {\n                urlObj.scheme = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^(.*?)(?=(\\?|#|\\/|$))/i);\n            if (match) {\n                urlObj.host = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\/(.*?)(?=(\\?|#|$))/i);\n            if (match) {\n                urlObj.path = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\?(.*?)(?=(#|$))/i);\n            if (match) {\n                urlObj.query = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^#(.*?)$/i);\n            if (match) {\n                urlObj.fragment = match[1];\n                //urlSub = urlSub.substr(match[0].length);  -- not used. Uncomment if adding another block.\n            }\n            return urlObj;\n        };\n        var buildUrl = function (urlObj) {\n            var url = \"\";\n            if (urlObj.scheme && urlObj.host) {\n                url += urlObj.scheme + \"://\";\n            }\n            if (urlObj.host) {\n                url += urlObj.host;\n            }\n            if (urlObj.path) {\n                url += \"/\" + urlObj.path;\n            }\n            if (urlObj.query) {\n                url += \"?\" + urlObj.query;\n            }\n            if (urlObj.fragment) {\n                url += \"#\" + urlObj.fragment;\n            }\n            return url;\n        };\n        var buildSegment = function (segment, remainingAvailableLength) {\n            var remainingAvailableLengthHalf = remainingAvailableLength / 2, startOffset = Math.ceil(remainingAvailableLengthHalf), endOffset = (-1) * Math.floor(remainingAvailableLengthHalf), end = \"\";\n            if (endOffset < 0) {\n                end = segment.substr(endOffset);\n            }\n            return segment.substr(0, startOffset) + ellipsisChars + end;\n        };\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var urlObj = parse_url(url);\n        // Clean up the URL\n        if (urlObj.query) {\n            var matchQuery = urlObj.query.match(/^(.*?)(?=(\\?|\\#))(.*?)$/i);\n            if (matchQuery) {\n                // Malformed URL; two or more \"?\". Removed any content behind the 2nd.\n                urlObj.query = urlObj.query.substr(0, matchQuery[1].length);\n                url = buildUrl(urlObj);\n            }\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        if (urlObj.host) {\n            urlObj.host = urlObj.host.replace(/^www\\./, \"\");\n            url = buildUrl(urlObj);\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        // Process and build the URL\n        var str = \"\";\n        if (urlObj.host) {\n            str += urlObj.host;\n        }\n        if (str.length >= availableLength) {\n            if (urlObj.host.length == truncateLen) {\n                return (urlObj.host.substr(0, (truncateLen - ellipsisLength)) + ellipsisChars).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            return buildSegment(str, availableLength).substr(0, availableLength + ellipsisLengthBeforeParsing);\n        }\n        var pathAndQuery = \"\";\n        if (urlObj.path) {\n            pathAndQuery += \"/\" + urlObj.path;\n        }\n        if (urlObj.query) {\n            pathAndQuery += \"?\" + urlObj.query;\n        }\n        if (pathAndQuery) {\n            if ((str + pathAndQuery).length >= availableLength) {\n                if ((str + pathAndQuery).length == truncateLen) {\n                    return (str + pathAndQuery).substr(0, truncateLen);\n                }\n                var remainingAvailableLength = availableLength - str.length;\n                return (str + buildSegment(pathAndQuery, remainingAvailableLength)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += pathAndQuery;\n            }\n        }\n        if (urlObj.fragment) {\n            var fragment = \"#\" + urlObj.fragment;\n            if ((str + fragment).length >= availableLength) {\n                if ((str + fragment).length == truncateLen) {\n                    return (str + fragment).substr(0, truncateLen);\n                }\n                var remainingAvailableLength2 = availableLength - str.length;\n                return (str + buildSegment(fragment, remainingAvailableLength2)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += fragment;\n            }\n        }\n        if (urlObj.scheme && urlObj.host) {\n            var scheme = urlObj.scheme + \"://\";\n            if ((str + scheme).length < availableLength) {\n                return (scheme + str).substr(0, truncateLen);\n            }\n        }\n        if (str.length <= truncateLen) {\n            return str;\n        }\n        var end = \"\";\n        if (availableLength > 0) {\n            end = str.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (str.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed in the dead-center of the URL.\n     *\n     * @param {String} url             A URL.\n     * @param {Number} truncateLen     The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars   The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateMiddle(url, truncateLen, ellipsisChars) {\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLengthBeforeParsing = 8;\n            ellipsisLength = 3;\n        }\n        else {\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n            ellipsisLength = ellipsisChars.length;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var end = \"\";\n        if (availableLength > 0) {\n            end = url.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (url.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * A truncation feature where the ellipsis will be placed at the end of the URL.\n     *\n     * @param {String} anchorText\n     * @param {Number} truncateLen The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateEnd(anchorText, truncateLen, ellipsisChars) {\n        return ellipsis(anchorText, truncateLen, ellipsisChars);\n    }\n\n    /**\n     * @protected\n     * @class Autolinker.AnchorTagBuilder\n     * @extends Object\n     *\n     * Builds anchor (&lt;a&gt;) tags for the Autolinker utility when a match is\n     * found.\n     *\n     * Normally this class is instantiated, configured, and used internally by an\n     * {@link Autolinker} instance, but may actually be used indirectly in a\n     * {@link Autolinker#replaceFn replaceFn} to create {@link Autolinker.HtmlTag HtmlTag}\n     * instances which may be modified before returning from the\n     * {@link Autolinker#replaceFn replaceFn}. For example:\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     */\n    var AnchorTagBuilder = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the AnchorTagBuilder instance, specified in an Object (map).\n         */\n        function AnchorTagBuilder(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {Boolean} newWindow\n             * @inheritdoc Autolinker#newWindow\n             */\n            this.newWindow = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} truncate\n             * @inheritdoc Autolinker#truncate\n             */\n            this.truncate = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             * @inheritdoc Autolinker#className\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.newWindow = cfg.newWindow || false;\n            this.truncate = cfg.truncate || {};\n            this.className = cfg.className || '';\n        }\n        /**\n         * Generates the actual anchor (&lt;a&gt;) tag to use in place of the\n         * matched text, via its `match` object.\n         *\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Autolinker.HtmlTag} The HtmlTag instance for the anchor tag.\n         */\n        AnchorTagBuilder.prototype.build = function (match) {\n            return new HtmlTag({\n                tagName: 'a',\n                attrs: this.createAttrs(match),\n                innerHtml: this.processAnchorText(match.getAnchorText())\n            });\n        };\n        /**\n         * Creates the Object (map) of the HTML attributes for the anchor (&lt;a&gt;)\n         *   tag being generated.\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Object} A key/value Object (map) of the anchor tag's attributes.\n         */\n        AnchorTagBuilder.prototype.createAttrs = function (match) {\n            var attrs = {\n                'href': match.getAnchorHref() // we'll always have the `href` attribute\n            };\n            var cssClass = this.createCssClass(match);\n            if (cssClass) {\n                attrs['class'] = cssClass;\n            }\n            if (this.newWindow) {\n                attrs['target'] = \"_blank\";\n                attrs['rel'] = \"noopener noreferrer\"; // Issue #149. See https://mathiasbynens.github.io/rel-noopener/\n            }\n            if (this.truncate) {\n                if (this.truncate.length && this.truncate.length < match.getAnchorText().length) {\n                    attrs['title'] = match.getAnchorHref();\n                }\n            }\n            return attrs;\n        };\n        /**\n         * Creates the CSS class that will be used for a given anchor tag, based on\n         * the `matchType` and the {@link #className} config.\n         *\n         * Example returns:\n         *\n         * - \"\"                                      // no {@link #className}\n         * - \"myLink myLink-url\"                     // url match\n         * - \"myLink myLink-email\"                   // email match\n         * - \"myLink myLink-phone\"                   // phone match\n         * - \"myLink myLink-hashtag\"                 // hashtag match\n         * - \"myLink myLink-mention myLink-twitter\"  // mention match with Twitter service\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {String} The CSS class string for the link. Example return:\n         *   \"myLink myLink-url\". If no {@link #className} was configured, returns\n         *   an empty string.\n         */\n        AnchorTagBuilder.prototype.createCssClass = function (match) {\n            var className = this.className;\n            if (!className) {\n                return \"\";\n            }\n            else {\n                var returnClasses = [className], cssClassSuffixes = match.getCssClassSuffixes();\n                for (var i = 0, len = cssClassSuffixes.length; i < len; i++) {\n                    returnClasses.push(className + '-' + cssClassSuffixes[i]);\n                }\n                return returnClasses.join(' ');\n            }\n        };\n        /**\n         * Processes the `anchorText` by truncating the text according to the\n         * {@link #truncate} config.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The processed `anchorText`.\n         */\n        AnchorTagBuilder.prototype.processAnchorText = function (anchorText) {\n            anchorText = this.doTruncate(anchorText);\n            return anchorText;\n        };\n        /**\n         * Performs the truncation of the `anchorText` based on the {@link #truncate}\n         * option. If the `anchorText` is longer than the length specified by the\n         * {@link #truncate} option, the truncation is performed based on the\n         * `location` property. See {@link #truncate} for details.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The truncated anchor text.\n         */\n        AnchorTagBuilder.prototype.doTruncate = function (anchorText) {\n            var truncate = this.truncate;\n            if (!truncate || !truncate.length)\n                return anchorText;\n            var truncateLength = truncate.length, truncateLocation = truncate.location;\n            if (truncateLocation === 'smart') {\n                return truncateSmart(anchorText, truncateLength);\n            }\n            else if (truncateLocation === 'middle') {\n                return truncateMiddle(anchorText, truncateLength);\n            }\n            else {\n                return truncateEnd(anchorText, truncateLength);\n            }\n        };\n        return AnchorTagBuilder;\n    }());\n\n    /**\n     * @abstract\n     * @class Autolinker.match.Match\n     *\n     * Represents a match found in an input string which should be Autolinked. A Match object is what is provided in a\n     * {@link Autolinker#replaceFn replaceFn}, and may be used to query for details about the match.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                 case 'email' :\n     *                     console.log( \"email: \", match.getEmail() );\n     *\n     *                 case 'mention' :\n     *                     console.log( \"mention: \", match.getMention() );\n     *             }\n     *         }\n     *     } );\n     *\n     * See the {@link Autolinker} class for more details on using the {@link Autolinker#replaceFn replaceFn}.\n     */\n    var Match = /** @class */ (function () {\n        /**\n         * @member Autolinker.match.Match\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function Match(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate an anchor\n             * tag for the Match.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            /**\n             * @cfg {String} matchedText (required)\n             *\n             * The original text that was matched by the {@link Autolinker.matcher.Matcher}.\n             */\n            this.matchedText = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number} offset (required)\n             *\n             * The offset of where the match was made in the input string.\n             */\n            this.offset = 0; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n            this.matchedText = cfg.matchedText;\n            this.offset = cfg.offset;\n        }\n        /**\n         * Returns the original text that was matched.\n         *\n         * @return {String}\n         */\n        Match.prototype.getMatchedText = function () {\n            return this.matchedText;\n        };\n        /**\n         * Sets the {@link #offset} of where the match was made in the input string.\n         *\n         * A {@link Autolinker.matcher.Matcher} will be fed only HTML text nodes,\n         * and will therefore set an original offset that is relative to the HTML\n         * text node itself. However, we want this offset to be relative to the full\n         * HTML input string, and thus if using {@link Autolinker#parse} (rather\n         * than calling a {@link Autolinker.matcher.Matcher} directly), then this\n         * offset is corrected after the Matcher itself has done its job.\n         *\n         * @param {Number} offset\n         */\n        Match.prototype.setOffset = function (offset) {\n            this.offset = offset;\n        };\n        /**\n         * Returns the offset of where the match was made in the input string. This\n         * is the 0-based index of the match.\n         *\n         * @return {Number}\n         */\n        Match.prototype.getOffset = function () {\n            return this.offset;\n        };\n        /**\n         * Returns the CSS class suffix(es) for this match.\n         *\n         * A CSS class suffix is appended to the {@link Autolinker#className} in\n         * the {@link Autolinker.AnchorTagBuilder} when a match is translated into\n         * an anchor tag.\n         *\n         * For example, if {@link Autolinker#className} was configured as 'myLink',\n         * and this method returns `[ 'url' ]`, the final class name of the element\n         * will become: 'myLink myLink-url'.\n         *\n         * The match may provide multiple CSS class suffixes to be appended to the\n         * {@link Autolinker#className} in order to facilitate better styling\n         * options for different match criteria. See {@link Autolinker.match.Mention}\n         * for an example.\n         *\n         * By default, this method returns a single array with the match's\n         * {@link #getType type} name, but may be overridden by subclasses.\n         *\n         * @return {String[]}\n         */\n        Match.prototype.getCssClassSuffixes = function () {\n            return [this.getType()];\n        };\n        /**\n         * Builds and returns an {@link Autolinker.HtmlTag} instance based on the\n         * Match.\n         *\n         * This can be used to easily generate anchor tags from matches, and either\n         * return their HTML string, or modify them before doing so.\n         *\n         * Example Usage:\n         *\n         *     var tag = match.buildTag();\n         *     tag.addClass( 'cordova-link' );\n         *     tag.setAttr( 'target', '_system' );\n         *\n         *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"cordova-link\" target=\"_system\">Google</a>\n         *\n         * Example Usage in {@link Autolinker#replaceFn}:\n         *\n         *     var html = Autolinker.link( \"Test google.com\", {\n         *         replaceFn : function( match ) {\n         *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n         *             tag.setAttr( 'rel', 'nofollow' );\n         *\n         *             return tag;\n         *         }\n         *     } );\n         *\n         *     // generated html:\n         *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n         */\n        Match.prototype.buildTag = function () {\n            return this.tagBuilder.build(this);\n        };\n        return Match;\n    }());\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation. All rights reserved.\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\n    this file except in compliance with the License. You may obtain a copy of the\n    License at http-colon-slashslash www.apache.org/licenses/LICENSE-2.0\n\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n    MERCHANTABLITY OR NON-INFRINGEMENT.\n\n    See the Apache Version 2.0 License for specific language governing permissions\n    and limitations under the License.\n    ***************************************************************************** */\n    /* global Reflect, Promise */\n\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n\n    function __extends(d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n\n    /**\n     * @class Autolinker.match.Email\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Email match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var EmailMatch = /** @class */ (function (_super) {\n        __extends(EmailMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function EmailMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} email (required)\n             *\n             * The email address that was matched.\n             */\n            _this.email = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.email = cfg.email;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of EmailMatch, returns 'email'.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getType = function () {\n            return 'email';\n        };\n        /**\n         * Returns the email address that was matched.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getEmail = function () {\n            return this.email;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorHref = function () {\n            return 'mailto:' + this.email;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorText = function () {\n            return this.email;\n        };\n        return EmailMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Hashtag\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Hashtag match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var HashtagMatch = /** @class */ (function (_super) {\n        __extends(HashtagMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function HashtagMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} hashtag (required)\n             *\n             * The HashtagMatch that was matched, without the '#'.\n             */\n            _this.hashtag = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.serviceName = cfg.serviceName;\n            _this.hashtag = cfg.hashtag;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of HashtagMatch, returns 'hashtag'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getType = function () {\n            return 'hashtag';\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the HashtagMatch to.\n         * Ex: 'facebook', 'twitter'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the matched hashtag, without the '#' character.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getHashtag = function () {\n            return this.hashtag;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorHref = function () {\n            var serviceName = this.serviceName, hashtag = this.hashtag;\n            switch (serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/hashtag/' + hashtag;\n                case 'facebook':\n                    return 'https://www.facebook.com/hashtag/' + hashtag;\n                case 'instagram':\n                    return 'https://instagram.com/explore/tags/' + hashtag;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point hashtag to: ' + serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorText = function () {\n            return '#' + this.hashtag;\n        };\n        return HashtagMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Mention\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Mention match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var MentionMatch = /** @class */ (function (_super) {\n        __extends(MentionMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function MentionMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point mention matches to. See {@link Autolinker#mention}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} mention (required)\n             *\n             * The Mention that was matched, without the '@' character.\n             */\n            _this.mention = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.mention = cfg.mention;\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of MentionMatch, returns 'mention'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getType = function () {\n            return 'mention';\n        };\n        /**\n         * Returns the mention, without the '@' character.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getMention = function () {\n            return this.mention;\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the mention to.\n         * Ex: 'instagram', 'twitter', 'soundcloud'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorHref = function () {\n            switch (this.serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/' + this.mention;\n                case 'instagram':\n                    return 'https://instagram.com/' + this.mention;\n                case 'soundcloud':\n                    return 'https://soundcloud.com/' + this.mention;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point mention to: ' + this.serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorText = function () {\n            return '@' + this.mention;\n        };\n        /**\n         * Returns the CSS class suffixes that should be used on a tag built with\n         * the match. See {@link Autolinker.match.Match#getCssClassSuffixes} for\n         * details.\n         *\n         * @return {String[]}\n         */\n        MentionMatch.prototype.getCssClassSuffixes = function () {\n            var cssClassSuffixes = _super.prototype.getCssClassSuffixes.call(this), serviceName = this.getServiceName();\n            if (serviceName) {\n                cssClassSuffixes.push(serviceName);\n            }\n            return cssClassSuffixes;\n        };\n        return MentionMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Phone\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Phone number match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var PhoneMatch = /** @class */ (function (_super) {\n        __extends(PhoneMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function PhoneMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @protected\n             * @property {String} number (required)\n             *\n             * The phone number that was matched, without any delimiter characters.\n             *\n             * Note: This is a string to allow for prefixed 0's.\n             */\n            _this.number = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property  {Boolean} plusSign (required)\n             *\n             * `true` if the matched phone number started with a '+' sign. We'll include\n             * it in the `tel:` URL if so, as this is needed for international numbers.\n             *\n             * Ex: '+1 (123) 456 7879'\n             */\n            _this.plusSign = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.number = cfg.number;\n            _this.plusSign = cfg.plusSign;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of PhoneMatch, returns 'phone'.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getType = function () {\n            return 'phone';\n        };\n        /**\n         * Returns the phone number that was matched as a string, without any\n         * delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getPhoneNumber = function () {\n            return this.number;\n        };\n        /**\n         * Alias of {@link #getPhoneNumber}, returns the phone number that was\n         * matched as a string, without any delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getNumber = function () {\n            return this.getPhoneNumber();\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorHref = function () {\n            return 'tel:' + (this.plusSign ? '+' : '') + this.number;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorText = function () {\n            return this.matchedText;\n        };\n        return PhoneMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Url\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Url match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var UrlMatch = /** @class */ (function (_super) {\n        __extends(UrlMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function UrlMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} url (required)\n             *\n             * The url that was matched.\n             */\n            _this.url = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {\"scheme\"/\"www\"/\"tld\"} urlMatchType (required)\n             *\n             * The type of URL match that this class represents. This helps to determine\n             * if the match was made in the original text with a prefixed scheme (ex:\n             * 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex: 'www.google.com'), or\n             * was matched by a known top-level domain (ex: 'google.com').\n             */\n            _this.urlMatchType = 'scheme'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolUrlMatch (required)\n             *\n             * `true` if the URL is a match which already has a protocol (i.e.\n             * 'http-colon-slashslash '), `false` if the match was from a 'www' or known TLD match.\n             */\n            _this.protocolUrlMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolRelativeMatch (required)\n             *\n             * `true` if the URL is a protocol-relative match. A protocol-relative match\n             * is a URL that starts with '//', and will be either http-colon-slashslash  or https-colon-slashslash \n             * based on the protocol that the site is loaded under.\n             */\n            _this.protocolRelativeMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#cfg-stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#cfg-decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {RegExp} schemePrefixRegex\n             *\n             * A regular expression used to remove the 'http-colon-slashslash ' or 'https-colon-slashslash ' from\n             * URLs.\n             */\n            _this.schemePrefixRegex = /^(https?:\\/\\/)?/i;\n            /**\n             * @private\n             * @property {RegExp} wwwPrefixRegex\n             *\n             * A regular expression used to remove the 'www.' from URLs.\n             */\n            _this.wwwPrefixRegex = /^(https?:\\/\\/)?(www\\.)?/i;\n            /**\n             * @private\n             * @property {RegExp} protocolRelativeRegex\n             *\n             * The regular expression used to remove the protocol-relative '//' from the {@link #url} string, for purposes\n             * of {@link #getAnchorText}. A protocol-relative URL is, for example, \"//yahoo.com\"\n             */\n            _this.protocolRelativeRegex = /^\\/\\//;\n            /**\n             * @private\n             * @property {Boolean} protocolPrepended\n             *\n             * Will be set to `true` if the 'http-colon-slashslash ' protocol has been prepended to the {@link #url} (because the\n             * {@link #url} did not have a protocol)\n             */\n            _this.protocolPrepended = false;\n            _this.urlMatchType = cfg.urlMatchType;\n            _this.url = cfg.url;\n            _this.protocolUrlMatch = cfg.protocolUrlMatch;\n            _this.protocolRelativeMatch = cfg.protocolRelativeMatch;\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of UrlMatch, returns 'url'.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getType = function () {\n            return 'url';\n        };\n        /**\n         * Returns a string name for the type of URL match that this class\n         * represents.\n         *\n         * This helps to determine if the match was made in the original text with a\n         * prefixed scheme (ex: 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex:\n         * 'www.google.com'), or was matched by a known top-level domain (ex:\n         * 'google.com').\n         *\n         * @return {\"scheme\"/\"www\"/\"tld\"}\n         */\n        UrlMatch.prototype.getUrlMatchType = function () {\n            return this.urlMatchType;\n        };\n        /**\n         * Returns the url that was matched, assuming the protocol to be 'http-colon-slashslash ' if the original\n         * match was missing a protocol.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getUrl = function () {\n            var url = this.url;\n            // if the url string doesn't begin with a protocol, assume 'http://'\n            if (!this.protocolRelativeMatch && !this.protocolUrlMatch && !this.protocolPrepended) {\n                url = this.url = 'http://' + url;\n                this.protocolPrepended = true;\n            }\n            return url;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorHref = function () {\n            var url = this.getUrl();\n            return url.replace(/&amp;/g, '&'); // any &amp;'s in the URL should be converted back to '&' if they were displayed as &amp; in the source html\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorText = function () {\n            var anchorText = this.getMatchedText();\n            if (this.protocolRelativeMatch) {\n                // Strip off any protocol-relative '//' from the anchor text\n                anchorText = this.stripProtocolRelativePrefix(anchorText);\n            }\n            if (this.stripPrefix.scheme) {\n                anchorText = this.stripSchemePrefix(anchorText);\n            }\n            if (this.stripPrefix.www) {\n                anchorText = this.stripWwwPrefix(anchorText);\n            }\n            if (this.stripTrailingSlash) {\n                anchorText = this.removeTrailingSlash(anchorText); // remove trailing slash, if there is one\n            }\n            if (this.decodePercentEncoding) {\n                anchorText = this.removePercentEncoding(anchorText);\n            }\n            return anchorText;\n        };\n        // ---------------------------------------\n        // Utility Functionality\n        /**\n         * Strips the scheme prefix (such as \"http-colon-slashslash \" or \"https-colon-slashslash \") from the given\n         * `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the url scheme.\n         * @return {String} The `url`, with the scheme stripped.\n         */\n        UrlMatch.prototype.stripSchemePrefix = function (url) {\n            return url.replace(this.schemePrefixRegex, '');\n        };\n        /**\n         * Strips the 'www' prefix from the given `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the 'www' if it exists.\n         * @return {String} The `url`, with the 'www' stripped.\n         */\n        UrlMatch.prototype.stripWwwPrefix = function (url) {\n            return url.replace(this.wwwPrefixRegex, '$1'); // leave any scheme ($1), it one exists\n        };\n        /**\n         * Strips any protocol-relative '//' from the anchor text.\n         *\n         * @private\n         * @param {String} text The text of the anchor that is being generated, for which to strip off the\n         *   protocol-relative prefix (such as stripping off \"//\")\n         * @return {String} The `anchorText`, with the protocol-relative prefix stripped.\n         */\n        UrlMatch.prototype.stripProtocolRelativePrefix = function (text) {\n            return text.replace(this.protocolRelativeRegex, '');\n        };\n        /**\n         * Removes any trailing slash from the given `anchorText`, in preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being generated, for which to remove any trailing\n         *   slash ('/') that may exist.\n         * @return {String} The `anchorText`, with the trailing slash removed.\n         */\n        UrlMatch.prototype.removeTrailingSlash = function (anchorText) {\n            if (anchorText.charAt(anchorText.length - 1) === '/') {\n                anchorText = anchorText.slice(0, -1);\n            }\n            return anchorText;\n        };\n        /**\n         * Decodes percent-encoded characters from the given `anchorText`, in\n         * preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being\n         *   generated, for which to decode any percent-encoded characters.\n         * @return {String} The `anchorText`, with the percent-encoded characters\n         *   decoded.\n         */\n        UrlMatch.prototype.removePercentEncoding = function (anchorText) {\n            // First, convert a few of the known % encodings to the corresponding\n            // HTML entities that could accidentally be interpretted as special\n            // HTML characters\n            var preProcessedEntityAnchorText = anchorText\n                .replace(/%22/gi, '&quot;') // \" char\n                .replace(/%26/gi, '&amp;') // & char\n                .replace(/%27/gi, '&#39;') // ' char\n                .replace(/%3C/gi, '&lt;') // < char\n                .replace(/%3E/gi, '&gt;'); // > char\n            try {\n                // Now attempt to decode the rest of the anchor text\n                return decodeURIComponent(preProcessedEntityAnchorText);\n            }\n            catch (e) { // Invalid % escape sequence in the anchor text\n                return preProcessedEntityAnchorText;\n            }\n        };\n        return UrlMatch;\n    }(Match));\n\n    /**\n     * @abstract\n     * @class Autolinker.matcher.Matcher\n     *\n     * An abstract class and interface for individual matchers to find matches in\n     * an input string with linkified versions of them.\n     *\n     * Note that Matchers do not take HTML into account - they must be fed the text\n     * nodes of any HTML string, which is handled by {@link Autolinker#parse}.\n     */\n    var Matcher = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Matcher\n         *   instance, specified in an Object (map).\n         */\n        function Matcher(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate HTML tags\n             * for {@link Autolinker.match.Match Matches}.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n        }\n        return Matcher;\n    }());\n\n    /*\n     * This file builds and stores a library of the common regular expressions used\n     * by the Autolinker utility.\n     *\n     * Other regular expressions may exist ad-hoc, but these are generally the\n     * regular expressions that are shared between source files.\n     */\n    /**\n     * Regular expression to match upper and lowercase ASCII letters\n     */\n    var letterRe = /[A-Za-z]/;\n    /**\n     * Regular expression to match ASCII digits\n     */\n    var digitRe = /[0-9]/;\n    /**\n     * Regular expression to match whitespace\n     */\n    var whitespaceRe = /\\s/;\n    /**\n     * Regular expression to match quote characters\n     */\n    var quoteRe = /['\"]/;\n    /**\n     * Regular expression to match the range of ASCII control characters (0-31), and\n     * the backspace char (127)\n     */\n    var controlCharsRe = /[\\x00-\\x1F\\x7F]/;\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars in the unicode character set when placed in a\n     * RegExp character class (`[]`). This includes all international alphabetic\n     * characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}`\n     * escape (\"all letters\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Letter'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var alphaCharsStr = /A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FD5\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all emoji characters\n     * Source: https-colon-slashslash www.regextester.com/106421\n     */\n    var emojiStr = /\\u00a9\\u00ae\\u2000-\\u3300\\ud83c\\ud000-\\udfff\\ud83d\\ud000-\\udfff\\ud83e\\ud000-\\udfff/\n        .source;\n    /**\n     * The string form of a regular expression that would match all of the\n     * combining mark characters in the unicode character set when placed in a\n     * RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{M}`\n     * escape (\"all marks\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Mark'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var marksStr = /\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D4-\\u08E1\\u08E3-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFB-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C5\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uA9E5\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B-\\uAA7D\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars, emoji, and combining marks in the unicode character set\n     * when placed in a RegExp character class (`[]`). This includes all\n     * international alphabetic characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}\\p{M}`\n     * escapes and emoji characters.\n     */\n    var alphaCharsAndMarksStr = alphaCharsStr + emojiStr + marksStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * decimal number chars in the unicode character set when placed in a RegExp\n     * character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{Nd}`\n     * escape (\"all decimal numbers\")\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Decimal_Number'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var decimalNumbersStr = /0-9\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters and decimal number chars in the unicode character set when placed in\n     * a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{Nd}]` escape (\"all letters and decimal numbers\")\n     */\n    var alphaNumericCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters, combining marks, and decimal number chars in the unicode character\n     * set when placed in a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{M}\\p{Nd}]` escape (\"all letters, combining marks, and decimal\n     * numbers\")\n     */\n    var alphaNumericAndMarksCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    // Simplified IP regular expression\n    var ipStr = '(?:[' + decimalNumbersStr + ']{1,3}\\\\.){3}[' + decimalNumbersStr + ']{1,3}';\n    // Protected domain label which do not allow \"-\" character on the beginning and the end of a single label\n    var domainLabelStr = '[' + alphaNumericAndMarksCharsStr + '](?:[' + alphaNumericAndMarksCharsStr + '\\\\-]{0,61}[' + alphaNumericAndMarksCharsStr + '])?';\n    var getDomainLabelStr = function (group) {\n        return '(?=(' + domainLabelStr + '))\\\\' + group;\n    };\n    /**\n     * A function to match domain names of a URL or email address.\n     * Ex: 'google', 'yahoo', 'some-other-company', etc.\n     */\n    var getDomainNameStr = function (group) {\n        return '(?:' + getDomainLabelStr(group) + '(?:\\\\.' + getDomainLabelStr(group + 1) + '){0,126}|' + ipStr + ')';\n    };\n    /**\n     * A regular expression that is simply the character class of the characters\n     * that may be used in a domain name, minus the '-' or '.'\n     */\n    var domainNameCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"]\");\n\n    // NOTE: THIS IS A GENERATED FILE\n    // To update with the latest TLD list, run `npm run update-tld-regex` or `yarn update-tld-regex` (depending on which you have installed)\n    var tldRegex = /(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermgensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermgensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b||accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama||abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|||||||||abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|||||||||||||actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|||||||||||||aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone||||||||||||||||||||||||||aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip||||||||||||||||||||||||||||||ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)/;\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * @class Autolinker.matcher.Email\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find email matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var EmailMatcher = /** @class */ (function (_super) {\n        __extends(EmailMatcher, _super);\n        function EmailMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * Valid characters that can be used in the \"local\" part of an email address,\n             * i.e. the \"name\" part of \"name@site.com\"\n             */\n            _this.localPartCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"!#$%&'*+/=?^_`{|}~-]\");\n            /**\n             * Stricter TLD regex which adds a beginning and end check to ensure\n             * the string is a valid TLD\n             */\n            _this.strictTldRegex = new RegExp(\"^\" + tldRegex.source + \"$\");\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        EmailMatcher.prototype.parseMatches = function (text) {\n            var tagBuilder = this.tagBuilder, localPartCharRegex = this.localPartCharRegex, strictTldRegex = this.strictTldRegex, matches = [], len = text.length, noCurrentEmailMatch = new CurrentEmailMatch();\n            // for matching a 'mailto:' prefix\n            var mailtoTransitions = {\n                'm': 'a',\n                'a': 'i',\n                'i': 'l',\n                'l': 't',\n                't': 'o',\n                'o': ':',\n            };\n            var charIdx = 0, state = 0 /* NonEmailMatch */, currentEmailMatch = noCurrentEmailMatch;\n            // For debugging: search for other \"For debugging\" lines\n            // const table = new CliTable( {\n            // \thead: [ 'charIdx', 'char', 'state', 'charIdx', 'currentEmailAddress.idx', 'hasDomainDot' ]\n            // } );\n            while (charIdx < len) {\n                var char = text.charAt(charIdx);\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                switch (state) {\n                    case 0 /* NonEmailMatch */:\n                        stateNonEmailAddress(char);\n                        break;\n                    case 1 /* Mailto */:\n                        stateMailTo(text.charAt(charIdx - 1), char);\n                        break;\n                    case 2 /* LocalPart */:\n                        stateLocalPart(char);\n                        break;\n                    case 3 /* LocalPartDot */:\n                        stateLocalPartDot(char);\n                        break;\n                    case 4 /* AtSign */:\n                        stateAtSign(char);\n                        break;\n                    case 5 /* DomainChar */:\n                        stateDomainChar(char);\n                        break;\n                    case 6 /* DomainHyphen */:\n                        stateDomainHyphen(char);\n                        break;\n                    case 7 /* DomainDot */:\n                        stateDomainDot(char);\n                        break;\n                    default:\n                        throwUnhandledCaseError(state);\n                }\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                charIdx++;\n            }\n            // Capture any valid match at the end of the string\n            captureMatchIfValidAndReset();\n            // For debugging: search for other \"For debugging\" lines\n            //console.log( '\\n' + table.toString() );\n            return matches;\n            // Handles the state when we're not in an email address\n            function stateNonEmailAddress(char) {\n                if (char === 'm') {\n                    beginEmailMatch(1 /* Mailto */);\n                }\n                else if (localPartCharRegex.test(char)) {\n                    beginEmailMatch();\n                }\n            }\n            // Handles if we're reading a 'mailto:' prefix on the string\n            function stateMailTo(prevChar, char) {\n                if (prevChar === ':') {\n                    // We've reached the end of the 'mailto:' prefix\n                    if (localPartCharRegex.test(char)) {\n                        state = 2 /* LocalPart */;\n                        currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasMailtoPrefix: true }));\n                    }\n                    else {\n                        // we've matched 'mailto:' but didn't get anything meaningful\n                        // immediately afterwards (for example, we encountered a\n                        // space character, or an '@' character which formed 'mailto:@'\n                        resetToNonEmailMatchState();\n                    }\n                }\n                else if (mailtoTransitions[prevChar] === char) ;\n                else if (localPartCharRegex.test(char)) {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // different character that didn't continue the prefix\n                    state = 2 /* LocalPart */;\n                }\n                else if (char === '.') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // dot character\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // an @ character\n                    state = 4 /* AtSign */;\n                }\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state when we're currently in the \"local part\" of an\n            // email address (as opposed to the \"domain part\")\n            function stateLocalPart(char) {\n                if (char === '.') {\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    state = 4 /* AtSign */;\n                }\n                else if (localPartCharRegex.test(char)) ;\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state where we've read\n            function stateLocalPartDot(char) {\n                if (char === '.') {\n                    // We read a second '.' in a row, not a valid email address\n                    // local part\n                    resetToNonEmailMatchState();\n                }\n                else if (char === '@') {\n                    // We read the '@' character immediately after a dot ('.'), not\n                    // an email address\n                    resetToNonEmailMatchState();\n                }\n                else if (localPartCharRegex.test(char)) {\n                    state = 2 /* LocalPart */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateAtSign(char) {\n                if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateDomainChar(char) {\n                if (char === '.') {\n                    state = 7 /* DomainDot */;\n                }\n                else if (char === '-') {\n                    state = 6 /* DomainHyphen */;\n                }\n                else if (domainNameCharRegex.test(char)) ;\n                else {\n                    // Anything else, we potentially matched if the criteria has\n                    // been met\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainHyphen(char) {\n                if (char === '-' || char === '.') {\n                    // Not valid to have two hyphens (\"--\") or hypen+dot (\"-.\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainDot(char) {\n                if (char === '.' || char === '-') {\n                    // not valid to have two dots (\"..\") or dot+hypen (\".-\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                    // After having read a '.' and then a valid domain character,\n                    // we now know that the domain part of the email is valid, and\n                    // we have found at least a partial EmailMatch (however, the\n                    // email address may have additional characters from this point)\n                    currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasDomainDot: true }));\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function beginEmailMatch(newState) {\n                if (newState === void 0) { newState = 2 /* LocalPart */; }\n                state = newState;\n                currentEmailMatch = new CurrentEmailMatch({ idx: charIdx });\n            }\n            function resetToNonEmailMatchState() {\n                state = 0 /* NonEmailMatch */;\n                currentEmailMatch = noCurrentEmailMatch;\n            }\n            /*\n             * Captures the current email address as an EmailMatch if it's valid,\n             * and resets the state to read another email address.\n             */\n            function captureMatchIfValidAndReset() {\n                if (currentEmailMatch.hasDomainDot) { // we need at least one dot in the domain to be considered a valid email address\n                    var matchedText = text.slice(currentEmailMatch.idx, charIdx);\n                    // If we read a '.' or '-' char that ended the email address\n                    // (valid domain name characters, but only valid email address\n                    // characters if they are followed by something else), strip\n                    // it off now\n                    if (/[-.]$/.test(matchedText)) {\n                        matchedText = matchedText.slice(0, -1);\n                    }\n                    var emailAddress = currentEmailMatch.hasMailtoPrefix\n                        ? matchedText.slice('mailto:'.length)\n                        : matchedText;\n                    // if the email address has a valid TLD, add it to the list of matches\n                    if (doesEmailHaveValidTld(emailAddress)) {\n                        matches.push(new EmailMatch({\n                            tagBuilder: tagBuilder,\n                            matchedText: matchedText,\n                            offset: currentEmailMatch.idx,\n                            email: emailAddress\n                        }));\n                    }\n                }\n                resetToNonEmailMatchState();\n                /**\n                 * Determines if the given email address has a valid TLD or not\n                 * @param {string} emailAddress - email address\n                 * @return {Boolean} - true is email have valid TLD, false otherwise\n                 */\n                function doesEmailHaveValidTld(emailAddress) {\n                    var emailAddressTld = emailAddress.split('.').pop() || '';\n                    var emailAddressNormalized = emailAddressTld.toLowerCase();\n                    var isValidTld = strictTldRegex.test(emailAddressNormalized);\n                    return isValidTld;\n                }\n            }\n        };\n        return EmailMatcher;\n    }(Matcher));\n    var CurrentEmailMatch = /** @class */ (function () {\n        function CurrentEmailMatch(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.hasMailtoPrefix = !!cfg.hasMailtoPrefix;\n            this.hasDomainDot = !!cfg.hasDomainDot;\n        }\n        return CurrentEmailMatch;\n    }());\n\n    /**\n     * @private\n     * @class Autolinker.matcher.UrlMatchValidator\n     * @singleton\n     *\n     * Used by Autolinker to filter out false URL positives from the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     *\n     * Due to the limitations of regular expressions (including the missing feature\n     * of look-behinds in JS regular expressions), we cannot always determine the\n     * validity of a given match. This class applies a bit of additional logic to\n     * filter out any false positives that have been matched by the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     */\n    var UrlMatchValidator = /** @class */ (function () {\n        function UrlMatchValidator() {\n        }\n        /**\n         * Determines if a given URL match found by the {@link Autolinker.matcher.Url UrlMatcher}\n         * is valid. Will return `false` for:\n         *\n         * 1) URL matches which do not have at least have one period ('.') in the\n         *    domain name (effectively skipping over matches like \"abc:def\").\n         *    However, URL matches with a protocol will be allowed (ex: 'http-colon-slashslash localhost')\n         * 2) URL matches which do not have at least one word character in the\n         *    domain name (effectively skipping over matches like \"git:1.0\").\n         * 3) A protocol-relative url match (a URL beginning with '//') whose\n         *    previous character is a word character (effectively skipping over\n         *    strings like \"abc//google.com\")\n         *\n         * Otherwise, returns `true`.\n         *\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the match given is valid and should be\n         *   processed, or `false` if the match is invalid and/or should just not be\n         *   processed.\n         */\n        UrlMatchValidator.isValid = function (urlMatch, protocolUrlMatch) {\n            if ((protocolUrlMatch && !this.isValidUriScheme(protocolUrlMatch)) ||\n                this.urlMatchDoesNotHaveProtocolOrDot(urlMatch, protocolUrlMatch) || // At least one period ('.') must exist in the URL match for us to consider it an actual URL, *unless* it was a full protocol match (like 'http://localhost')\n                (this.urlMatchDoesNotHaveAtLeastOneWordChar(urlMatch, protocolUrlMatch) && // At least one letter character must exist in the domain name after a protocol match. Ex: skip over something like \"git:1.0\"\n                    !this.isValidIpAddress(urlMatch)) || // Except if it's an IP address\n                this.containsMultipleDots(urlMatch)) {\n                return false;\n            }\n            return true;\n        };\n        UrlMatchValidator.isValidIpAddress = function (uriSchemeMatch) {\n            var newRegex = new RegExp(this.hasFullProtocolRegex.source + this.ipRegex.source);\n            var uriScheme = uriSchemeMatch.match(newRegex);\n            return uriScheme !== null;\n        };\n        UrlMatchValidator.containsMultipleDots = function (urlMatch) {\n            var stringBeforeSlash = urlMatch;\n            if (this.hasFullProtocolRegex.test(urlMatch)) {\n                stringBeforeSlash = urlMatch.split('://')[1];\n            }\n            return stringBeforeSlash.split('/')[0].indexOf(\"..\") > -1;\n        };\n        /**\n         * Determines if the URI scheme is a valid scheme to be autolinked. Returns\n         * `false` if the scheme is 'javascript:' or 'vbscript:'\n         *\n         * @private\n         * @param {String} uriSchemeMatch The match URL string for a full URI scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com' or 'mailto:a@a.com'.\n         * @return {Boolean} `true` if the scheme is a valid one, `false` otherwise.\n         */\n        UrlMatchValidator.isValidUriScheme = function (uriSchemeMatch) {\n            var uriSchemeMatchArr = uriSchemeMatch.match(this.uriSchemeRegex), uriScheme = uriSchemeMatchArr && uriSchemeMatchArr[0].toLowerCase();\n            return (uriScheme !== 'javascript:' && uriScheme !== 'vbscript:');\n        };\n        /**\n         * Determines if a URL match does not have either:\n         *\n         * a) a full protocol (i.e. 'http-colon-slashslash '), or\n         * b) at least one dot ('.') in the domain name (for a non-full-protocol\n         *    match).\n         *\n         * Either situation is considered an invalid URL (ex: 'git:d' does not have\n         * either the '://' part, or at least one dot in the domain name. If the\n         * match was 'git:abc.com', we would consider this valid.)\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the URL match does not have a full protocol,\n         *   or at least one dot ('.') in a non-full-protocol match.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveProtocolOrDot = function (urlMatch, protocolUrlMatch) {\n            return (!!urlMatch && (!protocolUrlMatch || !this.hasFullProtocolRegex.test(protocolUrlMatch)) && urlMatch.indexOf('.') === -1);\n        };\n        /**\n         * Determines if a URL match does not have at least one word character after\n         * the protocol (i.e. in the domain name).\n         *\n         * At least one letter character must exist in the domain name after a\n         * protocol match. Ex: skip over something like \"git:1.0\"\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to know whether or not we\n         *   have a protocol in the URL string, in order to check for a word\n         *   character after the protocol separator (':').\n         * @return {Boolean} `true` if the URL match does not have at least one word\n         *   character in it after the protocol, `false` otherwise.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveAtLeastOneWordChar = function (urlMatch, protocolUrlMatch) {\n            if (urlMatch && protocolUrlMatch) {\n                return !this.hasWordCharAfterProtocolRegex.test(urlMatch);\n            }\n            else {\n                return false;\n            }\n        };\n        /**\n         * Regex to test for a full protocol, with the two trailing slashes. Ex: 'http-colon-slashslash '\n         *\n         * @private\n         * @property {RegExp} hasFullProtocolRegex\n         */\n        UrlMatchValidator.hasFullProtocolRegex = /^[A-Za-z][-.+A-Za-z0-9]*:\\/\\//;\n        /**\n         * Regex to find the URI scheme, such as 'mailto:'.\n         *\n         * This is used to filter out 'javascript:' and 'vbscript:' schemes.\n         *\n         * @private\n         * @property {RegExp} uriSchemeRegex\n         */\n        UrlMatchValidator.uriSchemeRegex = /^[A-Za-z][-.+A-Za-z0-9]*:/;\n        /**\n         * Regex to determine if at least one word char exists after the protocol (i.e. after the ':')\n         *\n         * @private\n         * @property {RegExp} hasWordCharAfterProtocolRegex\n         */\n        UrlMatchValidator.hasWordCharAfterProtocolRegex = new RegExp(\":[^\\\\s]*?[\" + alphaCharsStr + \"]\");\n        /**\n         * Regex to determine if the string is a valid IP address\n         *\n         * @private\n         * @property {RegExp} ipRegex\n         */\n        UrlMatchValidator.ipRegex = /[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?(:[0-9]*)?\\/?$/;\n        return UrlMatchValidator;\n    }());\n\n    /**\n     * @class Autolinker.matcher.Url\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find URL matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var UrlMatcher = /** @class */ (function (_super) {\n        __extends(UrlMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function UrlMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} matcherRegex\n             *\n             * The regular expression to match URLs with an optional scheme, port\n             * number, path, query string, and hash anchor.\n             *\n             * Example matches:\n             *\n             *     http-colon-slashslash google.com\n             *     www.google.com\n             *     google.com/path/to/file?q1=1&q2=2#myAnchor\n             *\n             *\n             * This regular expression will have the following capturing groups:\n             *\n             * 1.  Group that matches a scheme-prefixed URL (i.e. 'http-colon-slashslash google.com').\n             *     This is used to match scheme URLs with just a single word, such as\n             *     'http-colon-slashslash localhost', where we won't double check that the domain name\n             *     has at least one dot ('.') in it.\n             * 2.  Group that matches a 'www.' prefixed URL. This is only matched if the\n             *     'www.' text was not prefixed by a scheme (i.e.: not prefixed by\n             *     'http-colon-slashslash ', 'ftp:', etc.)\n             * 3.  A protocol-relative ('//') match for the case of a 'www.' prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     We need to know the character before the '//' in order to determine\n             *     if it is a valid match or the // was in a string we don't want to\n             *     auto-link.\n             * 4.  Group that matches a known TLD (top level domain), when a scheme\n             *     or 'www.'-prefixed domain is not matched.\n             * 5.  A protocol-relative ('//') match for the case of a known TLD prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     See #3 for more info.\n             */\n            _this.matcherRegex = (function () {\n                var schemeRegex = /(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\\/\\/)(?!\\d+\\/?)(?:\\/\\/)?)/, // match protocol, allow in format \"http://\" or \"mailto:\". However, do not match the first part of something like 'link:http://www.google.com' (i.e. don't match \"link:\"). Also, make sure we don't interpret 'google.com:8000' as if 'google.com' was a protocol here (i.e. ignore a trailing port number in this regex)\n                wwwRegex = /(?:www\\.)/, // starting with 'www.'\n                // Allow optional path, query string, and hash anchor, not ending in the following characters: \"?!:,.;\"\n                // http://blog.codinghorror.com/the-problem-with-urls/\n                urlSuffixRegex = new RegExp('[/?#](?:[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]?!:,.;\\u2713]*[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]\\u2713])?');\n                return new RegExp([\n                    '(?:',\n                    '(',\n                    schemeRegex.source,\n                    getDomainNameStr(2),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    wwwRegex.source,\n                    getDomainNameStr(6),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    getDomainNameStr(10) + '\\\\.',\n                    tldRegex.source,\n                    '(?![-' + alphaNumericCharsStr + '])',\n                    ')',\n                    ')',\n                    '(?::[0-9]+)?',\n                    '(?:' + urlSuffixRegex.source + ')?' // match for path, query string, and/or hash anchor - optional\n                ].join(\"\"), 'gi');\n            })();\n            /**\n             * A regular expression to use to check the character before a protocol-relative\n             * URL match. We don't want to match a protocol-relative URL if it is part\n             * of another word.\n             *\n             * For example, we want to match something like \"Go to: //google.com\",\n             * but we don't want to match something like \"abc//google.com\"\n             *\n             * This regular expression is used to test the character before the '//'.\n             *\n             * @protected\n             * @type {RegExp} wordCharRegExp\n             */\n            _this.wordCharRegExp = new RegExp('[' + alphaNumericAndMarksCharsStr + ']');\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        UrlMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, stripPrefix = this.stripPrefix, stripTrailingSlash = this.stripTrailingSlash, decodePercentEncoding = this.decodePercentEncoding, tagBuilder = this.tagBuilder, matches = [], match;\n            var _loop_1 = function () {\n                var matchStr = match[0], schemeUrlMatch = match[1], wwwUrlMatch = match[4], wwwProtocolRelativeMatch = match[5],\n                //tldUrlMatch = match[ 8 ],  -- not needed at the moment\n                tldProtocolRelativeMatch = match[9], offset = match.index, protocolRelativeMatch = wwwProtocolRelativeMatch || tldProtocolRelativeMatch, prevChar = text.charAt(offset - 1);\n                if (!UrlMatchValidator.isValid(matchStr, schemeUrlMatch)) {\n                    return \"continue\";\n                }\n                // If the match is preceded by an '@' character, then it is either\n                // an email address or a username. Skip these types of matches.\n                if (offset > 0 && prevChar === '@') {\n                    return \"continue\";\n                }\n                // If it's a protocol-relative '//' match, but the character before the '//'\n                // was a word character (i.e. a letter/number), then we found the '//' in the\n                // middle of another word (such as \"asdf//asdf.com\"). In this case, skip the\n                // match.\n                if (offset > 0 && protocolRelativeMatch && this_1.wordCharRegExp.test(prevChar)) {\n                    return \"continue\";\n                }\n                // If the URL ends with a question mark, don't include the question\n                // mark as part of the URL. We'll assume the question mark was the\n                // end of a sentence, such as: \"Going to google.com?\"\n                if (/\\?$/.test(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1);\n                }\n                // Handle a closing parenthesis or square bracket at the end of the\n                // match, and exclude it if there is not a matching open parenthesis\n                // or square bracket in the match itself.\n                if (this_1.matchHasUnbalancedClosingParen(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1); // remove the trailing \")\"\n                }\n                else {\n                    // Handle an invalid character after the TLD\n                    var pos = this_1.matchHasInvalidCharAfterTld(matchStr, schemeUrlMatch);\n                    if (pos > -1) {\n                        matchStr = matchStr.substr(0, pos); // remove the trailing invalid chars\n                    }\n                }\n                // The autolinker accepts many characters in a url's scheme (like `fake://test.com`).\n                // However, in cases where a URL is missing whitespace before an obvious link,\n                // (for example: `nowhitespacehttp://www.test.com`), we only want the match to start\n                // at the http:// part. We will check if the match contains a common scheme and then\n                // shift the match to start from there.\n                var foundCommonScheme = ['http://', 'https://'].find(function (commonScheme) { return !!schemeUrlMatch && schemeUrlMatch.indexOf(commonScheme) !== -1; });\n                if (foundCommonScheme) {\n                    // If we found an overmatched URL, we want to find the index\n                    // of where the match should start and shift the match to\n                    // start from the beginning of the common scheme\n                    var indexOfSchemeStart = matchStr.indexOf(foundCommonScheme);\n                    matchStr = matchStr.substr(indexOfSchemeStart);\n                    schemeUrlMatch = schemeUrlMatch.substr(indexOfSchemeStart);\n                    offset = offset + indexOfSchemeStart;\n                }\n                var urlMatchType = schemeUrlMatch ? 'scheme' : (wwwUrlMatch ? 'www' : 'tld'), protocolUrlMatch = !!schemeUrlMatch;\n                matches.push(new UrlMatch({\n                    tagBuilder: tagBuilder,\n                    matchedText: matchStr,\n                    offset: offset,\n                    urlMatchType: urlMatchType,\n                    url: matchStr,\n                    protocolUrlMatch: protocolUrlMatch,\n                    protocolRelativeMatch: !!protocolRelativeMatch,\n                    stripPrefix: stripPrefix,\n                    stripTrailingSlash: stripTrailingSlash,\n                    decodePercentEncoding: decodePercentEncoding,\n                }));\n            };\n            var this_1 = this;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                _loop_1();\n            }\n            return matches;\n        };\n        /**\n         * Determines if a match found has an unmatched closing parenthesis or\n         * square bracket. If so, the parenthesis or square bracket will be removed\n         * from the match itself, and appended after the generated anchor tag.\n         *\n         * A match may have an extra closing parenthesis at the end of the match\n         * because the regular expression must include parenthesis for URLs such as\n         * \"wikipedia.com/something_(disambiguation)\", which should be auto-linked.\n         *\n         * However, an extra parenthesis *will* be included when the URL itself is\n         * wrapped in parenthesis, such as in the case of:\n         *     \"(wikipedia.com/something_(disambiguation))\"\n         * In this case, the last closing parenthesis should *not* be part of the\n         * URL itself, and this method will return `true`.\n         *\n         * For square brackets in URLs such as in PHP arrays, the same behavior as\n         * parenthesis discussed above should happen:\n         *     \"[http-colon-slashslash www.example.com/foo.php?bar[]=1&bar[]=2&bar[]=3]\"\n         * The closing square bracket should not be part of the URL itself, and this\n         * method will return `true`.\n         *\n         * @protected\n         * @param {String} matchStr The full match string from the {@link #matcherRegex}.\n         * @return {Boolean} `true` if there is an unbalanced closing parenthesis or\n         *   square bracket at the end of the `matchStr`, `false` otherwise.\n         */\n        UrlMatcher.prototype.matchHasUnbalancedClosingParen = function (matchStr) {\n            var endChar = matchStr.charAt(matchStr.length - 1);\n            var startChar;\n            if (endChar === ')') {\n                startChar = '(';\n            }\n            else if (endChar === ']') {\n                startChar = '[';\n            }\n            else {\n                return false; // not a close parenthesis or square bracket\n            }\n            // Find if there are the same number of open braces as close braces in\n            // the URL string, minus the last character (which we have already\n            // determined to be either ')' or ']'\n            var numOpenBraces = 0;\n            for (var i = 0, len = matchStr.length - 1; i < len; i++) {\n                var char = matchStr.charAt(i);\n                if (char === startChar) {\n                    numOpenBraces++;\n                }\n                else if (char === endChar) {\n                    numOpenBraces = Math.max(numOpenBraces - 1, 0);\n                }\n            }\n            // If the number of open braces matches the number of close braces in\n            // the URL minus the last character, then the match has *unbalanced*\n            // braces because of the last character. Example of unbalanced braces\n            // from the regex match:\n            //     \"http://example.com?a[]=1]\"\n            if (numOpenBraces === 0) {\n                return true;\n            }\n            return false;\n        };\n        /**\n         * Determine if there's an invalid character after the TLD in a URL. Valid\n         * characters after TLD are ':/?#'. Exclude scheme matched URLs from this\n         * check.\n         *\n         * @protected\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} schemeUrlMatch The match URL string for a scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Number} the position where the invalid character was found. If\n         *   no such character was found, returns -1\n         */\n        UrlMatcher.prototype.matchHasInvalidCharAfterTld = function (urlMatch, schemeUrlMatch) {\n            if (!urlMatch) {\n                return -1;\n            }\n            var offset = 0;\n            if (schemeUrlMatch) {\n                offset = urlMatch.indexOf(':');\n                urlMatch = urlMatch.slice(offset);\n            }\n            var re = new RegExp(\"^((.?\\/\\/)?[-.\" + alphaNumericAndMarksCharsStr + \"]*[-\" + alphaNumericAndMarksCharsStr + \"]\\\\.[-\" + alphaNumericAndMarksCharsStr + \"]+)\");\n            var res = re.exec(urlMatch);\n            if (res === null) {\n                return -1;\n            }\n            offset += res[1].length;\n            urlMatch = urlMatch.slice(res[1].length);\n            if (/^[^-.A-Za-z0-9:\\/?#]/.test(urlMatch)) {\n                return offset;\n            }\n            return -1;\n        };\n        return UrlMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Hashtag\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find HashtagMatch matches in an input string.\n     */\n    var HashtagMatcher = /** @class */ (function (_super) {\n        __extends(HashtagMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function HashtagMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * The regular expression to match Hashtags. Example match:\n             *\n             *     #asdf\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = new RegExp(\"#[_\" + alphaNumericAndMarksCharsStr + \"]{1,139}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'); // lookahead used to make sure we don't match something above 139 characters\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @protected\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        HashtagMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, nonWordCharRegex = this.nonWordCharRegex, serviceName = this.serviceName, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not a '#' char\n                // in the middle of a word), then it is a hashtag match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0], hashtag = match[0].slice(1); // strip off the '#' character at the beginning\n                    matches.push(new HashtagMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        hashtag: hashtag\n                    }));\n                }\n            }\n            return matches;\n        };\n        return HashtagMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Phone\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find Phone number matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more\n     * details.\n     */\n    var PhoneMatcher = /** @class */ (function (_super) {\n        __extends(PhoneMatcher, _super);\n        function PhoneMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * The regular expression to match Phone numbers. Example match:\n             *\n             *     (123) 456-7890\n             *\n             * This regular expression has the following capturing groups:\n             *\n             * 1 or 2. The prefixed '+' sign, if there is one.\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = /(?:(?:(?:(\\+)?\\d{1,3}[-\\040.]?)?\\(?\\d{3}\\)?[-\\040.]?\\d{3}[-\\040.]?\\d{4})|(?:(\\+)(?:9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\\040.]?(?:\\d[-\\040.]?){6,12}\\d+))([,;]+[0-9]+#?)*/g;\n            return _this;\n        }\n        // ex: (123) 456-7890, 123 456 7890, 123-456-7890, +18004441234,,;,10226420346#,\n        // +1 (800) 444 1234, 10226420346#, 1-800-444-1234,1022,64,20346#\n        /**\n         * @inheritdoc\n         */\n        PhoneMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                // Remove non-numeric values from phone number string\n                var matchedText = match[0], cleanNumber = matchedText.replace(/[^0-9,;#]/g, ''), // strip out non-digit characters exclude comma semicolon and #\n                plusSign = !!(match[1] || match[2]), // match[ 1 ] or match[ 2 ] is the prefixed plus sign, if there is one\n                before = match.index == 0 ? '' : text.substr(match.index - 1, 1), after = text.substr(match.index + matchedText.length, 1), contextClear = !before.match(/\\d/) && !after.match(/\\d/);\n                if (this.testMatch(match[3]) && this.testMatch(matchedText) && contextClear) {\n                    matches.push(new PhoneMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: match.index,\n                        number: cleanNumber,\n                        plusSign: plusSign\n                    }));\n                }\n            }\n            return matches;\n        };\n        PhoneMatcher.prototype.testMatch = function (text) {\n            return /\\D/.test(text);\n        };\n        return PhoneMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Mention\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find/replace username matches in an input string.\n     */\n    var MentionMatcher = /** @class */ (function (_super) {\n        __extends(MentionMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function MentionMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {'twitter'/'instagram'/'soundcloud'} protected\n             *\n             * The name of service to link @mentions to.\n             *\n             * Valid values are: 'twitter', 'instagram', or 'soundcloud'\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * Hash of regular expression to match username handles. Example match:\n             *\n             *     @asdf\n             *\n             * @private\n             * @property {Object} matcherRegexes\n             */\n            _this.matcherRegexes = {\n                'twitter': new RegExp(\"@[_\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'instagram': new RegExp(\"@[_.\" + alphaNumericAndMarksCharsStr + \"]{1,30}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'soundcloud': new RegExp(\"@[-_.\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![-_\" + alphaNumericAndMarksCharsStr + \"])\", 'g') // lookahead used to make sure we don't match something above 50 characters\n            };\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @private\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        MentionMatcher.prototype.parseMatches = function (text) {\n            var serviceName = this.serviceName, matcherRegex = this.matcherRegexes[this.serviceName], nonWordCharRegex = this.nonWordCharRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            if (!matcherRegex) {\n                return matches;\n            }\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not an email\n                // address), then it is a username match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0].replace(/\\.+$/g, ''), // strip off trailing .\n                    mention = matchedText.slice(1); // strip off the '@' character at the beginning\n                    matches.push(new MentionMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        mention: mention\n                    }));\n                }\n            }\n            return matches;\n        };\n        return MentionMatcher;\n    }(Matcher));\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * Parses an HTML string, calling the callbacks to notify of tags and text.\n     *\n     * ## History\n     *\n     * This file previously used a regular expression to find html tags in the input\n     * text. Unfortunately, we ran into a bunch of catastrophic backtracking issues\n     * with certain input text, causing Autolinker to either hang or just take a\n     * really long time to parse the string.\n     *\n     * The current code is intended to be a O(n) algorithm that walks through\n     * the string in one pass, and tries to be as cheap as possible. We don't need\n     * to implement the full HTML spec, but rather simply determine where the string\n     * looks like an HTML tag, and where it looks like text (so that we can autolink\n     * that).\n     *\n     * This state machine parser is intended just to be a simple but performant\n     * parser of HTML for the subset of requirements we have. We simply need to:\n     *\n     * 1. Determine where HTML tags are\n     * 2. Determine the tag name (Autolinker specifically only cares about <a>,\n     *    <script>, and <style> tags, so as not to link any text within them)\n     *\n     * We don't need to:\n     *\n     * 1. Create a parse tree\n     * 2. Auto-close tags with invalid markup\n     * 3. etc.\n     *\n     * The other intention behind this is that we didn't want to add external\n     * dependencies on the Autolinker utility which would increase its size. For\n     * instance, adding htmlparser2 adds 125kb to the minified output file,\n     * increasing its final size from 47kb to 172kb (at the time of writing). It\n     * also doesn't work exactly correctly, treating the string \"<3 blah blah blah\"\n     * as an HTML tag.\n     *\n     * Reference for HTML spec:\n     *\n     *     https-colon-slashslash www.w3.org/TR/html51/syntax.html#sec-tokenization\n     *\n     * @param {String} html The HTML to parse\n     * @param {Object} callbacks\n     * @param {Function} callbacks.onOpenTag Callback function to call when an open\n     *   tag is parsed. Called with the tagName as its argument.\n     * @param {Function} callbacks.onCloseTag Callback function to call when a close\n     *   tag is parsed. Called with the tagName as its argument. If a self-closing\n     *   tag is found, `onCloseTag` is called immediately after `onOpenTag`.\n     * @param {Function} callbacks.onText Callback function to call when text (i.e\n     *   not an HTML tag) is parsed. Called with the text (string) as its first\n     *   argument, and offset (number) into the string as its second.\n     */\n    function parseHtml(html, _a) {\n        var onOpenTag = _a.onOpenTag, onCloseTag = _a.onCloseTag, onText = _a.onText, onComment = _a.onComment, onDoctype = _a.onDoctype;\n        var noCurrentTag = new CurrentTag();\n        var charIdx = 0, len = html.length, state = 0 /* Data */, currentDataIdx = 0, // where the current data start index is\n        currentTag = noCurrentTag; // describes the current tag that is being read\n        // For debugging: search for other \"For debugging\" lines\n        // const table = new CliTable( {\n        // \thead: [ 'charIdx', 'char', 'state', 'currentDataIdx', 'currentOpenTagIdx', 'tag.type' ]\n        // } );\n        while (charIdx < len) {\n            var char = html.charAt(charIdx);\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            switch (state) {\n                case 0 /* Data */:\n                    stateData(char);\n                    break;\n                case 1 /* TagOpen */:\n                    stateTagOpen(char);\n                    break;\n                case 2 /* EndTagOpen */:\n                    stateEndTagOpen(char);\n                    break;\n                case 3 /* TagName */:\n                    stateTagName(char);\n                    break;\n                case 4 /* BeforeAttributeName */:\n                    stateBeforeAttributeName(char);\n                    break;\n                case 5 /* AttributeName */:\n                    stateAttributeName(char);\n                    break;\n                case 6 /* AfterAttributeName */:\n                    stateAfterAttributeName(char);\n                    break;\n                case 7 /* BeforeAttributeValue */:\n                    stateBeforeAttributeValue(char);\n                    break;\n                case 8 /* AttributeValueDoubleQuoted */:\n                    stateAttributeValueDoubleQuoted(char);\n                    break;\n                case 9 /* AttributeValueSingleQuoted */:\n                    stateAttributeValueSingleQuoted(char);\n                    break;\n                case 10 /* AttributeValueUnquoted */:\n                    stateAttributeValueUnquoted(char);\n                    break;\n                case 11 /* AfterAttributeValueQuoted */:\n                    stateAfterAttributeValueQuoted(char);\n                    break;\n                case 12 /* SelfClosingStartTag */:\n                    stateSelfClosingStartTag(char);\n                    break;\n                case 13 /* MarkupDeclarationOpenState */:\n                    stateMarkupDeclarationOpen(char);\n                    break;\n                case 14 /* CommentStart */:\n                    stateCommentStart(char);\n                    break;\n                case 15 /* CommentStartDash */:\n                    stateCommentStartDash(char);\n                    break;\n                case 16 /* Comment */:\n                    stateComment(char);\n                    break;\n                case 17 /* CommentEndDash */:\n                    stateCommentEndDash(char);\n                    break;\n                case 18 /* CommentEnd */:\n                    stateCommentEnd(char);\n                    break;\n                case 19 /* CommentEndBang */:\n                    stateCommentEndBang(char);\n                    break;\n                case 20 /* Doctype */:\n                    stateDoctype(char);\n                    break;\n                default:\n                    throwUnhandledCaseError(state);\n            }\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            charIdx++;\n        }\n        if (currentDataIdx < charIdx) {\n            emitText();\n        }\n        // For debugging: search for other \"For debugging\" lines\n        // console.log( '\\n' + table.toString() );\n        // Called when non-tags are being read (i.e. the text around HTML ags)\n        // https://www.w3.org/TR/html51/syntax.html#data-state\n        function stateData(char) {\n            if (char === '<') {\n                startNewTag();\n            }\n        }\n        // Called after a '<' is read from the Data state\n        // https://www.w3.org/TR/html51/syntax.html#tag-open-state\n        function stateTagOpen(char) {\n            if (char === '!') {\n                state = 13 /* MarkupDeclarationOpenState */;\n            }\n            else if (char === '/') {\n                state = 2 /* EndTagOpen */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (letterRe.test(char)) {\n                // tag name start (and no '/' read)\n                state = 3 /* TagName */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isOpening: true }));\n            }\n            else {\n                // Any other\n                state = 0 /* Data */;\n                currentTag = noCurrentTag;\n            }\n        }\n        // After a '<x', '</x' sequence is read (where 'x' is a letter character),\n        // this is to continue reading the tag name\n        // https://www.w3.org/TR/html51/syntax.html#tag-name-state\n        function stateTagName(char) {\n            if (whitespaceRe.test(char)) {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === '/') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (!letterRe.test(char) && !digitRe.test(char) && char !== ':') {\n                // Anything else that does not form an html tag. Note: the colon\n                // character is accepted for XML namespaced tags\n                resetToDataState();\n            }\n        }\n        // Called after the '/' is read from a '</' sequence\n        // https://www.w3.org/TR/html51/syntax.html#end-tag-open-state\n        function stateEndTagOpen(char) {\n            if (char === '>') { // parse error. Encountered \"</>\". Skip it without treating as a tag\n                resetToDataState();\n            }\n            else if (letterRe.test(char)) {\n                state = 3 /* TagName */;\n            }\n            else {\n                // some other non-tag-like character, don't treat this as a tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-name-state\n        function stateBeforeAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === \"=\" || quoteRe.test(char) || controlCharsRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other char, start of a new attribute name\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-name-state\n        function stateAttributeName(char) {\n            if (whitespaceRe.test(char)) {\n                state = 6 /* AfterAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-name-state\n        function stateAfterAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other character, start a new attribute in the current tag\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-value-state\n        function stateBeforeAttributeValue(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === \"\\\"\") {\n                state = 8 /* AttributeValueDoubleQuoted */;\n            }\n            else if (char === \"'\") {\n                state = 9 /* AttributeValueSingleQuoted */;\n            }\n            else if (/[>=`]/.test(char)) {\n                // Invalid chars after an '=' for an attribute value, don't count\n                // the current tag as an HTML tag\n                resetToDataState();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, consider it an unquoted attribute value\n                state = 10 /* AttributeValueUnquoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-double-quoted-state\n        function stateAttributeValueDoubleQuoted(char) {\n            if (char === \"\\\"\") { // end the current double-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-single-quoted-state\n        function stateAttributeValueSingleQuoted(char) {\n            if (char === \"'\") { // end the current single-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-unquoted-state\n        function stateAttributeValueUnquoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-value-quoted-state\n        function stateAfterAttributeValueQuoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, \"parse error\". Spec says to switch to the\n                // BeforeAttributeState and re-consume the character, as it may be\n                // the start of a new attribute name\n                state = 4 /* BeforeAttributeName */;\n                reconsumeCurrentCharacter();\n            }\n        }\n        // A '/' has just been read in the current tag (presumably for '/>'), and\n        // this handles the next character\n        // https://www.w3.org/TR/html51/syntax.html#self-closing-start-tag-state\n        function stateSelfClosingStartTag(char) {\n            if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else {\n                state = 4 /* BeforeAttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#markup-declaration-open-state\n        // (HTML Comments or !DOCTYPE)\n        function stateMarkupDeclarationOpen(char) {\n            if (html.substr(charIdx, 2) === '--') { // html comment\n                charIdx += 2; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'comment' }));\n                state = 14 /* CommentStart */;\n            }\n            else if (html.substr(charIdx, 7).toUpperCase() === 'DOCTYPE') {\n                charIdx += 7; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'doctype' }));\n                state = 20 /* Doctype */;\n            }\n            else {\n                // At this point, the spec specifies that the state machine should\n                // enter the \"bogus comment\" state, in which case any character(s)\n                // after the '<!' that were read should become an HTML comment up\n                // until the first '>' that is read (or EOF). Instead, we'll assume\n                // that a user just typed '<!' as part of text data\n                resetToDataState();\n            }\n        }\n        // Handles after the sequence '<!--' has been read\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-state\n        function stateCommentStart(char) {\n            if (char === '-') {\n                // We've read the sequence '<!---' at this point (3 dashes)\n                state = 15 /* CommentStartDash */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!-->'\n                resetToDataState();\n            }\n            else {\n                // Any other char, take it as part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '<!---' at this point (3 dashes)\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-dash-state\n        function stateCommentStartDash(char) {\n            if (char === '-') {\n                // We've read '<!----' (4 dashes) at this point\n                state = 18 /* CommentEnd */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!--->'\n                resetToDataState();\n            }\n            else {\n                // Anything else, take it as a valid comment\n                state = 16 /* Comment */;\n            }\n        }\n        // Currently reading the comment's text (data)\n        // https://www.w3.org/TR/html51/syntax.html#comment-state\n        function stateComment(char) {\n            if (char === '-') {\n                state = 17 /* CommentEndDash */;\n            }\n        }\n        // When we we've read the first dash inside a comment, it may signal the\n        // end of the comment if we read another dash\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-dash-state\n        function stateCommentEndDash(char) {\n            if (char === '-') {\n                state = 18 /* CommentEnd */;\n            }\n            else {\n                // Wasn't a dash, must still be part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // After we've read two dashes inside a comment, it may signal the end of\n        // the comment if we then read a '>' char\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-state\n        function stateCommentEnd(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '!') {\n                state = 19 /* CommentEndBang */;\n            }\n            else if (char === '-') ;\n            else {\n                // Anything else, switch back to the comment state since we didn't\n                // read the full \"end comment\" sequence (i.e. '-->')\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '--!' inside of a comment\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-bang-state\n        function stateCommentEndBang(char) {\n            if (char === '-') {\n                // We read the sequence '--!-' inside of a comment. The last dash\n                // could signify that the comment is going to close\n                state = 17 /* CommentEndDash */;\n            }\n            else if (char === '>') {\n                // End of comment with the sequence '--!>'\n                emitTagAndPreviousTextNode();\n            }\n            else {\n                // The '--!' was not followed by a '>', continue reading the\n                // comment's text\n                state = 16 /* Comment */;\n            }\n        }\n        /**\n         * For DOCTYPES in particular, we don't care about the attributes. Just\n         * advance to the '>' character and emit the tag, unless we find a '<'\n         * character in which case we'll start a new tag.\n         *\n         * Example doctype tag:\n         *    <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http-colon-slashslash www.w3.org/TR/html4/strict.dtd\">\n         *\n         * Actual spec: https-colon-slashslash www.w3.org/TR/html51/syntax.html#doctype-state\n         */\n        function stateDoctype(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                startNewTag();\n            }\n        }\n        /**\n         * Resets the state back to the Data state, and removes the current tag.\n         *\n         * We'll generally run this function whenever a \"parse error\" is\n         * encountered, where the current tag that is being read no longer looks\n         * like a real HTML tag.\n         */\n        function resetToDataState() {\n            state = 0 /* Data */;\n            currentTag = noCurrentTag;\n        }\n        /**\n         * Starts a new HTML tag at the current index, ignoring any previous HTML\n         * tag that was being read.\n         *\n         * We'll generally run this function whenever we read a new '<' character,\n         * including when we read a '<' character inside of an HTML tag that we were\n         * previously reading.\n         */\n        function startNewTag() {\n            state = 1 /* TagOpen */;\n            currentTag = new CurrentTag({ idx: charIdx });\n        }\n        /**\n         * Once we've decided to emit an open tag, that means we can also emit the\n         * text node before it.\n         */\n        function emitTagAndPreviousTextNode() {\n            var textBeforeTag = html.slice(currentDataIdx, currentTag.idx);\n            if (textBeforeTag) {\n                // the html tag was the first element in the html string, or two\n                // tags next to each other, in which case we should not emit a text\n                // node\n                onText(textBeforeTag, currentDataIdx);\n            }\n            if (currentTag.type === 'comment') {\n                onComment(currentTag.idx);\n            }\n            else if (currentTag.type === 'doctype') {\n                onDoctype(currentTag.idx);\n            }\n            else {\n                if (currentTag.isOpening) {\n                    onOpenTag(currentTag.name, currentTag.idx);\n                }\n                if (currentTag.isClosing) { // note: self-closing tags will emit both opening and closing\n                    onCloseTag(currentTag.name, currentTag.idx);\n                }\n            }\n            // Since we just emitted a tag, reset to the data state for the next char\n            resetToDataState();\n            currentDataIdx = charIdx + 1;\n        }\n        function emitText() {\n            var text = html.slice(currentDataIdx, charIdx);\n            onText(text, currentDataIdx);\n            currentDataIdx = charIdx + 1;\n        }\n        /**\n         * Captures the tag name from the start of the tag to the current character\n         * index, and converts it to lower case\n         */\n        function captureTagName() {\n            var startIdx = currentTag.idx + (currentTag.isClosing ? 2 : 1);\n            return html.slice(startIdx, charIdx).toLowerCase();\n        }\n        /**\n         * Causes the main loop to re-consume the current character, such as after\n         * encountering a \"parse error\" that changed state and needs to reconsume\n         * the same character in that new state.\n         */\n        function reconsumeCurrentCharacter() {\n            charIdx--;\n        }\n    }\n    var CurrentTag = /** @class */ (function () {\n        function CurrentTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.type = cfg.type || 'tag';\n            this.name = cfg.name || '';\n            this.isOpening = !!cfg.isOpening;\n            this.isClosing = !!cfg.isClosing;\n        }\n        return CurrentTag;\n    }());\n\n    /**\n     * @class Autolinker\n     * @extends Object\n     *\n     * Utility class used to process a given string of text, and wrap the matches in\n     * the appropriate anchor (&lt;a&gt;) tags to turn them into links.\n     *\n     * Any of the configuration options may be provided in an Object provided\n     * to the Autolinker constructor, which will configure how the {@link #link link()}\n     * method will process the links.\n     *\n     * For example:\n     *\n     *     var autolinker = new Autolinker( {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *\n     *     var html = autolinker.link( \"Joe went to www.yahoo.com\" );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * The {@link #static-link static link()} method may also be used to inline\n     * options into a single call, which may be more convenient for one-off uses.\n     * For example:\n     *\n     *     var html = Autolinker.link( \"Joe went to www.yahoo.com\", {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * ## Custom Replacements of Links\n     *\n     * If the configuration options do not provide enough flexibility, a {@link #replaceFn}\n     * may be provided to fully customize the output of Autolinker. This function is\n     * called once for each URL/Email/Phone#/Hashtag/Mention (Twitter, Instagram, Soundcloud)\n     * match that is encountered.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, Phone #s, Hashtags, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                     if( match.getUrl().indexOf( 'mysite.com' ) === -1 ) {\n     *                         var tag = match.buildTag();  // returns an `Autolinker.HtmlTag` instance, which provides mutator methods for easy changes\n     *                         tag.setAttr( 'rel', 'nofollow' );\n     *                         tag.addClass( 'external-link' );\n     *\n     *                         return tag;\n     *\n     *                     } else {\n     *                         return true;  // let Autolinker perform its normal anchor tag replacement\n     *                     }\n     *\n     *                 case 'email' :\n     *                     var email = match.getEmail();\n     *                     console.log( \"email: \", email );\n     *\n     *                     if( email === \"my@own.address\" ) {\n     *                         return false;  // don't auto-link this particular email address; leave as-is\n     *                     } else {\n     *                         return;  // no return value will have Autolinker perform its normal anchor tag replacement (same as returning `true`)\n     *                     }\n     *\n     *                 case 'phone' :\n     *                     var phoneNumber = match.getPhoneNumber();\n     *                     console.log( phoneNumber );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.phone.numbers.to/\">' + phoneNumber + '</a>';\n     *\n     *                 case 'hashtag' :\n     *                     var hashtag = match.getHashtag();\n     *                     console.log( hashtag );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.hashtag.handles.to/\">' + hashtag + '</a>';\n     *\n     *                 case 'mention' :\n     *                     var mention = match.getMention();\n     *                     console.log( mention );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.mention.to/\">' + mention + '</a>';\n     *             }\n     *         }\n     *     } );\n     *\n     *\n     * The function may return the following values:\n     *\n     * - `true` (Boolean): Allow Autolinker to replace the match as it normally\n     *   would.\n     * - `false` (Boolean): Do not replace the current match at all - leave as-is.\n     * - Any String: If a string is returned from the function, the string will be\n     *   used directly as the replacement HTML for the match.\n     * - An {@link Autolinker.HtmlTag} instance, which can be used to build/modify\n     *   an HTML tag before writing out its HTML text.\n     */\n    var Autolinker = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the Autolinker instance,\n         *   specified in an Object (map).\n         */\n        function Autolinker(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * The Autolinker version number exposed on the instance itself.\n             *\n             * Ex: 0.25.1\n             */\n            this.version = Autolinker.version;\n            /**\n             * @cfg {Boolean/Object} [urls]\n             *\n             * `true` if URLs should be automatically linked, `false` if they should not\n             * be. Defaults to `true`.\n             *\n             * Examples:\n             *\n             *     urls: true\n             *\n             *     // or\n             *\n             *     urls: {\n             *         schemeMatches : true,\n             *         wwwMatches    : true,\n             *         tldMatches    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 3 properties\n             * to allow for more customization of what exactly gets linked. All default\n             * to `true`:\n             *\n             * @cfg {Boolean} [urls.schemeMatches] `true` to match URLs found prefixed\n             *   with a scheme, i.e. `http-colon-slashslash google.com`, or `other+scheme://google.com`,\n             *   `false` to prevent these types of matches.\n             * @cfg {Boolean} [urls.wwwMatches] `true` to match urls found prefixed with\n             *   `'www.'`, i.e. `www.google.com`. `false` to prevent these types of\n             *   matches. Note that if the URL had a prefixed scheme, and\n             *   `schemeMatches` is true, it will still be linked.\n             * @cfg {Boolean} [urls.tldMatches] `true` to match URLs with known top\n             *   level domains (.com, .net, etc.) that are not prefixed with a scheme or\n             *   `'www.'`. This option attempts to match anything that looks like a URL\n             *   in the given text. Ex: `google.com`, `asdf.org/?page=1`, etc. `false`\n             *   to prevent these types of matches.\n             */\n            this.urls = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [email=true]\n             *\n             * `true` if email addresses should be automatically linked, `false` if they\n             * should not be.\n             */\n            this.email = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [phone=true]\n             *\n             * `true` if Phone numbers (\"(555)555-5555\") should be automatically linked,\n             * `false` if they should not be.\n             */\n            this.phone = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/String} [hashtag=false]\n             *\n             * A string for the service name to have hashtags (ex: \"#myHashtag\")\n             * auto-linked to. The currently-supported values are:\n             *\n             * - 'twitter'\n             * - 'facebook'\n             * - 'instagram'\n             *\n             * Pass `false` to skip auto-linking of hashtags.\n             */\n            this.hashtag = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String/Boolean} [mention=false]\n             *\n             * A string for the service name to have mentions (ex: \"@myuser\")\n             * auto-linked to. The currently supported values are:\n             *\n             * - 'twitter'\n             * - 'instagram'\n             * - 'soundcloud'\n             *\n             * Defaults to `false` to skip auto-linking of mentions.\n             */\n            this.mention = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [newWindow=true]\n             *\n             * `true` if the links should open in a new window, `false` otherwise.\n             */\n            this.newWindow = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/Object} [stripPrefix=true]\n             *\n             * `true` if 'http-colon-slashslash ' (or 'https-colon-slashslash ') and/or the 'www.' should be stripped\n             * from the beginning of URL links' text, `false` otherwise. Defaults to\n             * `true`.\n             *\n             * Examples:\n             *\n             *     stripPrefix: true\n             *\n             *     // or\n             *\n             *     stripPrefix: {\n             *         scheme : true,\n             *         www    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 2 properties\n             * to allow for more customization of what exactly is prevented from being\n             * displayed. Both default to `true`:\n             *\n             * @cfg {Boolean} [stripPrefix.scheme] `true` to prevent the scheme part of\n             *   a URL match from being displayed to the user. Example:\n             *   `'http-colon-slashslash google.com'` will be displayed as `'google.com'`. `false` to\n             *   not strip the scheme. NOTE: Only an `'http-colon-slashslash '` or `'https-colon-slashslash '` scheme\n             *   will be removed, so as not to remove a potentially dangerous scheme\n             *   (such as `'file://'` or `'javascript:'`)\n             * @cfg {Boolean} [stripPrefix.www] www (Boolean): `true` to prevent the\n             *   `'www.'` part of a URL match from being displayed to the user. Ex:\n             *   `'www.google.com'` will be displayed as `'google.com'`. `false` to not\n             *   strip the `'www'`.\n             */\n            this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [stripTrailingSlash=true]\n             *\n             * `true` to remove the trailing slash from URL matches, `false` to keep\n             *  the trailing slash.\n             *\n             *  Example when `true`: `http-colon-slashslash google.com/` will be displayed as\n             *  `http-colon-slashslash google.com`.\n             */\n            this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [decodePercentEncoding=true]\n             *\n             * `true` to decode percent-encoded characters in URL matches, `false` to keep\n             *  the percent-encoded characters.\n             *\n             *  Example when `true`: `https-colon-slashslash en.wikipedia.org/wiki/San_Jos%C3%A9` will\n             *  be displayed as `https-colon-slashslash en.wikipedia.org/wiki/San_Jos`.\n             */\n            this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number/Object} [truncate=0]\n             *\n             * ## Number Form\n             *\n             * A number for how many characters matched text should be truncated to\n             * inside the text of a link. If the matched text is over this number of\n             * characters, it will be truncated to this length by adding a two period\n             * ellipsis ('..') to the end of the string.\n             *\n             * For example: A url like 'http-colon-slashslash www.yahoo.com/some/long/path/to/a/file'\n             * truncated to 25 characters might look something like this:\n             * 'yahoo.com/some/long/pat..'\n             *\n             * Example Usage:\n             *\n             *     truncate: 25\n             *\n             *\n             *  Defaults to `0` for \"no truncation.\"\n             *\n             *\n             * ## Object Form\n             *\n             * An Object may also be provided with two properties: `length` (Number) and\n             * `location` (String). `location` may be one of the following: 'end'\n             * (default), 'middle', or 'smart'.\n             *\n             * Example Usage:\n             *\n             *     truncate: { length: 25, location: 'middle' }\n             *\n             * @cfg {Number} [truncate.length=0] How many characters to allow before\n             *   truncation will occur. Defaults to `0` for \"no truncation.\"\n             * @cfg {\"end\"/\"middle\"/\"smart\"} [truncate.location=\"end\"]\n             *\n             * - 'end' (default): will truncate up to the number of characters, and then\n             *   add an ellipsis at the end. Ex: 'yahoo.com/some/long/pat..'\n             * - 'middle': will truncate and add the ellipsis in the middle. Ex:\n             *   'yahoo.com/s..th/to/a/file'\n             * - 'smart': for URLs where the algorithm attempts to strip out unnecessary\n             *   parts first (such as the 'www.', then URL scheme, hash, etc.),\n             *   attempting to make the URL human-readable before looking for a good\n             *   point to insert the ellipsis if it is still too long. Ex:\n             *   'yahoo.com/some..to/a/file'. For more details, see\n             *   {@link Autolinker.truncate.TruncateSmart}.\n             */\n            this.truncate = { length: 0, location: 'end' }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             *\n             * A CSS class name to add to the generated links. This class will be added\n             * to all links, as well as this class plus match suffixes for styling\n             * url/email/phone/hashtag/mention links differently.\n             *\n             * For example, if this config is provided as \"myLink\", then:\n             *\n             * - URL links will have the CSS classes: \"myLink myLink-url\"\n             * - Email links will have the CSS classes: \"myLink myLink-email\", and\n             * - Phone links will have the CSS classes: \"myLink myLink-phone\"\n             * - Hashtag links will have the CSS classes: \"myLink myLink-hashtag\"\n             * - Mention links will have the CSS classes: \"myLink myLink-mention myLink-[type]\"\n             *   where [type] is either \"instagram\", \"twitter\" or \"soundcloud\"\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Function} replaceFn\n             *\n             * A function to individually process each match found in the input string.\n             *\n             * See the class's description for usage.\n             *\n             * The `replaceFn` can be called with a different context object (`this`\n             * reference) using the {@link #context} cfg.\n             *\n             * This function is called with the following parameter:\n             *\n             * @cfg {Autolinker.match.Match} replaceFn.match The Match instance which\n             *   can be used to retrieve information about the match that the `replaceFn`\n             *   is currently processing. See {@link Autolinker.match.Match} subclasses\n             *   for details.\n             */\n            this.replaceFn = null; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} context\n             *\n             * The context object (`this` reference) to call the `replaceFn` with.\n             *\n             * Defaults to this Autolinker instance.\n             */\n            this.context = undefined; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {Autolinker.matcher.Matcher[]} matchers\n             *\n             * The {@link Autolinker.matcher.Matcher} instances for this Autolinker\n             * instance.\n             *\n             * This is lazily created in {@link #getMatchers}.\n             */\n            this.matchers = null;\n            /**\n             * @private\n             * @property {Autolinker.AnchorTagBuilder} tagBuilder\n             *\n             * The AnchorTagBuilder instance used to build match replacement anchor tags.\n             * Note: this is lazily instantiated in the {@link #getTagBuilder} method.\n             */\n            this.tagBuilder = null;\n            // Note: when `this.something` is used in the rhs of these assignments,\n            //       it refers to the default values set above the constructor\n            this.urls = this.normalizeUrlsCfg(cfg.urls);\n            this.email = typeof cfg.email === 'boolean' ? cfg.email : this.email;\n            this.phone = typeof cfg.phone === 'boolean' ? cfg.phone : this.phone;\n            this.hashtag = cfg.hashtag || this.hashtag;\n            this.mention = cfg.mention || this.mention;\n            this.newWindow = typeof cfg.newWindow === 'boolean' ? cfg.newWindow : this.newWindow;\n            this.stripPrefix = this.normalizeStripPrefixCfg(cfg.stripPrefix);\n            this.stripTrailingSlash = typeof cfg.stripTrailingSlash === 'boolean' ? cfg.stripTrailingSlash : this.stripTrailingSlash;\n            this.decodePercentEncoding = typeof cfg.decodePercentEncoding === 'boolean' ? cfg.decodePercentEncoding : this.decodePercentEncoding;\n            // Validate the value of the `mention` cfg\n            var mention = this.mention;\n            if (mention !== false && mention !== 'twitter' && mention !== 'instagram' && mention !== 'soundcloud') {\n                throw new Error(\"invalid `mention` cfg - see docs\");\n            }\n            // Validate the value of the `hashtag` cfg\n            var hashtag = this.hashtag;\n            if (hashtag !== false && hashtag !== 'twitter' && hashtag !== 'facebook' && hashtag !== 'instagram') {\n                throw new Error(\"invalid `hashtag` cfg - see docs\");\n            }\n            this.truncate = this.normalizeTruncateCfg(cfg.truncate);\n            this.className = cfg.className || this.className;\n            this.replaceFn = cfg.replaceFn || this.replaceFn;\n            this.context = cfg.context || this;\n        }\n        /**\n         * Automatically links URLs, Email addresses, Phone Numbers, Twitter handles,\n         * Hashtags, and Mentions found in the given chunk of HTML. Does not link URLs\n         * found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * Example:\n         *\n         *     var linkedText = Autolinker.link( \"Go to google.com\", { newWindow: false } );\n         *     // Produces: \"Go to <a href=\"http-colon-slashslash google.com\">google.com</a>\"\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within (depending\n         *   on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #mention},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {String} The HTML text, with matches automatically linked.\n         */\n        Autolinker.link = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.link(textOrHtml);\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * Note that if parsing multiple pieces of text, it is slightly more efficient\n         * to create an Autolinker instance, and use the instance-level {@link #parse}\n         * method.\n         *\n         * Example:\n         *\n         *     var matches = Autolinker.parse( \"Hello google.com, I am asdf@asdf.com\", {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.parse = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.parse(textOrHtml);\n        };\n        /**\n         * Normalizes the {@link #urls} config into an Object with 3 properties:\n         * `schemeMatches`, `wwwMatches`, and `tldMatches`, all Booleans.\n         *\n         * See {@link #urls} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} urls\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeUrlsCfg = function (urls) {\n            if (urls == null)\n                urls = true; // default to `true`\n            if (typeof urls === 'boolean') {\n                return { schemeMatches: urls, wwwMatches: urls, tldMatches: urls };\n            }\n            else { // object form\n                return {\n                    schemeMatches: typeof urls.schemeMatches === 'boolean' ? urls.schemeMatches : true,\n                    wwwMatches: typeof urls.wwwMatches === 'boolean' ? urls.wwwMatches : true,\n                    tldMatches: typeof urls.tldMatches === 'boolean' ? urls.tldMatches : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #stripPrefix} config into an Object with 2\n         * properties: `scheme`, and `www` - both Booleans.\n         *\n         * See {@link #stripPrefix} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} stripPrefix\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeStripPrefixCfg = function (stripPrefix) {\n            if (stripPrefix == null)\n                stripPrefix = true; // default to `true`\n            if (typeof stripPrefix === 'boolean') {\n                return { scheme: stripPrefix, www: stripPrefix };\n            }\n            else { // object form\n                return {\n                    scheme: typeof stripPrefix.scheme === 'boolean' ? stripPrefix.scheme : true,\n                    www: typeof stripPrefix.www === 'boolean' ? stripPrefix.www : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #truncate} config into an Object with 2 properties:\n         * `length` (Number), and `location` (String).\n         *\n         * See {@link #truncate} config for details.\n         *\n         * @private\n         * @param {Number/Object} truncate\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeTruncateCfg = function (truncate) {\n            if (typeof truncate === 'number') {\n                return { length: truncate, location: 'end' };\n            }\n            else { // object, or undefined/null\n                return defaults(truncate || {}, {\n                    length: Number.POSITIVE_INFINITY,\n                    location: 'end'\n                });\n            }\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * This method is used by the {@link #link} method, but can also be used to\n         * simply do parsing of the input in order to discover what kinds of links\n         * there are and how many.\n         *\n         * Example usage:\n         *\n         *     var autolinker = new Autolinker( {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     var matches = autolinker.parse( \"Hello google.com, I am asdf@asdf.com\" );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.prototype.parse = function (textOrHtml) {\n            var _this = this;\n            var skipTagNames = ['a', 'style', 'script'], skipTagsStackCount = 0, // used to only Autolink text outside of anchor/script/style tags. We don't want to autolink something that is already linked inside of an <a> tag, for instance\n            matches = [];\n            // Find all matches within the `textOrHtml` (but not matches that are\n            // already nested within <a>, <style> and <script> tags)\n            parseHtml(textOrHtml, {\n                onOpenTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount++;\n                    }\n                },\n                onText: function (text, offset) {\n                    // Only process text nodes that are not within an <a>, <style> or <script> tag\n                    if (skipTagsStackCount === 0) {\n                        // \"Walk around\" common HTML entities. An '&nbsp;' (for example)\n                        // could be at the end of a URL, but we don't want to\n                        // include the trailing '&' in the URL. See issue #76\n                        // TODO: Handle HTML entities separately in parseHtml() and\n                        // don't emit them as \"text\" except for &amp; entities\n                        var htmlCharacterEntitiesRegex = /(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi;\n                        var textSplit = splitAndCapture(text, htmlCharacterEntitiesRegex);\n                        var currentOffset_1 = offset;\n                        textSplit.forEach(function (splitText, i) {\n                            // even number matches are text, odd numbers are html entities\n                            if (i % 2 === 0) {\n                                var textNodeMatches = _this.parseText(splitText, currentOffset_1);\n                                matches.push.apply(matches, textNodeMatches);\n                            }\n                            currentOffset_1 += splitText.length;\n                        });\n                    }\n                },\n                onCloseTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount = Math.max(skipTagsStackCount - 1, 0); // attempt to handle extraneous </a> tags by making sure the stack count never goes below 0\n                    }\n                },\n                onComment: function (offset) { },\n                onDoctype: function (offset) { },\n            });\n            // After we have found all matches, remove subsequent matches that\n            // overlap with a previous match. This can happen for instance with URLs,\n            // where the url 'google.com/#link' would match '#link' as a hashtag.\n            matches = this.compactMatches(matches);\n            // And finally, remove matches for match types that have been turned\n            // off. We needed to have all match types turned on initially so that\n            // things like hashtags could be filtered out if they were really just\n            // part of a URL match (for instance, as a named anchor).\n            matches = this.removeUnwantedMatches(matches);\n            return matches;\n        };\n        /**\n         * After we have found all matches, we need to remove matches that overlap\n         * with a previous match. This can happen for instance with URLs, where the\n         * url 'google.com/#link' would match '#link' as a hashtag. Because the\n         * '#link' part is contained in a larger match that comes before the HashTag\n         * match, we'll remove the HashTag match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches\n         * @return {Autolinker.match.Match[]}\n         */\n        Autolinker.prototype.compactMatches = function (matches) {\n            // First, the matches need to be sorted in order of offset\n            matches.sort(function (a, b) { return a.getOffset() - b.getOffset(); });\n            for (var i = 0; i < matches.length - 1; i++) {\n                var match = matches[i], offset = match.getOffset(), matchedTextLength = match.getMatchedText().length, endIdx = offset + matchedTextLength;\n                if (i + 1 < matches.length) {\n                    // Remove subsequent matches that equal offset with current match\n                    if (matches[i + 1].getOffset() === offset) {\n                        var removeIdx = matches[i + 1].getMatchedText().length > matchedTextLength ? i : i + 1;\n                        matches.splice(removeIdx, 1);\n                        continue;\n                    }\n                    // Remove subsequent matches that overlap with the current match\n                    if (matches[i + 1].getOffset() < endIdx) {\n                        matches.splice(i + 1, 1);\n                    }\n                }\n            }\n            return matches;\n        };\n        /**\n         * Removes matches for matchers that were turned off in the options. For\n         * example, if {@link #hashtag hashtags} were not to be matched, we'll\n         * remove them from the `matches` array here.\n         *\n         * Note: we *must* use all Matchers on the input string, and then filter\n         * them out later. For example, if the options were `{ url: false, hashtag: true }`,\n         * we wouldn't want to match the text '#link' as a HashTag inside of the text\n         * 'google.com/#link'. The way the algorithm works is that we match the full\n         * URL first (which prevents the accidental HashTag match), and then we'll\n         * simply throw away the URL match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches The array of matches to remove\n         *   the unwanted matches from. Note: this array is mutated for the\n         *   removals.\n         * @return {Autolinker.match.Match[]} The mutated input `matches` array.\n         */\n        Autolinker.prototype.removeUnwantedMatches = function (matches) {\n            if (!this.hashtag)\n                remove(matches, function (match) { return match.getType() === 'hashtag'; });\n            if (!this.email)\n                remove(matches, function (match) { return match.getType() === 'email'; });\n            if (!this.phone)\n                remove(matches, function (match) { return match.getType() === 'phone'; });\n            if (!this.mention)\n                remove(matches, function (match) { return match.getType() === 'mention'; });\n            if (!this.urls.schemeMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'scheme'; });\n            }\n            if (!this.urls.wwwMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'www'; });\n            }\n            if (!this.urls.tldMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'tld'; });\n            }\n            return matches;\n        };\n        /**\n         * Parses the input `text` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches.\n         *\n         * This method processes a **non-HTML string**, and is used to parse and\n         * match within the text nodes of an HTML string. This method is used\n         * internally by {@link #parse}.\n         *\n         * @private\n         * @param {String} text The text to find matches within (depending on if the\n         *   {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled). This must be a non-HTML string.\n         * @param {Number} [offset=0] The offset of the text node within the\n         *   original string. This is used when parsing with the {@link #parse}\n         *   method to generate correct offsets within the {@link Autolinker.match.Match}\n         *   instances, but may be omitted if calling this method publicly.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `text`.\n         */\n        Autolinker.prototype.parseText = function (text, offset) {\n            if (offset === void 0) { offset = 0; }\n            offset = offset || 0;\n            var matchers = this.getMatchers(), matches = [];\n            for (var i = 0, numMatchers = matchers.length; i < numMatchers; i++) {\n                var textMatches = matchers[i].parseMatches(text);\n                // Correct the offset of each of the matches. They are originally\n                // the offset of the match within the provided text node, but we\n                // need to correct them to be relative to the original HTML input\n                // string (i.e. the one provided to #parse).\n                for (var j = 0, numTextMatches = textMatches.length; j < numTextMatches; j++) {\n                    textMatches[j].setOffset(offset + textMatches[j].getOffset());\n                }\n                matches.push.apply(matches, textMatches);\n            }\n            return matches;\n        };\n        /**\n         * Automatically links URLs, Email addresses, Phone numbers, Hashtags,\n         * and Mentions (Twitter, Instagram, Soundcloud) found in the given chunk of HTML. Does not link\n         * URLs found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to\n         * &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * This method finds the text around any HTML elements in the input\n         * `textOrHtml`, which will be the text that is processed. Any original HTML\n         * elements will be left as-is, as well as the text that is already wrapped\n         * in anchor (&lt;a&gt;) tags.\n         *\n         * @param {String} textOrHtml The HTML or text to autolink matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {String} The HTML, with matches automatically linked.\n         */\n        Autolinker.prototype.link = function (textOrHtml) {\n            if (!textOrHtml) {\n                return \"\";\n            } // handle `null` and `undefined`\n            var matches = this.parse(textOrHtml), newHtml = [], lastIndex = 0;\n            for (var i = 0, len = matches.length; i < len; i++) {\n                var match = matches[i];\n                newHtml.push(textOrHtml.substring(lastIndex, match.getOffset()));\n                newHtml.push(this.createMatchReturnVal(match));\n                lastIndex = match.getOffset() + match.getMatchedText().length;\n            }\n            newHtml.push(textOrHtml.substring(lastIndex)); // handle the text after the last match\n            return newHtml.join('');\n        };\n        /**\n         * Creates the return string value for a given match in the input string.\n         *\n         * This method handles the {@link #replaceFn}, if one was provided.\n         *\n         * @private\n         * @param {Autolinker.match.Match} match The Match object that represents\n         *   the match.\n         * @return {String} The string that the `match` should be replaced with.\n         *   This is usually the anchor tag string, but may be the `matchStr` itself\n         *   if the match is not to be replaced.\n         */\n        Autolinker.prototype.createMatchReturnVal = function (match) {\n            // Handle a custom `replaceFn` being provided\n            var replaceFnResult;\n            if (this.replaceFn) {\n                replaceFnResult = this.replaceFn.call(this.context, match); // Autolinker instance is the context\n            }\n            if (typeof replaceFnResult === 'string') {\n                return replaceFnResult; // `replaceFn` returned a string, use that\n            }\n            else if (replaceFnResult === false) {\n                return match.getMatchedText(); // no replacement for the match\n            }\n            else if (replaceFnResult instanceof HtmlTag) {\n                return replaceFnResult.toAnchorString();\n            }\n            else { // replaceFnResult === true, or no/unknown return value from function\n                // Perform Autolinker's default anchor tag generation\n                var anchorTag = match.buildTag(); // returns an Autolinker.HtmlTag instance\n                return anchorTag.toAnchorString();\n            }\n        };\n        /**\n         * Lazily instantiates and returns the {@link Autolinker.matcher.Matcher}\n         * instances for this Autolinker instance.\n         *\n         * @private\n         * @return {Autolinker.matcher.Matcher[]}\n         */\n        Autolinker.prototype.getMatchers = function () {\n            if (!this.matchers) {\n                var tagBuilder = this.getTagBuilder();\n                var matchers = [\n                    new HashtagMatcher({ tagBuilder: tagBuilder, serviceName: this.hashtag }),\n                    new EmailMatcher({ tagBuilder: tagBuilder }),\n                    new PhoneMatcher({ tagBuilder: tagBuilder }),\n                    new MentionMatcher({ tagBuilder: tagBuilder, serviceName: this.mention }),\n                    new UrlMatcher({ tagBuilder: tagBuilder, stripPrefix: this.stripPrefix, stripTrailingSlash: this.stripTrailingSlash, decodePercentEncoding: this.decodePercentEncoding })\n                ];\n                return (this.matchers = matchers);\n            }\n            else {\n                return this.matchers;\n            }\n        };\n        /**\n         * Returns the {@link #tagBuilder} instance for this Autolinker instance,\n         * lazily instantiating it if it does not yet exist.\n         *\n         * @private\n         * @return {Autolinker.AnchorTagBuilder}\n         */\n        Autolinker.prototype.getTagBuilder = function () {\n            var tagBuilder = this.tagBuilder;\n            if (!tagBuilder) {\n                tagBuilder = this.tagBuilder = new AnchorTagBuilder({\n                    newWindow: this.newWindow,\n                    truncate: this.truncate,\n                    className: this.className\n                });\n            }\n            return tagBuilder;\n        };\n        /**\n         * @static\n         * @property {String} version\n         *\n         * The Autolinker version number in the form major.minor.patch\n         *\n         * Ex: 0.25.1\n         */\n        Autolinker.version = '3.11.0';\n        /**\n         * For backwards compatibility with Autolinker 1.x, the AnchorTagBuilder\n         * class is provided as a static on the Autolinker class.\n         */\n        Autolinker.AnchorTagBuilder = AnchorTagBuilder;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the HtmlTag class is\n         * provided as a static on the Autolinker class.\n         */\n        Autolinker.HtmlTag = HtmlTag;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Matcher classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.matcher = {\n            Email: EmailMatcher,\n            Hashtag: HashtagMatcher,\n            Matcher: Matcher,\n            Mention: MentionMatcher,\n            Phone: PhoneMatcher,\n            Url: UrlMatcher\n        };\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Match classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.match = {\n            Email: EmailMatch,\n            Hashtag: HashtagMatch,\n            Match: Match,\n            Mention: MentionMatch,\n            Phone: PhoneMatch,\n            Url: UrlMatch\n        };\n        return Autolinker;\n    }());\n\n    return Autolinker;\n\n}));\n\n\n//# sourceMappingURL=Autolinker.js.map\n\nexport default tmp.Autolinker;\n","    /**\n     * Representation of <Camera> from KML\n     * @alias KmlCamera\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRoll} headingPitchRoll camera orientation\n     */\n    function KmlCamera(position, headingPitchRoll) {\n        this.position = position;\n        this.headingPitchRoll = headingPitchRoll;\n    }\nexport default KmlCamera;\n","    /**\n     * @alias KmlLookAt\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRange} headingPitchRange camera orientation\n     */\n    function KmlLookAt(position, headingPitchRange) {\n        this.position = position;\n        this.headingPitchRange = headingPitchRange;\n    }\nexport default KmlLookAt;\n","import defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\n    /**\n     * @alias KmlTour\n     * @constructor\n     *\n     * @param {String} name name parsed from KML\n     * @param {String} id id parsed from KML\n     * @param {Array} playlist array with KMLTourFlyTos, KMLTourWaits and KMLTourSoundCues\n     */\n    function KmlTour(name, id) {\n        /**\n         * Id of kml gx:Tour entry\n         * @type String\n         */\n        this.id = id;\n        /**\n         * Tour name\n         * @type String\n         */\n        this.name = name;\n        /**\n         * Index of current entry from playlist\n         * @type Number\n         */\n        this.playlistIndex = 0;\n        /**\n         * Array of playlist entries\n         * @type Array\n         */\n        this.playlist = [];\n        /**\n         * Event will be called when tour starts to play,\n         * before any playlist entry starts to play.\n         * @type Event\n         */\n        this.tourStart = new Event();\n        /**\n         * Event will be called when all playlist entries are\n         * played, or tour playback being canceled.\n         *\n         * If tour playback was terminated, event callback will\n         * be called with terminated=true parameter.\n         * @type Event\n         */\n        this.tourEnd = new Event();\n        /**\n         * Event will be called when entry from playlist starts to play.\n         *\n         * Event callback will be called with curent entry as first parameter.\n         * @type Event\n         */\n        this.entryStart = new Event();\n        /**\n         * Event will be called when entry from playlist ends to play.\n         *\n         * Event callback will be called with following parameters:\n         * 1. entry - entry\n         * 2. terminated - true if playback was terminated by calling {@link KmlTour#stop}\n         * @type Event\n         */\n        this.entryEnd = new Event();\n\n        this._activeEntries = [];\n    }\n\n    /**\n     * Add entry to this tour playlist.\n     *\n     * @param {KmlTourFlyTo|KmlTourWait} entry an entry to add to the playlist.\n     */\n    KmlTour.prototype.addPlaylistEntry = function(entry) {\n        this.playlist.push(entry);\n    };\n\n    /**\n     * Play this tour.\n     *\n     * @param {Viewer} viewer viewer widget.\n     * @param {Object} [cameraOptions] these options will be merged with {@link Camera#flyTo}\n     * options for FlyTo playlist entries.\n     */\n    KmlTour.prototype.play = function(viewer, cameraOptions) {\n        this.tourStart.raiseEvent();\n\n        var tour = this;\n        playEntry.call(this, viewer, cameraOptions, function(terminated) {\n            tour.playlistIndex = 0;\n            // Stop nonblocking entries\n            if (!terminated) {\n                cancelAllEntries(tour._activeEntries);\n            }\n            tour.tourEnd.raiseEvent(terminated);\n        });\n    };\n\n    /**\n     * Stop curently playing tour.\n     */\n    KmlTour.prototype.stop = function() {\n        cancelAllEntries(this._activeEntries);\n    };\n\n    // Stop all activeEntries.\n    function cancelAllEntries(activeEntries) {\n        for(var entry = activeEntries.pop(); entry !== undefined; entry = activeEntries.pop()) {\n            entry.stop();\n        }\n    }\n\n    // Play playlist entry.\n    // This function is called recursevly with playNext and iterates over all entries from playlist.\n    function playEntry(viewer, cameraOptions, allDone) {\n        var entry = this.playlist[this.playlistIndex];\n        if (entry) {\n            var _playNext = playNext.bind(this, viewer, cameraOptions, allDone);\n            this._activeEntries.push(entry);\n            this.entryStart.raiseEvent(entry);\n            if (entry.blocking) {\n                entry.play(_playNext, viewer.scene.camera, cameraOptions);\n            }\n            else {\n                var tour = this;\n                entry.play(function() {\n                    tour.entryEnd.raiseEvent(entry);\n                    var indx = tour._activeEntries.indexOf(entry);\n                    if (indx >= 0) {\n                        tour._activeEntries.splice(indx, 1);\n                    }\n                });\n                _playNext(viewer, cameraOptions, allDone);\n            }\n        }\n        else if(defined(allDone)) {\n            allDone(false);\n        }\n    }\n\n    // Increment playlistIndex and call playEntry if terminated isn't true.\n    function playNext(viewer, cameraOptions, allDone, terminated) {\n        var entry = this.playlist[this.playlistIndex];\n        this.entryEnd.raiseEvent(entry, terminated);\n\n        if (terminated) {\n            allDone(terminated);\n        }\n        else {\n            var indx = this._activeEntries.indexOf(entry);\n            if (indx >= 0) {\n                this._activeEntries.splice(indx, 1);\n            }\n            this.playlistIndex++;\n            playEntry.call(this, viewer, cameraOptions, allDone);\n        }\n    }\nexport default KmlTour;\n","import BoundingSphere from '../Core/BoundingSphere.js';\nimport combine from '../Core/combine.js';\nimport defined from '../Core/defined.js';\nimport EasingFunction from '../Core/EasingFunction.js';\n    /**\n     * @alias KmlTourFlyTo\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     * @param {String} flyToMode KML fly to mode: bounce, smooth, etc\n     * @param {KmlCamera|KmlLookAt} view KmlCamera or KmlLookAt\n     */\n    function KmlTourFlyTo(duration, flyToMode, view) {\n        this.type = 'KmlTourFlyTo';\n        this.blocking = true;\n        this.activeCamera = null;\n        this.activeCallback = null;\n\n        this.duration = duration;\n        this.view = view;\n        this.flyToMode = flyToMode;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourFlyTo~DoneCallback} done function which will be called when playback ends\n     * @param {Camera} camera Cesium camera\n     * @param {Object} [cameraOptions] which will be merged with camera flyTo options. See {@link Camera#flyTo}\n     */\n    KmlTourFlyTo.prototype.play = function(done, camera, cameraOptions) {\n        this.activeCamera = camera;\n        if (defined(done) && done !== null) {\n            var self = this;\n            this.activeCallback = function(terminated) {\n                delete self.activeCallback;\n                delete self.activeCamera;\n                done(defined(terminated) ? false : terminated);\n            };\n        }\n\n        var options = this.getCameraOptions(cameraOptions);\n        if (this.view.headingPitchRoll) {\n            camera.flyTo(options);\n        }\n        else if (this.view.headingPitchRange) {\n            var target = new BoundingSphere(this.view.position);\n            camera.flyToBoundingSphere(target, options);\n        }\n    };\n\n    /**\n     * Stop execution of curent entry. Cancel camera flyTo\n     */\n    KmlTourFlyTo.prototype.stop = function() {\n        if (defined(this.activeCamera)) {\n            this.activeCamera.cancelFlight();\n        }\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * Returns options for {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere}\n     * depends on this.view type.\n     *\n     * @param {Object} cameraOptions options to merge with generated. See {@link Camera#flyTo}\n     * @returns {Object} {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere} options\n     */\n    KmlTourFlyTo.prototype.getCameraOptions = function(cameraOptions) {\n        var options = {\n            duration: this.duration\n        };\n\n        if (defined(this.activeCallback)) {\n            options.complete = this.activeCallback;\n        }\n\n        if (this.flyToMode === 'smooth' ) {\n            options.easingFunction = EasingFunction.LINEAR_NONE;\n        }\n\n        if (this.view.headingPitchRoll) {\n            options.destination = this.view.position;\n            options.orientation = this.view.headingPitchRoll;\n        }\n        else if (this.view.headingPitchRange) {\n            options.offset = this.view.headingPitchRange;\n        }\n\n        if (defined(cameraOptions)) {\n            options = combine(options, cameraOptions);\n        }\n        return options;\n    };\n\n    /**\n     * A function that will be executed when the flight completes.\n     * @callback KmlTourFlyTo~DoneCallback\n     *\n     * @param {Boolean} terminated true if {@link KmlTourFlyTo#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourFlyTo;\n","import defined from '../Core/defined.js';\n    /**\n     * @alias KmlTourWait\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     */\n    function KmlTourWait(duration) {\n        this.type = 'KmlTourWait';\n        this.blocking = true;\n        this.duration = duration;\n\n        this.timeout = null;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourWait~DoneCallback} done function which will be called when playback ends\n     */\n    KmlTourWait.prototype.play = function(done) {\n        var self = this;\n        this.activeCallback = done;\n        this.timeout = setTimeout(function() {\n            delete self.activeCallback;\n            done(false);\n        }, this.duration * 1000);\n    };\n\n    /**\n     * Stop execution of curent entry, cancel curent timeout\n     */\n    KmlTourWait.prototype.stop = function() {\n        clearTimeout(this.timeout);\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * A function which will be called when playback ends.\n     *\n     * @callback KmlTourWait~DoneCallback\n     * @param {Boolean} terminated true if {@link KmlTourWait#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourWait;\n","import ArcType from '../Core/ArcType.js';\nimport AssociativeArray from '../Core/AssociativeArray.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport clone from '../Core/clone.js';\nimport Color from '../Core/Color.js';\nimport createGuid from '../Core/createGuid.js';\nimport Credit from '../Core/Credit.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport getExtensionFromUri from '../Core/getExtensionFromUri.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport getTimestamp from '../Core/getTimestamp.js';\nimport HeadingPitchRange from '../Core/HeadingPitchRange.js';\nimport HeadingPitchRoll from '../Core/HeadingPitchRoll.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport objectToQuery from '../Core/objectToQuery.js';\nimport oneTimeWarning from '../Core/oneTimeWarning.js';\nimport PinBuilder from '../Core/PinBuilder.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport queryToObject from '../Core/queryToObject.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport SceneMode from '../Scene/SceneMode.js';\nimport Autolinker from '../ThirdParty/Autolinker.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport zip from '../ThirdParty/zip.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport Entity from './Entity.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport KmlCamera from './KmlCamera.js';\nimport KmlLookAt from './KmlLookAt.js';\nimport KmlTour from './KmlTour.js';\nimport KmlTourFlyTo from './KmlTourFlyTo.js';\nimport KmlTourWait from './KmlTourWait.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport PathGraphics from './PathGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport ScaledPositionProperty from './ScaledPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport WallGraphics from './WallGraphics.js';\n\n    //This is by no means an exhaustive list of MIME types.\n    //The purpose of this list is to be able to accurately identify content embedded\n    //in KMZ files. Eventually, we can make this configurable by the end user so they can add\n    //there own content types if they have KMZ files that require it.\n    var MimeTypes = {\n        avi : 'video/x-msvideo',\n        bmp : 'image/bmp',\n        bz2 : 'application/x-bzip2',\n        chm : 'application/vnd.ms-htmlhelp',\n        css : 'text/css',\n        csv : 'text/csv',\n        doc : 'application/msword',\n        dvi : 'application/x-dvi',\n        eps : 'application/postscript',\n        flv : 'video/x-flv',\n        gif : 'image/gif',\n        gz : 'application/x-gzip',\n        htm : 'text/html',\n        html : 'text/html',\n        ico : 'image/vnd.microsoft.icon',\n        jnlp : 'application/x-java-jnlp-file',\n        jpeg : 'image/jpeg',\n        jpg : 'image/jpeg',\n        m3u : 'audio/x-mpegurl',\n        m4v : 'video/mp4',\n        mathml : 'application/mathml+xml',\n        mid : 'audio/midi',\n        midi : 'audio/midi',\n        mov : 'video/quicktime',\n        mp3 : 'audio/mpeg',\n        mp4 : 'video/mp4',\n        mp4v : 'video/mp4',\n        mpeg : 'video/mpeg',\n        mpg : 'video/mpeg',\n        odp : 'application/vnd.oasis.opendocument.presentation',\n        ods : 'application/vnd.oasis.opendocument.spreadsheet',\n        odt : 'application/vnd.oasis.opendocument.text',\n        ogg : 'application/ogg',\n        pdf : 'application/pdf',\n        png : 'image/png',\n        pps : 'application/vnd.ms-powerpoint',\n        ppt : 'application/vnd.ms-powerpoint',\n        ps : 'application/postscript',\n        qt : 'video/quicktime',\n        rdf : 'application/rdf+xml',\n        rss : 'application/rss+xml',\n        rtf : 'application/rtf',\n        svg : 'image/svg+xml',\n        swf : 'application/x-shockwave-flash',\n        text : 'text/plain',\n        tif : 'image/tiff',\n        tiff : 'image/tiff',\n        txt : 'text/plain',\n        wav : 'audio/x-wav',\n        wma : 'audio/x-ms-wma',\n        wmv : 'video/x-ms-wmv',\n        xml : 'application/xml',\n        zip : 'application/zip',\n\n        detectFromFilename : function(filename) {\n            var ext = filename.toLowerCase();\n            ext = getExtensionFromUri(ext);\n            return MimeTypes[ext];\n        }\n    };\n\n    var parser;\n    if (typeof DOMParser !== 'undefined') {\n        parser = new DOMParser();\n    }\n\n    var autolinker = new Autolinker({\n        stripPrefix : false,\n        email : false,\n        replaceFn : function(match) {\n            if (!match.protocolUrlMatch) {\n                //Prevent matching of non-explicit urls.\n                //i.e. foo.id won't match but http://foo.id will\n                return false;\n            }\n        }\n    });\n\n    var BILLBOARD_SIZE = 32;\n\n    var BILLBOARD_NEAR_DISTANCE = 2414016;\n    var BILLBOARD_NEAR_RATIO = 1.0;\n    var BILLBOARD_FAR_DISTANCE = 1.6093e+7;\n    var BILLBOARD_FAR_RATIO = 0.1;\n\n    var kmlNamespaces = [null, undefined, 'http://www.opengis.net/kml/2.2', 'http://earth.google.com/kml/2.2', 'http://earth.google.com/kml/2.1', 'http://earth.google.com/kml/2.0'];\n    var gxNamespaces = ['http://www.google.com/kml/ext/2.2'];\n    var atomNamespaces = ['http://www.w3.org/2005/Atom'];\n    var namespaces = {\n        kml : kmlNamespaces,\n        gx : gxNamespaces,\n        atom : atomNamespaces,\n        kmlgx : kmlNamespaces.concat(gxNamespaces)\n    };\n\n    // Ensure Specs/Data/KML/unsupported.kml is kept up to date with these supported types\n    var featureTypes = {\n        Document : processDocument,\n        Folder : processFolder,\n        Placemark : processPlacemark,\n        NetworkLink : processNetworkLink,\n        GroundOverlay : processGroundOverlay,\n        PhotoOverlay : processUnsupportedFeature,\n        ScreenOverlay : processUnsupportedFeature,\n        Tour : processTour\n    };\n\n    function DeferredLoading(dataSource) {\n        this._dataSource = dataSource;\n        this._deferred = when.defer();\n        this._stack = [];\n        this._promises = [];\n        this._timeoutSet = false;\n        this._used = false;\n\n        this._started = 0;\n        this._timeThreshold = 1000; // Initial load is 1 second\n    }\n\n    Object.defineProperties(DeferredLoading.prototype, {\n        dataSource : {\n            get : function() {\n                return this._dataSource;\n            }\n        }\n    });\n\n    DeferredLoading.prototype.addNodes = function(nodes, processingData) {\n        this._stack.push({\n            nodes: nodes,\n            index: 0,\n            processingData: processingData\n        });\n        this._used = true;\n    };\n\n    DeferredLoading.prototype.addPromise = function(promise) {\n        this._promises.push(promise);\n    };\n\n    DeferredLoading.prototype.wait = function() {\n        // Case where we had a non-document/folder as the root\n        var deferred = this._deferred;\n        if (!this._used) {\n            deferred.resolve();\n        }\n\n        return when.join(deferred.promise, when.all(this._promises));\n    };\n\n    DeferredLoading.prototype.process = function() {\n        var isFirstCall = (this._stack.length === 1);\n        if (isFirstCall) {\n            this._started = KmlDataSource._getTimestamp();\n        }\n\n        return this._process(isFirstCall);\n    };\n\n    DeferredLoading.prototype._giveUpTime = function() {\n        if (this._timeoutSet) {\n            // Timeout was already set so just return\n            return;\n        }\n\n        this._timeoutSet = true;\n        this._timeThreshold = 50; // After the first load lower threshold to 0.5 seconds\n        var that = this;\n        setTimeout(function() {\n            that._timeoutSet = false;\n            that._started = KmlDataSource._getTimestamp();\n            that._process(true);\n        }, 0);\n    };\n\n    DeferredLoading.prototype._nextNode = function() {\n        var stack = this._stack;\n        var top = stack[stack.length-1];\n        var index = top.index;\n        var nodes = top.nodes;\n        if (index === nodes.length) {\n            return;\n        }\n        ++top.index;\n\n        return nodes[index];\n    };\n\n    DeferredLoading.prototype._pop = function() {\n        var stack = this._stack;\n        stack.pop();\n\n        // Return false if we are done\n        if (stack.length === 0) {\n            this._deferred.resolve();\n            return false;\n        }\n\n        return true;\n    };\n\n    DeferredLoading.prototype._process = function(isFirstCall) {\n        var dataSource = this.dataSource;\n        var processingData = this._stack[this._stack.length-1].processingData;\n\n        var child = this._nextNode();\n        while(defined(child)) {\n            var featureProcessor = featureTypes[child.localName];\n            if(defined(featureProcessor) &&\n               ((namespaces.kml.indexOf(child.namespaceURI) !== -1) || (namespaces.gx.indexOf(child.namespaceURI) !== -1))) {\n                featureProcessor(dataSource, child, processingData, this);\n\n                // Give up time and continue loading later\n                if (this._timeoutSet || (KmlDataSource._getTimestamp() > (this._started + this._timeThreshold))) {\n                    this._giveUpTime();\n                    return;\n                }\n            }\n\n            child = this._nextNode();\n        }\n\n        // If we are a recursive call from a subfolder, just return so the parent folder can continue processing\n        // If we aren't then make another call to processNodes because there is stuff still left in the queue\n        if (this._pop() && isFirstCall) {\n            this._process(true);\n        }\n    };\n\n    function isZipFile(blob) {\n        var magicBlob = blob.slice(0, Math.min(4, blob.size));\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(new DataView(reader.result).getUint32(0, false) === 0x504b0304);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsArrayBuffer(magicBlob);\n        return deferred.promise;\n    }\n\n    function readBlobAsText(blob) {\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(reader.result);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsText(blob);\n        return deferred.promise;\n    }\n\n    function insertNamespaces(text) {\n        var namespaceMap = {\n            xsi : 'http://www.w3.org/2001/XMLSchema-instance'\n        };\n        var firstPart, lastPart, reg, declaration;\n\n        for (var key in namespaceMap) {\n            if (namespaceMap.hasOwnProperty(key)) {\n                reg = RegExp('[< ]' + key + ':');\n                declaration = 'xmlns:' + key + '=';\n                if (reg.test(text) && text.indexOf(declaration) === -1) {\n                    if (!defined(firstPart)) {\n                        firstPart = text.substr(0, text.indexOf('<kml') + 4);\n                        lastPart = text.substr(firstPart.length);\n                    }\n                    firstPart += ' ' + declaration + '\"' + namespaceMap[key] + '\"';\n                }\n            }\n        }\n\n        if (defined(firstPart)) {\n            text = firstPart + lastPart;\n        }\n\n        return text;\n    }\n\n    function removeDuplicateNamespaces(text) {\n        var index = text.indexOf('xmlns:');\n        var endDeclaration = text.indexOf('>', index);\n        var namespace, startIndex, endIndex;\n\n        while ((index !== -1) && (index < endDeclaration)) {\n            namespace = text.slice(index, text.indexOf('\\\"', index));\n            startIndex = index;\n            index = text.indexOf(namespace, index + 1);\n            if (index !== -1) {\n                endIndex = text.indexOf('\\\"', (text.indexOf('\\\"', index) + 1));\n                text = text.slice(0, index -1) + text.slice(endIndex + 1, text.length);\n                index = text.indexOf('xmlns:', startIndex - 1);\n            } else {\n                index = text.indexOf('xmlns:', startIndex + 1);\n            }\n        }\n\n        return text;\n    }\n\n    function loadXmlFromZip(entry, uriResolver, deferred) {\n        entry.getData(new zip.TextWriter(), function(text) {\n            text = insertNamespaces(text);\n            text = removeDuplicateNamespaces(text);\n            uriResolver.kml = parser.parseFromString(text, 'application/xml');\n            deferred.resolve();\n        });\n    }\n\n    function loadDataUriFromZip(entry, uriResolver, deferred) {\n        var mimeType = defaultValue(MimeTypes.detectFromFilename(entry.filename), 'application/octet-stream');\n        entry.getData(new zip.Data64URIWriter(mimeType), function(dataUri) {\n            uriResolver[entry.filename] = dataUri;\n            deferred.resolve();\n        });\n    }\n\n    function embedDataUris(div, elementType, attributeName, uriResolver) {\n        var keys = uriResolver.keys;\n        var baseUri = new Uri('.');\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var uri = new Uri(value).resolve(baseUri).toString();\n            var index = keys.indexOf(uri);\n            if (index !== -1) {\n                var key = keys[index];\n                element.setAttribute(attributeName, uriResolver[key]);\n                if (elementType === 'a' && element.getAttribute('download') === null) {\n                    element.setAttribute('download', key);\n                }\n            }\n        }\n    }\n\n    function applyBasePath(div, elementType, attributeName, sourceResource) {\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var resource = resolveHref(value, sourceResource);\n            element.setAttribute(attributeName, resource.url);\n        }\n    }\n\n    // an optional context is passed to allow for some malformed kmls (those with multiple geometries with same ids) to still parse\n    // correctly, as they do in Google Earth.\n    function createEntity(node, entityCollection, context) {\n        var id = queryStringAttribute(node, 'id');\n        id = defined(id) && id.length !== 0 ? id : createGuid();\n        if (defined(context)) {\n            id = context + id;\n        }\n\n        // If we have a duplicate ID just generate one.\n        // This isn't valid KML but Google Earth handles this case.\n        var entity = entityCollection.getById(id);\n        if (defined(entity)) {\n            id = createGuid();\n            if (defined(context)) {\n                id = context + id;\n            }\n        }\n\n        entity = entityCollection.add(new Entity({id : id}));\n        if (!defined(entity.kml)) {\n            entity.addProperty('kml');\n            entity.kml = new KmlFeatureData();\n        }\n        return entity;\n    }\n\n    function isExtrudable(altitudeMode, gxAltitudeMode) {\n        return altitudeMode === 'absolute' || altitudeMode === 'relativeToGround' || gxAltitudeMode === 'relativeToSeaFloor';\n    }\n\n    function readCoordinate(value, ellipsoid) {\n        //Google Earth treats empty or missing coordinates as 0.\n        if (!defined(value)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var digits = value.match(/[^\\s,\\n]+/g);\n        if (!defined(digits)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var longitude = parseFloat(digits[0]);\n        var latitude = parseFloat(digits[1]);\n        var height = parseFloat(digits[2]);\n\n        longitude = isNaN(longitude) ? 0.0 : longitude;\n        latitude = isNaN(latitude) ? 0.0 : latitude;\n        height = isNaN(height) ? 0.0 : height;\n\n        return Cartesian3.fromDegrees(longitude, latitude, height, ellipsoid);\n    }\n\n    function readCoordinates(element, ellipsoid) {\n        if (!defined(element)) {\n            return undefined;\n        }\n\n        var tuples = element.textContent.match(/[^\\s\\n]+/g);\n        if (!defined(tuples)) {\n            return undefined;\n        }\n\n        var length = tuples.length;\n        var result = new Array(length);\n        var resultIndex = 0;\n        for (var i = 0; i < length; i++) {\n            result[resultIndex++] = readCoordinate(tuples[i], ellipsoid);\n        }\n        return result;\n    }\n\n    function queryNumericAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n\n        var value = node.getAttribute(attributeName);\n        if (value !== null) {\n            var result = parseFloat(value);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var value = node.getAttribute(attributeName);\n        return value !== null ? value : undefined;\n    }\n\n    function queryFirstNode(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                return child;\n            }\n        }\n        return undefined;\n    }\n\n    function queryNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result = [];\n        var childNodes = node.getElementsByTagNameNS('*', tagName);\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryChildNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return [];\n        }\n        var result = [];\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryNumericValue(node, tagName, namespace) {\n        var resultNode = queryFirstNode(node, tagName, namespace);\n        if (defined(resultNode)) {\n            var result = parseFloat(resultNode.textContent);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            return result.textContent.trim();\n        }\n        return undefined;\n    }\n\n    function queryBooleanValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            var value = result.textContent.trim();\n            return value === '1' || /^true$/i.test(value);\n        }\n        return undefined;\n    }\n\n    function resolveHref(href, sourceResource, uriResolver) {\n        if (!defined(href)) {\n            return undefined;\n        }\n\n        var resource;\n        if (defined(uriResolver)) {\n            // To resolve issues with KML sources defined in Windows style paths.\n            href = href.replace(/\\\\/g, '/');\n            var blob = uriResolver[href];\n            if (defined(blob)) {\n                resource = new Resource({\n                    url: blob\n                });\n            } else {\n                // Needed for multiple levels of KML files in a KMZ\n                var baseUri = new Uri(sourceResource.getUrlComponent());\n                var uri = new Uri(href);\n                blob = uriResolver[uri.resolve(baseUri)];\n                if (defined(blob)) {\n                    resource = new Resource({\n                        url: blob\n                    });\n                }\n            }\n        }\n\n        if (!defined(resource)) {\n            resource = sourceResource.getDerivedResource({\n                url: href\n            });\n        }\n\n        return resource;\n    }\n\n    var colorOptions = {\n        maximumRed : undefined,\n        red : undefined,\n        maximumGreen : undefined,\n        green : undefined,\n        maximumBlue : undefined,\n        blue : undefined\n    };\n\n    function parseColorString(value, isRandom) {\n        if (!defined(value) || /^\\s*$/gm.test(value)) {\n            return undefined;\n        }\n\n        if (value[0] === '#') {\n            value = value.substring(1);\n        }\n\n        var alpha = parseInt(value.substring(0, 2), 16) / 255.0;\n        var blue = parseInt(value.substring(2, 4), 16) / 255.0;\n        var green = parseInt(value.substring(4, 6), 16) / 255.0;\n        var red = parseInt(value.substring(6, 8), 16) / 255.0;\n\n        if (!isRandom) {\n            return new Color(red, green, blue, alpha);\n        }\n\n        if (red > 0) {\n            colorOptions.maximumRed = red;\n            colorOptions.red = undefined;\n        } else {\n            colorOptions.maximumRed = undefined;\n            colorOptions.red = 0;\n        }\n        if (green > 0) {\n            colorOptions.maximumGreen = green;\n            colorOptions.green = undefined;\n        } else {\n            colorOptions.maximumGreen = undefined;\n            colorOptions.green = 0;\n        }\n        if (blue > 0) {\n            colorOptions.maximumBlue = blue;\n            colorOptions.blue = undefined;\n        } else {\n            colorOptions.maximumBlue = undefined;\n            colorOptions.blue = 0;\n        }\n        colorOptions.alpha = alpha;\n        return Color.fromRandom(colorOptions);\n    }\n\n    function queryColorValue(node, tagName, namespace) {\n        var value = queryStringValue(node, tagName, namespace);\n        if (!defined(value)) {\n            return undefined;\n        }\n        return parseColorString(value, queryStringValue(node, 'colorMode', namespace) === 'random');\n    }\n\n    function processTimeStamp(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeStamp', namespaces.kmlgx);\n        var whenString = queryStringValue(node, 'when', namespaces.kmlgx);\n\n        if (!defined(node) || !defined(whenString) || whenString.length === 0) {\n            return undefined;\n        }\n\n        //According to the KML spec, a TimeStamp represents a \"single moment in time\"\n        //However, since Cesium animates much differently than Google Earth, that doesn't\n        //Make much sense here.  Instead, we use the TimeStamp as the moment the feature\n        //comes into existence.  This works much better and gives a similar feel to\n        //GE's experience.\n        var when = JulianDate.fromIso8601(whenString);\n        var result = new TimeIntervalCollection();\n        result.addInterval(new TimeInterval({\n            start : when,\n            stop : Iso8601.MAXIMUM_VALUE\n        }));\n        return result;\n    }\n\n    function processTimeSpan(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeSpan', namespaces.kmlgx);\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result;\n\n        var beginNode = queryFirstNode(node, 'begin', namespaces.kmlgx);\n        var beginDate = defined(beginNode) ? JulianDate.fromIso8601(beginNode.textContent) : undefined;\n\n        var endNode = queryFirstNode(node, 'end', namespaces.kmlgx);\n        var endDate = defined(endNode) ? JulianDate.fromIso8601(endNode.textContent) : undefined;\n\n        if (defined(beginDate) && defined(endDate)) {\n            if (JulianDate.lessThan(endDate, beginDate)) {\n                var tmp = beginDate;\n                beginDate = endDate;\n                endDate = tmp;\n            }\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : endDate\n            }));\n        } else if (defined(beginDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : Iso8601.MAXIMUM_VALUE\n            }));\n        } else if (defined(endDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : Iso8601.MINIMUM_VALUE,\n                stop : endDate\n            }));\n        }\n\n        return result;\n    }\n\n    function createDefaultBillboard() {\n        var billboard = new BillboardGraphics();\n        billboard.width = BILLBOARD_SIZE;\n        billboard.height = BILLBOARD_SIZE;\n        billboard.scaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        billboard.pixelOffsetScaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        return billboard;\n    }\n\n    function createDefaultPolygon() {\n        var polygon = new PolygonGraphics();\n        polygon.outline = true;\n        polygon.outlineColor = Color.WHITE;\n        return polygon;\n    }\n\n    function createDefaultLabel() {\n        var label = new LabelGraphics();\n        label.translucencyByDistance = new NearFarScalar(3000000, 1.0, 5000000, 0.0);\n        label.pixelOffset = new Cartesian2(17, 0);\n        label.horizontalOrigin = HorizontalOrigin.LEFT;\n        label.font = '16px sans-serif';\n        label.style = LabelStyle.FILL_AND_OUTLINE;\n        return label;\n    }\n\n    function getIconHref(iconNode, dataSource, sourceResource, uriResolver, canRefresh) {\n        var href = queryStringValue(iconNode, 'href', namespaces.kml);\n        if (!defined(href) || (href.length === 0)) {\n            return undefined;\n        }\n\n        if (href.indexOf('root://icons/palette-') === 0) {\n            var palette = href.charAt(21);\n\n            // Get the icon number\n            var x = defaultValue(queryNumericValue(iconNode, 'x', namespaces.gx), 0);\n            var y = defaultValue(queryNumericValue(iconNode, 'y', namespaces.gx), 0);\n            x = Math.min(x / 32, 7);\n            y = 7 - Math.min(y / 32, 7);\n            var iconNum = (8 * y) + x;\n\n            href = 'https://maps.google.com/mapfiles/kml/pal' + palette + '/icon' + iconNum + '.png';\n        }\n\n        var hrefResource = resolveHref(href, sourceResource, uriResolver);\n\n        if (canRefresh) {\n            var refreshMode = queryStringValue(iconNode, 'refreshMode', namespaces.kml);\n            var viewRefreshMode = queryStringValue(iconNode, 'viewRefreshMode', namespaces.kml);\n            if (refreshMode === 'onInterval' || refreshMode === 'onExpire') {\n                oneTimeWarning('kml-refreshMode-' + refreshMode, 'KML - Unsupported Icon refreshMode: ' + refreshMode);\n            } else if (viewRefreshMode === 'onStop' || viewRefreshMode === 'onRegion') {\n                oneTimeWarning('kml-refreshMode-' + viewRefreshMode, 'KML - Unsupported Icon viewRefreshMode: ' + viewRefreshMode);\n            }\n\n            var viewBoundScale = defaultValue(queryStringValue(iconNode, 'viewBoundScale', namespaces.kml), 1.0);\n            var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n            var viewFormat = defaultValue(queryStringValue(iconNode, 'viewFormat', namespaces.kml), defaultViewFormat);\n            var httpQuery = queryStringValue(iconNode, 'httpQuery', namespaces.kml);\n            if (defined(viewFormat)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n            }\n            if (defined(httpQuery)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n            }\n\n            var ellipsoid = dataSource._ellipsoid;\n            processNetworkLinkQueryString(hrefResource, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n\n            return hrefResource;\n        }\n\n        return hrefResource;\n    }\n\n    function processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver) {\n        var scale = queryNumericValue(node, 'scale', namespaces.kml);\n        var heading = queryNumericValue(node, 'heading', namespaces.kml);\n        var color = queryColorValue(node, 'color', namespaces.kml);\n\n        var iconNode = queryFirstNode(node, 'Icon', namespaces.kml);\n        var icon = getIconHref(iconNode, dataSource, sourceResource, uriResolver, false);\n\n        // If icon tags are present but blank, we do not want to show an icon\n        if (defined(iconNode) && !defined(icon)) {\n            icon = false;\n        }\n\n        var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n        var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n        var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n        var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n        var hotSpotNode = queryFirstNode(node, 'hotSpot', namespaces.kml);\n        var hotSpotX = queryNumericAttribute(hotSpotNode, 'x');\n        var hotSpotY = queryNumericAttribute(hotSpotNode, 'y');\n        var hotSpotXUnit = queryStringAttribute(hotSpotNode, 'xunits');\n        var hotSpotYUnit = queryStringAttribute(hotSpotNode, 'yunits');\n\n        var billboard = targetEntity.billboard;\n        if (!defined(billboard)) {\n            billboard = createDefaultBillboard();\n            targetEntity.billboard = billboard;\n        }\n\n        billboard.image = icon;\n        billboard.scale = scale;\n        billboard.color = color;\n\n        if (defined(x) || defined(y) || defined(w) || defined(h)) {\n            billboard.imageSubRegion = new BoundingRectangle(x, y, w, h);\n        }\n\n        //GE treats a heading of zero as no heading\n        //You can still point north using a 360 degree angle (or any multiple of 360)\n        if (defined(heading) && heading !== 0) {\n            billboard.rotation = CesiumMath.toRadians(-heading);\n            billboard.alignedAxis = Cartesian3.UNIT_Z;\n        }\n\n        //Hotpot is the KML equivalent of pixel offset\n        //The hotspot origin is the lower left, but we leave\n        //our billboard origin at the center and simply\n        //modify the pixel offset to take this into account\n        scale = defaultValue(scale, 1.0);\n\n        var xOffset;\n        var yOffset;\n        if (defined(hotSpotX)) {\n            if (hotSpotXUnit === 'pixels') {\n                xOffset = -hotSpotX * scale;\n            } else if (hotSpotXUnit === 'insetPixels') {\n                xOffset = (hotSpotX - BILLBOARD_SIZE) * scale;\n            } else if (hotSpotXUnit === 'fraction') {\n                xOffset = -hotSpotX * BILLBOARD_SIZE * scale;\n            }\n            xOffset += BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(hotSpotY)) {\n            if (hotSpotYUnit === 'pixels') {\n                yOffset = hotSpotY * scale;\n            } else if (hotSpotYUnit === 'insetPixels') {\n                yOffset = (-hotSpotY + BILLBOARD_SIZE) * scale;\n            } else if (hotSpotYUnit === 'fraction') {\n                yOffset = hotSpotY * BILLBOARD_SIZE * scale;\n            }\n\n            yOffset -= BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(xOffset) || defined(yOffset)) {\n            billboard.pixelOffset = new Cartesian2(xOffset, yOffset);\n        }\n    }\n\n    function applyStyle(dataSource, styleNode, targetEntity, sourceResource, uriResolver) {\n        for (var i = 0, len = styleNode.childNodes.length; i < len; i++) {\n            var node = styleNode.childNodes.item(i);\n            if (node.localName === 'IconStyle') {\n                processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver);\n            } else if (node.localName === 'LabelStyle') {\n                var label = targetEntity.label;\n                if (!defined(label)) {\n                    label = createDefaultLabel();\n                    targetEntity.label = label;\n                }\n                label.scale = defaultValue(queryNumericValue(node, 'scale', namespaces.kml), label.scale);\n                label.fillColor = defaultValue(queryColorValue(node, 'color', namespaces.kml), label.fillColor);\n                label.text = targetEntity.name;\n            } else if (node.localName === 'LineStyle') {\n                var polyline = targetEntity.polyline;\n                if (!defined(polyline)) {\n                    polyline = new PolylineGraphics();\n                    targetEntity.polyline = polyline;\n                }\n                polyline.width = queryNumericValue(node, 'width', namespaces.kml);\n                polyline.material = queryColorValue(node, 'color', namespaces.kml);\n                if (defined(queryColorValue(node, 'outerColor', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerColor', 'KML - gx:outerColor is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'outerWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerWidth', 'KML - gx:outerWidth is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'physicalWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:physicalWidth', 'KML - gx:physicalWidth is not supported in a LineStyle');\n                }\n                if (defined(queryBooleanValue(node, 'labelVisibility', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:labelVisibility', 'KML - gx:labelVisibility is not supported in a LineStyle');\n                }\n            } else if (node.localName === 'PolyStyle') {\n                var polygon = targetEntity.polygon;\n                if (!defined(polygon)) {\n                    polygon = createDefaultPolygon();\n                    targetEntity.polygon = polygon;\n                }\n                polygon.material = defaultValue(queryColorValue(node, 'color', namespaces.kml), polygon.material);\n                polygon.fill = defaultValue(queryBooleanValue(node, 'fill', namespaces.kml), polygon.fill);\n                polygon.outline = defaultValue(queryBooleanValue(node, 'outline', namespaces.kml), polygon.outline);\n            } else if (node.localName === 'BalloonStyle') {\n                var bgColor = defaultValue(parseColorString(queryStringValue(node, 'bgColor', namespaces.kml)), Color.WHITE);\n                var textColor = defaultValue(parseColorString(queryStringValue(node, 'textColor', namespaces.kml)), Color.BLACK);\n                var text = queryStringValue(node, 'text', namespaces.kml);\n\n                //This is purely an internal property used in style processing,\n                //it never ends up on the final entity.\n                targetEntity.addProperty('balloonStyle');\n                targetEntity.balloonStyle = {\n                    bgColor : bgColor,\n                    textColor : textColor,\n                    text : text\n                };\n            } else if (node.localName === 'ListStyle') {\n                var listItemType = queryStringValue(node, 'listItemType', namespaces.kml);\n                if (listItemType === 'radioFolder' || listItemType === 'checkOffOnly') {\n                    oneTimeWarning('kml-listStyle-' + listItemType, 'KML - Unsupported ListStyle with listItemType: ' + listItemType);\n                }\n            }\n        }\n    }\n\n    //Processes and merges any inline styles for the provided node into the provided entity.\n    function computeFinalStyle(dataSource, placeMark, styleCollection, sourceResource, uriResolver) {\n        var result = new Entity();\n        var styleEntity;\n\n        //Google earth seems to always use the last inline Style/StyleMap only\n        var styleIndex = -1;\n        var childNodes = placeMark.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === 'Style' || child.localName === 'StyleMap') {\n                styleIndex = q;\n            }\n        }\n\n        if (styleIndex !== -1) {\n            var inlineStyleNode = childNodes[styleIndex];\n            if (inlineStyleNode.localName === 'Style') {\n                applyStyle(dataSource, inlineStyleNode, result, sourceResource, uriResolver);\n            } else { // StyleMap\n                var pairs = queryChildNodes(inlineStyleNode, 'Pair', namespaces.kml);\n                for (var p = 0; p < pairs.length; p++) {\n                    var pair = pairs[p];\n                    var key = queryStringValue(pair, 'key', namespaces.kml);\n                    if (key === 'normal') {\n                        var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                        if (defined(styleUrl)) {\n                            styleEntity = styleCollection.getById(styleUrl);\n                            if (!defined(styleEntity)) {\n                                styleEntity = styleCollection.getById('#' + styleUrl);\n                            }\n                            if (defined(styleEntity)) {\n                                result.merge(styleEntity);\n                            }\n                        } else {\n                            var node = queryFirstNode(pair, 'Style', namespaces.kml);\n                            applyStyle(dataSource, node, result, sourceResource, uriResolver);\n                        }\n                    } else {\n                        oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                    }\n                }\n            }\n        }\n\n        //Google earth seems to always use the first external style only.\n        var externalStyle = queryStringValue(placeMark, 'styleUrl', namespaces.kml);\n        if (defined(externalStyle)) {\n            var id = externalStyle;\n            if (externalStyle[0] !== '#' && externalStyle.indexOf('#') !== -1) {\n                var tokens = externalStyle.split('#');\n                var uri = tokens[0];\n                var resource = sourceResource.getDerivedResource({\n                    url: uri\n                });\n\n                id = resource.getUrlComponent() + '#' + tokens[1];\n            }\n\n            styleEntity = styleCollection.getById(id);\n            if (!defined(styleEntity)) {\n                styleEntity = styleCollection.getById('#' + id);\n            }\n            if (defined(styleEntity)) {\n                result.merge(styleEntity);\n            }\n        }\n\n        return result;\n    }\n\n    //Asynchronously processes an external style file.\n    function processExternalStyles(dataSource, resource, styleCollection) {\n        return resource.fetchXML().then(function(styleKml) {\n            return processStyles(dataSource, styleKml, styleCollection, resource, true);\n        });\n    }\n\n    //Processes all shared and external styles and stores\n    //their id into the provided styleCollection.\n    //Returns an array of promises that will resolve when\n    //each style is loaded.\n    function processStyles(dataSource, kml, styleCollection, sourceResource, isExternal, uriResolver) {\n        var i;\n        var id;\n        var styleEntity;\n\n        var node;\n        var styleNodes = queryNodes(kml, 'Style', namespaces.kml);\n        if (defined(styleNodes)) {\n            var styleNodesLength = styleNodes.length;\n            for (i = 0; i < styleNodesLength; i++) {\n                node = styleNodes[i];\n                id = queryStringAttribute(node, 'id');\n                if (defined(id)) {\n                    id = '#' + id;\n                    if (isExternal && defined(sourceResource)) {\n                        id = sourceResource.getUrlComponent() + id;\n                    }\n                    if (!defined(styleCollection.getById(id))) {\n                        styleEntity = new Entity({\n                            id : id\n                        });\n                        styleCollection.add(styleEntity);\n                        applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                    }\n                }\n            }\n        }\n\n        var styleMaps = queryNodes(kml, 'StyleMap', namespaces.kml);\n        if (defined(styleMaps)) {\n            var styleMapsLength = styleMaps.length;\n            for (i = 0; i < styleMapsLength; i++) {\n                var styleMap = styleMaps[i];\n                id = queryStringAttribute(styleMap, 'id');\n                if (defined(id)) {\n                    var pairs = queryChildNodes(styleMap, 'Pair', namespaces.kml);\n                    for (var p = 0; p < pairs.length; p++) {\n                        var pair = pairs[p];\n                        var key = queryStringValue(pair, 'key', namespaces.kml);\n                        if (key === 'normal') {\n                            id = '#' + id;\n                            if (isExternal && defined(sourceResource)) {\n                                id = sourceResource.getUrlComponent() + id;\n                            }\n                            if (!defined(styleCollection.getById(id))) {\n                                styleEntity = styleCollection.getOrCreateEntity(id);\n\n                                var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                                if (defined(styleUrl)) {\n                                    if (styleUrl[0] !== '#') {\n                                        styleUrl = '#' + styleUrl;\n                                    }\n\n                                    if (isExternal && defined(sourceResource)) {\n                                        styleUrl = sourceResource.getUrlComponent() + styleUrl;\n                                    }\n                                    var base = styleCollection.getById(styleUrl);\n\n                                    if (defined(base)) {\n                                        styleEntity.merge(base);\n                                    }\n                                } else {\n                                    node = queryFirstNode(pair, 'Style', namespaces.kml);\n                                    applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                                }\n                            }\n                        } else {\n                            oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                        }\n                    }\n                }\n            }\n        }\n\n        var promises = [];\n        var styleUrlNodes = kml.getElementsByTagName('styleUrl');\n        var styleUrlNodesLength = styleUrlNodes.length;\n        for (i = 0; i < styleUrlNodesLength; i++) {\n            var styleReference = styleUrlNodes[i].textContent;\n            if (styleReference[0] !== '#') {\n                //According to the spec, all local styles should start with a #\n                //and everything else is an external style that has a # seperating\n                //the URL of the document and the style.  However, Google Earth\n                //also accepts styleUrls without a # as meaning a local style.\n                var tokens = styleReference.split('#');\n                if (tokens.length === 2) {\n                    var uri = tokens[0];\n                    var resource = sourceResource.getDerivedResource({\n                        url: uri\n                    });\n\n                    promises.push(processExternalStyles(dataSource, resource, styleCollection));\n                }\n            }\n        }\n\n        return promises;\n    }\n\n    function createDropLine(entityCollection, entity, styleEntity) {\n        var entityPosition = new ReferenceProperty(entityCollection, entity.id, ['position']);\n        var surfacePosition = new ScaledPositionProperty(entity.position);\n        entity.polyline = defined(styleEntity.polyline) ? styleEntity.polyline.clone() : new PolylineGraphics();\n        entity.polyline.positions = new PositionPropertyArray([entityPosition, surfacePosition]);\n    }\n\n    function heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode) {\n        if (!defined(altitudeMode) && !defined(gxAltitudeMode) || altitudeMode === 'clampToGround') {\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (altitudeMode === 'relativeToGround') {\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (altitudeMode === 'absolute') {\n            return HeightReference.NONE;\n        }\n\n        if (gxAltitudeMode === 'clampToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-clampToSeaFloor', 'KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.');\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-relativeToSeaFloor', 'KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.');\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (defined(altitudeMode)) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown <kml:altitudeMode>:' + altitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        } else {\n            oneTimeWarning('kml-gx:altitudeMode-unknown', 'KML - Unknown <gx:altitudeMode>:' + gxAltitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        }\n\n        // Clamp to ground is the default\n        return HeightReference.CLAMP_TO_GROUND;\n    }\n\n    function createPositionPropertyFromAltitudeMode(property, altitudeMode, gxAltitudeMode) {\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return property;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        return new ScaledPositionProperty(property);\n    }\n\n    function createPositionPropertyArrayFromAltitudeMode(properties, altitudeMode, gxAltitudeMode, ellipsoid) {\n        if (!defined(properties)) {\n            return undefined;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return properties;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        var propertiesLength = properties.length;\n        for (var i = 0; i < propertiesLength; i++) {\n            var property = properties[i];\n            ellipsoid.scaleToGeodeticSurface(property, property);\n        }\n        return properties;\n    }\n\n    function processPositionGraphics(dataSource, entity, styleEntity, heightReference) {\n        var label = entity.label;\n        if (!defined(label)) {\n            label = defined(styleEntity.label) ? styleEntity.label.clone() : createDefaultLabel();\n            entity.label = label;\n        }\n        label.text = entity.name;\n\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            billboard = defined(styleEntity.billboard) ? styleEntity.billboard.clone() : createDefaultBillboard();\n            entity.billboard = billboard;\n        }\n\n        if (!defined(billboard.image)) {\n            billboard.image = dataSource._pinBuilder.fromColor(Color.YELLOW, 64);\n\n        // If there were empty <Icon> tags in the KML, then billboard.image was set to false above\n        // However, in this case, the false value would have been converted to a property afterwards\n        // Thus, we check if billboard.image is defined with value of false\n        } else if (!billboard.image.getValue()) {\n            billboard.image = undefined;\n        }\n\n        var scale = 1.0;\n        if (defined(billboard.scale)) {\n            scale = billboard.scale.getValue();\n            if (scale !== 0) {\n                label.pixelOffset = new Cartesian2((scale * 16) + 1, 0);\n            } else {\n                //Minor tweaks to better match Google Earth.\n                label.pixelOffset = undefined;\n                label.horizontalOrigin = undefined;\n            }\n        }\n\n        if (defined(heightReference) && dataSource._clampToGround) {\n            billboard.heightReference = heightReference;\n            label.heightReference = heightReference;\n        }\n    }\n\n    function processPathGraphics(entity, styleEntity) {\n        var path = entity.path;\n        if (!defined(path)) {\n            path = new PathGraphics();\n            path.leadTime = 0;\n            entity.path = path;\n        }\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            path.material = polyline.material;\n            path.width = polyline.width;\n        }\n    }\n\n    function processPoint(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesString = queryStringValue(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var position = readCoordinate(coordinatesString, ellipsoid);\n\n        entity.position = position;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n\n        if (extrude && isExtrudable(altitudeMode, gxAltitudeMode)) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function processLineStringOrLinearRing(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesNode = queryFirstNode(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var tessellate = queryBooleanValue(geometryNode, 'tessellate', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var zIndex = queryNumericValue(geometryNode, 'drawOrder', namespaces.gx);\n\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var polyline = styleEntity.polyline;\n        if (canExtrude && extrude) {\n            var wall = new WallGraphics();\n            entity.wall = wall;\n            wall.positions = coordinates;\n            var polygon = styleEntity.polygon;\n\n            if (defined(polygon)) {\n                wall.fill = polygon.fill;\n                wall.material = polygon.material;\n            }\n\n            //Always outline walls so they show up in 2D.\n            wall.outline = true;\n            if (defined(polyline)) {\n                wall.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n                wall.outlineWidth = polyline.width;\n            } else if (defined(polygon)) {\n                wall.outlineColor = defined(polygon.material) ? polygon.material.color : Color.WHITE;\n            }\n        } else if (dataSource._clampToGround && !canExtrude && tessellate) {\n            var polylineGraphics = new PolylineGraphics();\n            polylineGraphics.clampToGround = true;\n            entity.polyline = polylineGraphics;\n            polylineGraphics.positions = coordinates;\n            if (defined(polyline)) {\n                polylineGraphics.material = defined(polyline.material) ? polyline.material.color.getValue(Iso8601.MINIMUM_VALUE) : Color.WHITE;\n                polylineGraphics.width = defaultValue(polyline.width, 1.0);\n            } else {\n                polylineGraphics.material = Color.WHITE;\n                polylineGraphics.width = 1.0;\n            }\n            polylineGraphics.zIndex = zIndex;\n        } else {\n            if (defined(zIndex)) {\n                oneTimeWarning('kml-gx:drawOrder', 'KML - gx:drawOrder is not supported in LineStrings when clampToGround is false');\n            }\n            if (dataSource._clampToGround && !tessellate) {\n                oneTimeWarning('kml-line-tesselate', 'Ignoring clampToGround for KML lines without the tessellate flag.');\n            }\n\n            polyline = defined(polyline) ? polyline.clone() : new PolylineGraphics();\n            entity.polyline = polyline;\n            polyline.positions = createPositionPropertyArrayFromAltitudeMode(coordinates, altitudeMode, gxAltitudeMode, ellipsoid);\n            if (!tessellate || canExtrude) {\n                polyline.arcType = ArcType.NONE;\n            }\n        }\n\n        return true;\n    }\n\n    function processPolygon(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var outerBoundaryIsNode = queryFirstNode(geometryNode, 'outerBoundaryIs', namespaces.kml);\n        var linearRingNode = queryFirstNode(outerBoundaryIsNode, 'LinearRing', namespaces.kml);\n        var coordinatesNode = queryFirstNode(linearRingNode, 'coordinates', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n\n        var polygon = defined(styleEntity.polygon) ? styleEntity.polygon.clone() : createDefaultPolygon();\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            polygon.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n            polygon.outlineWidth = polyline.width;\n        }\n        entity.polygon = polygon;\n\n        if (canExtrude) {\n            polygon.perPositionHeight = true;\n            polygon.extrudedHeight = extrude ? 0 : undefined;\n        } else if (!dataSource._clampToGround) {\n            polygon.height = 0;\n        }\n\n        if (defined(coordinates)) {\n            var hierarchy = new PolygonHierarchy(coordinates);\n            var innerBoundaryIsNodes = queryChildNodes(geometryNode, 'innerBoundaryIs', namespaces.kml);\n            for (var j = 0; j < innerBoundaryIsNodes.length; j++) {\n                linearRingNode = queryChildNodes(innerBoundaryIsNodes[j], 'LinearRing', namespaces.kml);\n                for (var k = 0; k < linearRingNode.length; k++) {\n                    coordinatesNode = queryFirstNode(linearRingNode[k], 'coordinates', namespaces.kml);\n                    coordinates = readCoordinates(coordinatesNode, ellipsoid);\n                    if (defined(coordinates)) {\n                        hierarchy.holes.push(new PolygonHierarchy(coordinates));\n                    }\n                }\n            }\n            polygon.hierarchy = hierarchy;\n        }\n\n        return true;\n    }\n\n    function processTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var coordNodes = queryChildNodes(geometryNode, 'coord', namespaces.gx);\n        var angleNodes = queryChildNodes(geometryNode, 'angles', namespaces.gx);\n        var timeNodes = queryChildNodes(geometryNode, 'when', namespaces.kml);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var ellipsoid = dataSource._ellipsoid;\n\n        if (angleNodes.length > 0) {\n            oneTimeWarning('kml-gx:angles', 'KML - gx:angles are not supported in gx:Tracks');\n        }\n\n        var length = Math.min(coordNodes.length, timeNodes.length);\n        var coordinates = [];\n        var times = [];\n        for (var i = 0; i < length; i++) {\n            var position = readCoordinate(coordNodes[i].textContent, ellipsoid);\n            coordinates.push(position);\n            times.push(JulianDate.fromIso8601(timeNodes[i].textContent));\n        }\n        var property = new SampledPositionProperty();\n        property.addSamples(times, coordinates);\n        entity.position = property;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n        processPathGraphics(entity, styleEntity);\n\n        entity.availability = new TimeIntervalCollection();\n\n        if (timeNodes.length > 0) {\n            entity.availability.addInterval(new TimeInterval({\n                start : times[0],\n                stop : times[times.length - 1]\n            }));\n        }\n\n        if (canExtrude && extrude) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function addToMultiTrack(times, positions, composite, availability, dropShowProperty, extrude, altitudeMode, gxAltitudeMode, includeEndPoints) {\n        var start = times[0];\n        var stop = times[times.length - 1];\n\n        var data = new SampledPositionProperty();\n        data.addSamples(times, positions);\n\n        composite.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : createPositionPropertyFromAltitudeMode(data, altitudeMode, gxAltitudeMode)\n        }));\n        availability.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints\n        }));\n        dropShowProperty.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : extrude\n        }));\n    }\n\n    function processMultiTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        // Multitrack options do not work in GE as detailed in the spec,\n        // rather than altitudeMode being at the MultiTrack level,\n        // GE just defers all settings to the underlying track.\n\n        var interpolate = queryBooleanValue(geometryNode, 'interpolate', namespaces.gx);\n        var trackNodes = queryChildNodes(geometryNode, 'Track', namespaces.gx);\n\n        var times;\n        var lastStop;\n        var lastStopPosition;\n        var needDropLine = false;\n        var dropShowProperty = new TimeIntervalCollectionProperty();\n        var availability = new TimeIntervalCollection();\n        var composite = new CompositePositionProperty();\n        var ellipsoid = dataSource._ellipsoid;\n        for (var i = 0, len = trackNodes.length; i < len; i++) {\n            var trackNode = trackNodes[i];\n            var timeNodes = queryChildNodes(trackNode, 'when', namespaces.kml);\n            var coordNodes = queryChildNodes(trackNode, 'coord', namespaces.gx);\n            var altitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.kml);\n            var gxAltitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.gx);\n            var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n            var extrude = queryBooleanValue(trackNode, 'extrude', namespaces.kml);\n\n            var length = Math.min(coordNodes.length, timeNodes.length);\n\n            var positions = [];\n            times = [];\n            for (var x = 0; x < length; x++) {\n                var position = readCoordinate(coordNodes[x].textContent, ellipsoid);\n                positions.push(position);\n                times.push(JulianDate.fromIso8601(timeNodes[x].textContent));\n            }\n\n            if (interpolate) {\n                //If we are interpolating, then we need to fill in the end of\n                //the last track and the beginning of this one with a sampled\n                //property.  From testing in Google Earth, this property\n                //is never extruded and always absolute.\n                if (defined(lastStop)) {\n                    addToMultiTrack([lastStop, times[0]], [lastStopPosition, positions[0]], composite, availability, dropShowProperty, false, 'absolute', undefined, false);\n                }\n                lastStop = times[length - 1];\n                lastStopPosition = positions[positions.length - 1];\n            }\n\n            addToMultiTrack(times, positions, composite, availability, dropShowProperty, canExtrude && extrude, altitudeMode, gxAltitudeMode, true);\n            needDropLine = needDropLine || (canExtrude && extrude);\n        }\n\n        entity.availability = availability;\n        entity.position = composite;\n        processPositionGraphics(dataSource, entity, styleEntity);\n        processPathGraphics(entity, styleEntity);\n        if (needDropLine) {\n            createDropLine(entityCollection, entity, styleEntity);\n            entity.polyline.show = dropShowProperty;\n        }\n\n        return true;\n    }\n\n    var geometryTypes = {\n        Point : processPoint,\n        LineString : processLineStringOrLinearRing,\n        LinearRing : processLineStringOrLinearRing,\n        Polygon : processPolygon,\n        Track : processTrack,\n        MultiTrack : processMultiTrack,\n        MultiGeometry : processMultiGeometry,\n        Model : processUnsupportedGeometry\n    };\n\n    function processMultiGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity, context) {\n        var childNodes = geometryNode.childNodes;\n        var hasGeometry = false;\n        for (var i = 0, len = childNodes.length; i < len; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                var childEntity = createEntity(childNode, entityCollection, context);\n                childEntity.parent = entity;\n                childEntity.name = entity.name;\n                childEntity.availability = entity.availability;\n                childEntity.description = entity.description;\n                childEntity.kml = entity.kml;\n                if (geometryProcessor(dataSource, entityCollection, childNode, childEntity, styleEntity)) {\n                    hasGeometry = true;\n                }\n            }\n        }\n\n        return hasGeometry;\n    }\n\n    function processUnsupportedGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        oneTimeWarning('kml-unsupportedGeometry', 'KML - Unsupported geometry: ' + geometryNode.localName);\n        return false;\n    }\n\n    function processExtendedData(node, entity) {\n        var extendedDataNode = queryFirstNode(node, 'ExtendedData', namespaces.kml);\n\n        if (!defined(extendedDataNode)) {\n            return undefined;\n        }\n\n        if (defined(queryFirstNode(extendedDataNode, 'SchemaData', namespaces.kml))) {\n            oneTimeWarning('kml-schemaData', 'KML - SchemaData is unsupported');\n        }\n        if (defined(queryStringAttribute(extendedDataNode, 'xmlns:prefix'))) {\n            oneTimeWarning('kml-extendedData', 'KML - ExtendedData with xmlns:prefix is unsupported');\n        }\n\n        var result = {};\n        var dataNodes = queryChildNodes(extendedDataNode, 'Data', namespaces.kml);\n        if (defined(dataNodes)) {\n            var length = dataNodes.length;\n            for (var i = 0; i < length; i++) {\n                var dataNode = dataNodes[i];\n                var name = queryStringAttribute(dataNode, 'name');\n                if (defined(name)) {\n                    result[name] = {\n                        displayName : queryStringValue(dataNode, 'displayName', namespaces.kml),\n                        value : queryStringValue(dataNode, 'value', namespaces.kml)\n                    };\n                }\n            }\n        }\n        entity.kml.extendedData = result;\n    }\n\n    var scratchDiv;\n    if (typeof document !== 'undefined') {\n        scratchDiv = document.createElement('div');\n    }\n\n    function processDescription(node, entity, styleEntity, uriResolver, sourceResource) {\n        var i;\n        var key;\n        var keys;\n\n        var kmlData = entity.kml;\n        var extendedData = kmlData.extendedData;\n        var description = queryStringValue(node, 'description', namespaces.kml);\n\n        var balloonStyle = defaultValue(entity.balloonStyle, styleEntity.balloonStyle);\n\n        var background = Color.WHITE;\n        var foreground = Color.BLACK;\n        var text = description;\n\n        if (defined(balloonStyle)) {\n            background = defaultValue(balloonStyle.bgColor, Color.WHITE);\n            foreground = defaultValue(balloonStyle.textColor, Color.BLACK);\n            text = defaultValue(balloonStyle.text, description);\n        }\n\n        var value;\n        if (defined(text)) {\n            text = text.replace('$[name]', defaultValue(entity.name, ''));\n            text = text.replace('$[description]', defaultValue(description, ''));\n            text = text.replace('$[address]', defaultValue(kmlData.address, ''));\n            text = text.replace('$[Snippet]', defaultValue(kmlData.snippet, ''));\n            text = text.replace('$[id]', entity.id);\n\n            //While not explicitly defined by the OGC spec, in Google Earth\n            //The appearance of geDirections adds the directions to/from links\n            //We simply replace this string with nothing.\n            text = text.replace('$[geDirections]', '');\n\n            if (defined(extendedData)) {\n                var matches = text.match(/\\$\\[.+?\\]/g);\n                if (matches !== null) {\n                    for (i = 0; i < matches.length; i++) {\n                        var token = matches[i];\n                        var propertyName = token.substr(2, token.length - 3);\n                        var isDisplayName = /\\/displayName$/.test(propertyName);\n                        propertyName = propertyName.replace(/\\/displayName$/, '');\n\n                        value = extendedData[propertyName];\n                        if (defined(value)) {\n                            value = isDisplayName ? value.displayName : value.value;\n                        }\n                        if (defined(value)) {\n                            text = text.replace(token, defaultValue(value, ''));\n                        }\n                    }\n                }\n            }\n        } else if (defined(extendedData)) {\n            //If no description exists, build a table out of the extended data\n            keys = Object.keys(extendedData);\n            if (keys.length > 0) {\n                text = '<table class=\"cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter\"><tbody>';\n                for (i = 0; i < keys.length; i++) {\n                    key = keys[i];\n                    value = extendedData[key];\n                    text += '<tr><th>' + defaultValue(value.displayName, key) + '</th><td>' + defaultValue(value.value, '') + '</td></tr>';\n                }\n                text += '</tbody></table>';\n            }\n        }\n\n        if (!defined(text)) {\n            //No description\n            return;\n        }\n\n        //Turns non-explicit links into clickable links.\n        text = autolinker.link(text);\n\n        //Use a temporary div to manipulate the links\n        //so that they open in a new window.\n        scratchDiv.innerHTML = text;\n        var links = scratchDiv.querySelectorAll('a');\n        for (i = 0; i < links.length; i++) {\n            links[i].setAttribute('target', '_blank');\n        }\n\n        //Rewrite any KMZ embedded urls\n        if (defined(uriResolver) && uriResolver.keys.length > 1) {\n            embedDataUris(scratchDiv, 'a', 'href', uriResolver);\n            embedDataUris(scratchDiv, 'img', 'src', uriResolver);\n        }\n\n        //Make relative urls absolute using the sourceResource\n        applyBasePath(scratchDiv, 'a', 'href', sourceResource);\n        applyBasePath(scratchDiv, 'img', 'src', sourceResource);\n\n        var tmp = '<div class=\"cesium-infoBox-description-lighter\" style=\"';\n        tmp += 'overflow:auto;';\n        tmp += 'word-wrap:break-word;';\n        tmp += 'background-color:' + background.toCssColorString() + ';';\n        tmp += 'color:' + foreground.toCssColorString() + ';';\n        tmp += '\">';\n        tmp += scratchDiv.innerHTML + '</div>';\n        scratchDiv.innerHTML = '';\n\n        //Set the final HTML as the description.\n        entity.description = tmp;\n    }\n\n    function processFeature(dataSource, featureNode, processingData) {\n        var entityCollection = processingData.entityCollection;\n        var parent = processingData.parentEntity;\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var entity = createEntity(featureNode, entityCollection, processingData.context);\n        var kmlData = entity.kml;\n        var styleEntity = computeFinalStyle(dataSource, featureNode, processingData.styleCollection, sourceResource, uriResolver);\n\n        var name = queryStringValue(featureNode, 'name', namespaces.kml);\n        entity.name = name;\n        entity.parent = parent;\n\n        var availability = processTimeSpan(featureNode);\n        if (!defined(availability)) {\n            availability = processTimeStamp(featureNode);\n        }\n        entity.availability = availability;\n\n        mergeAvailabilityWithParent(entity);\n\n        // Per KML spec \"A Feature is visible only if it and all its ancestors are visible.\"\n        function ancestryIsVisible(parentEntity) {\n            if (!parentEntity) {\n                return true;\n            }\n            return parentEntity.show && ancestryIsVisible(parentEntity.parent);\n        }\n\n        var visibility = queryBooleanValue(featureNode, 'visibility', namespaces.kml);\n        entity.show = ancestryIsVisible(parent) && defaultValue(visibility, true);\n        //var open = queryBooleanValue(featureNode, 'open', namespaces.kml);\n\n        var authorNode = queryFirstNode(featureNode, 'author', namespaces.atom);\n        var author = kmlData.author;\n        author.name = queryStringValue(authorNode, 'name', namespaces.atom);\n        author.uri = queryStringValue(authorNode, 'uri', namespaces.atom);\n        author.email = queryStringValue(authorNode, 'email', namespaces.atom);\n\n        var linkNode = queryFirstNode(featureNode, 'link', namespaces.atom);\n        var link = kmlData.link;\n        link.href = queryStringAttribute(linkNode, 'href');\n        link.hreflang = queryStringAttribute(linkNode, 'hreflang');\n        link.rel = queryStringAttribute(linkNode, 'rel');\n        link.type = queryStringAttribute(linkNode, 'type');\n        link.title = queryStringAttribute(linkNode, 'title');\n        link.length = queryStringAttribute(linkNode, 'length');\n\n        kmlData.address = queryStringValue(featureNode, 'address', namespaces.kml);\n        kmlData.phoneNumber = queryStringValue(featureNode, 'phoneNumber', namespaces.kml);\n        kmlData.snippet = queryStringValue(featureNode, 'Snippet', namespaces.kml);\n\n        processExtendedData(featureNode, entity);\n        processDescription(featureNode, entity, styleEntity, uriResolver, sourceResource);\n\n        var ellipsoid = dataSource._ellipsoid;\n        processLookAt(featureNode, entity, ellipsoid);\n        processCamera(featureNode, entity, ellipsoid);\n\n        if (defined(queryFirstNode(featureNode, 'Region', namespaces.kml))) {\n            oneTimeWarning('kml-region', 'KML - Placemark Regions are unsupported');\n        }\n\n        return {\n            entity : entity,\n            styleEntity : styleEntity\n        };\n    }\n\n    function processDocument(dataSource, node, processingData, deferredLoading) {\n        deferredLoading.addNodes(node.childNodes, processingData);\n        deferredLoading.process();\n    }\n\n    function processFolder(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var newProcessingData = clone(processingData);\n        newProcessingData.parentEntity = r.entity;\n        processDocument(dataSource, node, newProcessingData, deferredLoading);\n    }\n\n    function processPlacemark(dataSource, placemark, processingData, deferredLoading) {\n        var r = processFeature(dataSource, placemark, processingData);\n        var entity = r.entity;\n        var styleEntity = r.styleEntity;\n\n        var hasGeometry = false;\n        var childNodes = placemark.childNodes;\n        for (var i = 0, len = childNodes.length; i < len && !hasGeometry; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                // pass the placemark entity id as a context for case of defining multiple child entities together to handle case\n                // where some malformed kmls reuse the same id across placemarks, which works in GE, but is not technically to spec.\n                geometryProcessor(dataSource, processingData.entityCollection, childNode, entity, styleEntity, entity.id);\n                hasGeometry = true;\n            }\n        }\n\n        if (!hasGeometry) {\n            entity.merge(styleEntity);\n            processPositionGraphics(dataSource, entity, styleEntity);\n        }\n    }\n\n    var playlistNodeProcessors = {\n        FlyTo: processTourFlyTo,\n        Wait: processTourWait,\n        SoundCue: processTourUnsupportedNode,\n        AnimatedUpdate: processTourUnsupportedNode,\n        TourControl: processTourUnsupportedNode\n    };\n\n    function processTour(dataSource, node, processingData, deferredLoading) {\n        var name = queryStringValue(node, 'name', namespaces.kml);\n        var id = queryStringAttribute(node, 'id');\n        var tour = new KmlTour(name, id);\n\n        var playlistNode = queryFirstNode(node, 'Playlist', namespaces.gx);\n        if(playlistNode) {\n            var ellipsoid = dataSource._ellipsoid;\n            var childNodes = playlistNode.childNodes;\n            for(var i = 0; i < childNodes.length; i++) {\n                var entryNode = childNodes[i];\n                if (entryNode.localName) {\n                    var playlistNodeProcessor = playlistNodeProcessors[entryNode.localName];\n                    if (playlistNodeProcessor) {\n                        playlistNodeProcessor(tour, entryNode, ellipsoid);\n                    }\n                    else {\n                        console.log('Unknown KML Tour playlist entry type ' + entryNode.localName);\n                    }\n                }\n            }\n        }\n\n        if (!defined(dataSource.kmlTours)) {\n            dataSource.kmlTours = [];\n        }\n\n        dataSource.kmlTours.push(tour);\n    }\n\n    function processTourUnsupportedNode(tour, entryNode) {\n        oneTimeWarning('KML Tour unsupported node ' + entryNode.localName);\n    }\n\n    function processTourWait(tour, entryNode) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        tour.addPlaylistEntry(new KmlTourWait(duration));\n    }\n\n    function processTourFlyTo(tour, entryNode, ellipsoid) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        var flyToMode = queryStringValue(entryNode, 'flyToMode', namespaces.gx);\n\n        var t = {kml: {}};\n\n        processLookAt(entryNode, t, ellipsoid);\n        processCamera(entryNode, t, ellipsoid);\n\n        var view = t.kml.lookAt || t.kml.camera;\n\n        var flyto = new KmlTourFlyTo(duration, flyToMode, view);\n        tour.addPlaylistEntry(flyto);\n    }\n\n    function processCamera(featureNode, entity, ellipsoid) {\n        var camera = queryFirstNode(featureNode, 'Camera', namespaces.kml);\n        if(defined(camera)) {\n            var lon = defaultValue(queryNumericValue(camera, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(camera, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(camera, 'altitude', namespaces.kml), 0.0);\n\n            var heading = defaultValue(queryNumericValue(camera, 'heading', namespaces.kml), 0.0);\n            var tilt = defaultValue(queryNumericValue(camera, 'tilt', namespaces.kml), 0.0);\n            var roll = defaultValue(queryNumericValue(camera, 'roll', namespaces.kml), 0.0);\n\n            var position = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n            var hpr = HeadingPitchRoll.fromDegrees(heading, tilt - 90.0, roll);\n\n            entity.kml.camera = new KmlCamera(position, hpr);\n        }\n    }\n\n    function processLookAt(featureNode, entity, ellipsoid) {\n        var lookAt = queryFirstNode(featureNode, 'LookAt', namespaces.kml);\n        if(defined(lookAt)) {\n            var lon = defaultValue(queryNumericValue(lookAt, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(lookAt, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(lookAt, 'altitude', namespaces.kml), 0.0);\n            var heading = queryNumericValue(lookAt, 'heading', namespaces.kml);\n            var tilt = queryNumericValue(lookAt, 'tilt', namespaces.kml);\n            var range = defaultValue(queryNumericValue(lookAt, 'range', namespaces.kml), 0.0);\n\n            tilt = CesiumMath.toRadians(defaultValue(tilt, 0.0));\n            heading = CesiumMath.toRadians(defaultValue(heading, 0.0));\n\n            var hpr = new HeadingPitchRange(heading, tilt - CesiumMath.PI_OVER_TWO, range);\n            var viewPoint = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n\n            entity.kml.lookAt = new KmlLookAt(viewPoint, hpr);\n        }\n    }\n\n    function processGroundOverlay(dataSource, groundOverlay, processingData, deferredLoading) {\n        var r = processFeature(dataSource, groundOverlay, processingData);\n        var entity = r.entity;\n\n        var geometry;\n        var isLatLonQuad = false;\n\n        var ellipsoid = dataSource._ellipsoid;\n        var positions = readCoordinates(queryFirstNode(groundOverlay, 'LatLonQuad', namespaces.gx), ellipsoid);\n        var zIndex = queryNumericValue(groundOverlay, 'drawOrder', namespaces.kml);\n        if (defined(positions)) {\n            geometry = createDefaultPolygon();\n            geometry.hierarchy = new PolygonHierarchy(positions);\n            geometry.zIndex = zIndex;\n            entity.polygon = geometry;\n            isLatLonQuad = true;\n        } else {\n            geometry = new RectangleGraphics();\n            geometry.zIndex = zIndex;\n            entity.rectangle = geometry;\n\n            var latLonBox = queryFirstNode(groundOverlay, 'LatLonBox', namespaces.kml);\n            if (defined(latLonBox)) {\n                var west = queryNumericValue(latLonBox, 'west', namespaces.kml);\n                var south = queryNumericValue(latLonBox, 'south', namespaces.kml);\n                var east = queryNumericValue(latLonBox, 'east', namespaces.kml);\n                var north = queryNumericValue(latLonBox, 'north', namespaces.kml);\n\n                if (defined(west)) {\n                    west = CesiumMath.negativePiToPi(CesiumMath.toRadians(west));\n                }\n                if (defined(south)) {\n                    south = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(south));\n                }\n                if (defined(east)) {\n                    east = CesiumMath.negativePiToPi(CesiumMath.toRadians(east));\n                }\n                if (defined(north)) {\n                    north = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(north));\n                }\n                geometry.coordinates = new Rectangle(west, south, east, north);\n\n                var rotation = queryNumericValue(latLonBox, 'rotation', namespaces.kml);\n                if (defined(rotation)) {\n                    var rotationRadians = CesiumMath.toRadians(rotation);\n                    geometry.rotation = rotationRadians;\n                    geometry.stRotation = rotationRadians;\n                }\n            }\n        }\n\n        var iconNode = queryFirstNode(groundOverlay, 'Icon', namespaces.kml);\n        var href = getIconHref(iconNode, dataSource, processingData.sourceResource, processingData.uriResolver, true);\n        if (defined(href)) {\n            if (isLatLonQuad) {\n                oneTimeWarning('kml-gx:LatLonQuad', 'KML - gx:LatLonQuad Icon does not support texture projection.');\n            }\n            var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n            var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n            var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n            var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n            if (defined(x) || defined(y) || defined(w) || defined(h)) {\n                oneTimeWarning('kml-groundOverlay-xywh', 'KML - gx:x, gx:y, gx:w, gx:h aren\\'t supported for GroundOverlays');\n            }\n\n            geometry.material = href;\n            geometry.material.color = queryColorValue(groundOverlay, 'color', namespaces.kml);\n            geometry.material.transparent = true;\n        } else {\n            geometry.material = queryColorValue(groundOverlay, 'color', namespaces.kml);\n        }\n\n        var altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.kml);\n\n        if (defined(altitudeMode)) {\n            if (altitudeMode === 'absolute') {\n                //Use height above ellipsoid until we support MSL.\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode !== 'clampToGround') {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n            // else just use the default of 0 until we support 'clampToGround'\n        } else {\n            altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.gx);\n            if (altitudeMode === 'relativeToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-relativeToSeaFloor', 'KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.');\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode === 'clampToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-clampToSeaFloor', 'KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.');\n            } else if (defined(altitudeMode)) {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n        }\n    }\n\n    function processUnsupportedFeature(dataSource, node, processingData, deferredLoading) {\n        dataSource._unsupportedNode.raiseEvent(dataSource, processingData.parentEntity, node, processingData.entityCollection,\n            processingData.styleCollection, processingData.sourceResource, processingData.uriResolver);\n        oneTimeWarning('kml-unsupportedFeature-' + node.nodeName, 'KML - Unsupported feature: ' + node.nodeName);\n    }\n\n    var RefreshMode = {\n        INTERVAL : 0,\n        EXPIRE : 1,\n        STOP : 2\n    };\n\n    function cleanupString(s) {\n        if (!defined(s) || s.length === 0) {\n            return '';\n        }\n\n        var sFirst = s[0];\n        if (sFirst === '&' || sFirst === '?') {\n            s = s.substring(1);\n        }\n\n        return s;\n    }\n\n    var zeroRectangle = new Rectangle();\n    var scratchCartographic = new Cartographic();\n    var scratchCartesian2 = new Cartesian2();\n    var scratchCartesian3 = new Cartesian3();\n\n    function processNetworkLinkQueryString(resource, camera, canvas, viewBoundScale, bbox, ellipsoid) {\n        function fixLatitude(value) {\n            if (value < -CesiumMath.PI_OVER_TWO) {\n                return -CesiumMath.PI_OVER_TWO;\n            } else if (value > CesiumMath.PI_OVER_TWO) {\n                return CesiumMath.PI_OVER_TWO;\n            }\n            return value;\n        }\n\n        function fixLongitude(value) {\n            if (value > CesiumMath.PI) {\n                return value - CesiumMath.TWO_PI;\n            } else if (value < -CesiumMath.PI) {\n                return value + CesiumMath.TWO_PI;\n            }\n\n            return value;\n        }\n\n        var queryString = objectToQuery(resource.queryParameters);\n\n        // objectToQuery escapes [ and ], so fix that\n        queryString = queryString.replace(/%5B/g, '[').replace(/%5D/g, ']');\n\n        if (defined(camera) && camera._mode !== SceneMode.MORPHING) {\n            var centerCartesian;\n            var centerCartographic;\n\n            bbox = defaultValue(bbox, zeroRectangle);\n            if (defined(canvas)) {\n                scratchCartesian2.x = canvas.clientWidth * 0.5;\n                scratchCartesian2.y = canvas.clientHeight * 0.5;\n                centerCartesian = camera.pickEllipsoid(scratchCartesian2, ellipsoid, scratchCartesian3);\n            }\n\n            if (defined(centerCartesian)) {\n                centerCartographic = ellipsoid.cartesianToCartographic(centerCartesian, scratchCartographic);\n            } else {\n                centerCartographic = Rectangle.center(bbox, scratchCartographic);\n                centerCartesian = ellipsoid.cartographicToCartesian(centerCartographic);\n            }\n\n            if (defined(viewBoundScale) && !CesiumMath.equalsEpsilon(viewBoundScale, 1.0, CesiumMath.EPSILON9)) {\n                var newHalfWidth = bbox.width * viewBoundScale * 0.5;\n                var newHalfHeight = bbox.height * viewBoundScale * 0.5;\n                bbox = new Rectangle(fixLongitude(centerCartographic.longitude - newHalfWidth),\n                    fixLatitude(centerCartographic.latitude - newHalfHeight),\n                    fixLongitude(centerCartographic.longitude + newHalfWidth),\n                    fixLatitude(centerCartographic.latitude + newHalfHeight)\n                );\n            }\n\n            queryString = queryString.replace('[bboxWest]', CesiumMath.toDegrees(bbox.west).toString());\n            queryString = queryString.replace('[bboxSouth]', CesiumMath.toDegrees(bbox.south).toString());\n            queryString = queryString.replace('[bboxEast]', CesiumMath.toDegrees(bbox.east).toString());\n            queryString = queryString.replace('[bboxNorth]', CesiumMath.toDegrees(bbox.north).toString());\n\n            var lon = CesiumMath.toDegrees(centerCartographic.longitude).toString();\n            var lat = CesiumMath.toDegrees(centerCartographic.latitude).toString();\n            queryString = queryString.replace('[lookatLon]', lon);\n            queryString = queryString.replace('[lookatLat]', lat);\n            queryString = queryString.replace('[lookatTilt]', CesiumMath.toDegrees(camera.pitch).toString());\n            queryString = queryString.replace('[lookatHeading]', CesiumMath.toDegrees(camera.heading).toString());\n            queryString = queryString.replace('[lookatRange]', Cartesian3.distance(camera.positionWC, centerCartesian));\n            queryString = queryString.replace('[lookatTerrainLon]', lon);\n            queryString = queryString.replace('[lookatTerrainLat]', lat);\n            queryString = queryString.replace('[lookatTerrainAlt]', centerCartographic.height.toString());\n\n            ellipsoid.cartesianToCartographic(camera.positionWC, scratchCartographic);\n            queryString = queryString.replace('[cameraLon]', CesiumMath.toDegrees(scratchCartographic.longitude).toString());\n            queryString = queryString.replace('[cameraLat]', CesiumMath.toDegrees(scratchCartographic.latitude).toString());\n            queryString = queryString.replace('[cameraAlt]', CesiumMath.toDegrees(scratchCartographic.height).toString());\n\n            var frustum = camera.frustum;\n            var aspectRatio = frustum.aspectRatio;\n            var horizFov = '';\n            var vertFov = '';\n            if (defined(aspectRatio)) {\n                var fov = CesiumMath.toDegrees(frustum.fov);\n                if (aspectRatio > 1.0) {\n                    horizFov = fov;\n                    vertFov = fov / aspectRatio;\n                } else {\n                    vertFov = fov;\n                    horizFov = fov * aspectRatio;\n                }\n            }\n            queryString = queryString.replace('[horizFov]', horizFov.toString());\n            queryString = queryString.replace('[vertFov]', vertFov.toString());\n        } else {\n            queryString = queryString.replace('[bboxWest]', '-180');\n            queryString = queryString.replace('[bboxSouth]', '-90');\n            queryString = queryString.replace('[bboxEast]', '180');\n            queryString = queryString.replace('[bboxNorth]', '90');\n\n            queryString = queryString.replace('[lookatLon]', '');\n            queryString = queryString.replace('[lookatLat]', '');\n            queryString = queryString.replace('[lookatRange]', '');\n            queryString = queryString.replace('[lookatTilt]', '');\n            queryString = queryString.replace('[lookatHeading]', '');\n            queryString = queryString.replace('[lookatTerrainLon]', '');\n            queryString = queryString.replace('[lookatTerrainLat]', '');\n            queryString = queryString.replace('[lookatTerrainAlt]', '');\n\n            queryString = queryString.replace('[cameraLon]', '');\n            queryString = queryString.replace('[cameraLat]', '');\n            queryString = queryString.replace('[cameraAlt]', '');\n            queryString = queryString.replace('[horizFov]', '');\n            queryString = queryString.replace('[vertFov]', '');\n        }\n\n        if (defined(canvas)) {\n            queryString = queryString.replace('[horizPixels]', canvas.clientWidth);\n            queryString = queryString.replace('[vertPixels]', canvas.clientHeight);\n        } else {\n            queryString = queryString.replace('[horizPixels]', '');\n            queryString = queryString.replace('[vertPixels]', '');\n        }\n\n        queryString = queryString.replace('[terrainEnabled]', '1');\n        queryString = queryString.replace('[clientVersion]', '1');\n        queryString = queryString.replace('[kmlVersion]', '2.2');\n        queryString = queryString.replace('[clientName]', 'Cesium');\n        queryString = queryString.replace('[language]', 'English');\n\n        resource.setQueryParameters(queryToObject(queryString));\n    }\n\n    function processNetworkLink(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var networkEntity = r.entity;\n\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var link = queryFirstNode(node, 'Link', namespaces.kml);\n\n        if (!defined(link)) {\n            link = queryFirstNode(node, 'Url', namespaces.kml);\n        }\n        if (defined(link)) {\n            var href = queryStringValue(link, 'href', namespaces.kml);\n            var viewRefreshMode;\n            var viewBoundScale;\n            if (defined(href)) {\n                var newSourceUri = href;\n                href = resolveHref(href, sourceResource, processingData.uriResolver);\n\n                // We need to pass in the original path if resolveHref returns a data uri because the network link\n                //  references a document in a KMZ archive\n                if (/^data:/.test(href.getUrlComponent())) {\n                    // So if sourceUri isn't the kmz file, then its another kml in the archive, so resolve it\n                    if (!/\\.kmz/i.test(sourceResource.getUrlComponent())) {\n                        newSourceUri = sourceResource.getDerivedResource({\n                            url: newSourceUri\n                        });\n                    }\n                } else {\n                    newSourceUri = href.clone(); // Not a data uri so use the fully qualified uri\n                    viewRefreshMode = queryStringValue(link, 'viewRefreshMode', namespaces.kml);\n                    viewBoundScale = defaultValue(queryStringValue(link, 'viewBoundScale', namespaces.kml), 1.0);\n                    var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n                    var viewFormat = defaultValue(queryStringValue(link, 'viewFormat', namespaces.kml), defaultViewFormat);\n                    var httpQuery = queryStringValue(link, 'httpQuery', namespaces.kml);\n                    if (defined(viewFormat)) {\n                        href.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n                    }\n                    if (defined(httpQuery)) {\n                        href.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n                    }\n\n                    var ellipsoid = dataSource._ellipsoid;\n                    processNetworkLinkQueryString(href, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n                }\n\n                var options = {\n                    sourceUri : newSourceUri,\n                    uriResolver : uriResolver,\n                    context : networkEntity.id\n                };\n                var networkLinkCollection = new EntityCollection();\n                var promise = load(dataSource, networkLinkCollection, href, options).then(function(rootElement) {\n                    var entities = dataSource._entityCollection;\n                    var newEntities = networkLinkCollection.values;\n                    entities.suspendEvents();\n                    for (var i = 0; i < newEntities.length; i++) {\n                        var newEntity = newEntities[i];\n                        if (!defined(newEntity.parent)) {\n                            newEntity.parent = networkEntity;\n                            mergeAvailabilityWithParent(newEntity);\n                        }\n\n                        entities.add(newEntity);\n                    }\n                    entities.resumeEvents();\n\n                    // Add network links to a list if we need they will need to be updated\n                    var refreshMode = queryStringValue(link, 'refreshMode', namespaces.kml);\n                    var refreshInterval = defaultValue(queryNumericValue(link, 'refreshInterval', namespaces.kml), 0);\n                    if ((refreshMode === 'onInterval' && refreshInterval > 0 ) || (refreshMode === 'onExpire') || (viewRefreshMode === 'onStop')) {\n                        var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n                        var hasNetworkLinkControl = defined(networkLinkControl);\n\n                        var now = JulianDate.now();\n                        var networkLinkInfo = {\n                            id : createGuid(),\n                            href : href,\n                            cookie : {},\n                            lastUpdated : now,\n                            updating : false,\n                            entity : networkEntity,\n                            viewBoundScale : viewBoundScale,\n                            needsUpdate : false,\n                            cameraUpdateTime : now\n                        };\n\n                        var minRefreshPeriod = 0;\n                        if (hasNetworkLinkControl) {\n                            networkLinkInfo.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                            minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n                        }\n\n                        if (refreshMode === 'onInterval') {\n                            if (hasNetworkLinkControl) {\n                                refreshInterval = Math.max(minRefreshPeriod, refreshInterval);\n                            }\n                            networkLinkInfo.refreshMode = RefreshMode.INTERVAL;\n                            networkLinkInfo.time = refreshInterval;\n                        } else if (refreshMode === 'onExpire') {\n                            var expires;\n                            if (hasNetworkLinkControl) {\n                                expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                            }\n                            if (defined(expires)) {\n                                try {\n                                    var date = JulianDate.fromIso8601(expires);\n                                    var diff = JulianDate.secondsDifference(date, now);\n                                    if (diff > 0 && diff < minRefreshPeriod) {\n                                        JulianDate.addSeconds(now, minRefreshPeriod, date);\n                                    }\n                                    networkLinkInfo.refreshMode = RefreshMode.EXPIRE;\n                                    networkLinkInfo.time = date;\n                                } catch (e) {\n                                    oneTimeWarning('kml-refreshMode-onInterval-onExpire', 'KML - NetworkLinkControl expires is not a valid date');\n                                }\n                            } else {\n                                oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                            }\n                        } else if (dataSource._camera) { // Only allow onStop refreshes if we have a camera\n                            networkLinkInfo.refreshMode = RefreshMode.STOP;\n                            networkLinkInfo.time = defaultValue(queryNumericValue(link, 'viewRefreshTime', namespaces.kml), 0);\n                        } else {\n                            oneTimeWarning('kml-refrehMode-onStop-noCamera', 'A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource');\n                        }\n\n                        if (defined(networkLinkInfo.refreshMode)) {\n                            dataSource._networkLinks.set(networkLinkInfo.id, networkLinkInfo);\n                        }\n                    } else if (viewRefreshMode === 'onRegion') {\n                        oneTimeWarning('kml-refrehMode-onRegion', 'KML - Unsupported viewRefreshMode: onRegion');\n                    }\n                }).otherwise(function(error) {\n                    oneTimeWarning('An error occured during loading ' + href.url);\n                    dataSource._error.raiseEvent(dataSource, error);\n                });\n\n                deferredLoading.addPromise(promise);\n            }\n        }\n    }\n\n    function processFeatureNode(dataSource, node, processingData, deferredLoading) {\n        var featureProcessor = featureTypes[node.localName];\n        if (defined(featureProcessor)) {\n            return featureProcessor(dataSource, node, processingData, deferredLoading);\n        }\n\n        return processUnsupportedFeature(dataSource, node, processingData, deferredLoading);\n    }\n\n    function loadKml(dataSource, entityCollection, kml, sourceResource, uriResolver, context) {\n        entityCollection.removeAll();\n\n        var documentElement = kml.documentElement;\n        var document = documentElement.localName === 'Document' ? documentElement : queryFirstNode(documentElement, 'Document', namespaces.kml);\n        var name = queryStringValue(document, 'name', namespaces.kml);\n        if (!defined(name)) {\n            name = getFilenameFromUri(sourceResource.getUrlComponent());\n        }\n\n        // Only set the name from the root document\n        if (!defined(dataSource._name)) {\n            dataSource._name = name;\n        }\n\n        var deferredLoading = new KmlDataSource._DeferredLoading(dataSource);\n        var styleCollection = new EntityCollection(dataSource);\n        return when.all(processStyles(dataSource, kml, styleCollection, sourceResource, false, uriResolver)).then(function() {\n            var element = kml.documentElement;\n            if (element.localName === 'kml') {\n                var childNodes = element.childNodes;\n                for (var i = 0; i < childNodes.length; i++) {\n                    var tmp = childNodes[i];\n                    if (defined(featureTypes[tmp.localName])) {\n                        element = tmp;\n                        break;\n                    }\n                }\n            }\n\n            var processingData = {\n                parentEntity: undefined,\n                entityCollection: entityCollection,\n                styleCollection: styleCollection,\n                sourceResource: sourceResource,\n                uriResolver: uriResolver,\n                context: context\n            };\n\n            entityCollection.suspendEvents();\n            processFeatureNode(dataSource, element, processingData, deferredLoading);\n            entityCollection.resumeEvents();\n\n            return deferredLoading.wait()\n                .then(function() {\n                    return kml.documentElement;\n                });\n        });\n    }\n\n    function loadKmz(dataSource, entityCollection, blob, sourceResource) {\n        var deferred = when.defer();\n        zip.createReader(new zip.BlobReader(blob), function(reader) {\n            reader.getEntries(function(entries) {\n                var promises = [];\n                var uriResolver = {};\n                var docEntry;\n                var docDefer;\n                for (var i = 0; i < entries.length; i++) {\n                    var entry = entries[i];\n                    if (!entry.directory) {\n                        var innerDefer = when.defer();\n                        promises.push(innerDefer.promise);\n                        if (/\\.kml$/i.test(entry.filename)) {\n                            // We use the first KML document we come across\n                            //  https://developers.google.com/kml/documentation/kmzarchives\n                            // Unless we come across a .kml file at the root of the archive because GE does this\n                            if (!defined(docEntry) || !/\\//i.test(entry.filename)) {\n                                if (defined(docEntry)) {\n                                    // We found one at the root so load the initial kml as a data uri\n                                    loadDataUriFromZip(docEntry, uriResolver, docDefer);\n                                }\n                                docEntry = entry;\n                                docDefer = innerDefer;\n                            } else {\n                                // Wasn't the first kml and wasn't at the root\n                                loadDataUriFromZip(entry, uriResolver, innerDefer);\n                            }\n                        } else {\n                            loadDataUriFromZip(entry, uriResolver, innerDefer);\n                        }\n                    }\n                }\n\n                // Now load the root KML document\n                if (defined(docEntry)) {\n                    loadXmlFromZip(docEntry, uriResolver, docDefer);\n                }\n                when.all(promises).then(function() {\n                    reader.close();\n                    if (!defined(uriResolver.kml)) {\n                        deferred.reject(new RuntimeError('KMZ file does not contain a KML document.'));\n                        return;\n                    }\n                    uriResolver.keys = Object.keys(uriResolver);\n                    return loadKml(dataSource, entityCollection, uriResolver.kml, sourceResource, uriResolver);\n                }).then(deferred.resolve).otherwise(deferred.reject);\n            });\n        }, function(e) {\n            deferred.reject(e);\n        });\n\n        return deferred.promise;\n    }\n\n    function load(dataSource, entityCollection, data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var sourceUri = options.sourceUri;\n        var uriResolver = options.uriResolver;\n        var context = options.context;\n\n        var promise = data;\n        if (typeof data === 'string' || (data instanceof Resource)) {\n            data = Resource.createIfNeeded(data);\n            promise = data.fetchBlob();\n            sourceUri = defaultValue(sourceUri, data.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = data.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        } else {\n            sourceUri = defaultValue(sourceUri, Resource.DEFAULT.clone());\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        return when(promise)\n            .then(function(dataToLoad) {\n                if (dataToLoad instanceof Blob) {\n                    return isZipFile(dataToLoad).then(function(isZip) {\n                        if (isZip) {\n                            return loadKmz(dataSource, entityCollection, dataToLoad, sourceUri);\n                        }\n                        return readBlobAsText(dataToLoad).then(function(text) {\n                            //There's no official way to validate if a parse was successful.\n                            //The following check detects the error on various browsers.\n\n                            //Insert missing namespaces\n                            text = insertNamespaces(text);\n\n                            //Remove Duplicate Namespaces\n                            text = removeDuplicateNamespaces(text);\n\n                            //IE raises an exception\n                            var kml;\n                            var error;\n                            try {\n                                kml = parser.parseFromString(text, 'application/xml');\n                            } catch (e) {\n                                error = e.toString();\n                            }\n\n                            //The parse succeeds on Chrome and Firefox, but the error\n                            //handling is different in each.\n                            if (defined(error) || kml.body || kml.documentElement.tagName === 'parsererror') {\n                                //Firefox has error information as the firstChild nodeValue.\n                                var msg = defined(error) ? error : kml.documentElement.firstChild.nodeValue;\n\n                                //Chrome has it in the body text.\n                                if (!msg) {\n                                    msg = kml.body.innerText;\n                                }\n\n                                //Return the error\n                                throw new RuntimeError(msg);\n                            }\n                            return loadKml(dataSource, entityCollection, kml, sourceUri, uriResolver, context);\n                        });\n                    });\n                }\n                return loadKml(dataSource, entityCollection, dataToLoad, sourceUri, uriResolver, context);\n            })\n            .otherwise(function(error) {\n                dataSource._error.raiseEvent(dataSource, error);\n                console.log(error);\n                return when.reject(error);\n            });\n    }\n\n    /**\n     * A {@link DataSource} which processes Keyhole Markup Language 2.2 (KML).\n     * <p>\n     * KML support in Cesium is incomplete, but a large amount of the standard,\n     * as well as Google's <code>gx</code> extension namespace, is supported. See Github issue\n     * {@link https://github.com/CesiumGS/cesium/issues/873|#873} for a\n     * detailed list of what is and isn't support. Cesium will also write information to the\n     * console when it encounters most unsupported features.\n     * </p>\n     * <p>\n     * Non visual feature data, such as <code>atom:author</code> and <code>ExtendedData</code>\n     * is exposed via an instance of {@link KmlFeatureData}, which is added to each {@link Entity}\n     * under the <code>kml</code> property.\n     * </p>\n     *\n     * @alias KmlDataSource\n     * @constructor\n     *\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @see {@link http://www.opengeospatial.org/standards/kml/|Open Geospatial Consortium KML Standard}\n     * @see {@link https://developers.google.com/kml/|Google KML Documentation}\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=KML.html|Cesium Sandcastle KML Demo}\n     *\n     * @example\n     * var viewer = new Cesium.Viewer('cesiumContainer');\n     * viewer.dataSources.add(Cesium.KmlDataSource.load('../../SampleData/facilities.kmz',\n     *      {\n     *           camera: viewer.scene.camera,\n     *           canvas: viewer.scene.canvas\n     *      })\n     * );\n     */\n    function KmlDataSource(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var camera = options.camera;\n        var canvas = options.canvas;\n\n        \n\n        this._changed = new Event();\n        this._error = new Event();\n        this._loading = new Event();\n        this._refresh = new Event();\n        this._unsupportedNode = new Event();\n\n        this._clock = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._name = undefined;\n        this._isLoading = false;\n        this._pinBuilder = new PinBuilder();\n        this._networkLinks = new AssociativeArray();\n        this._entityCluster = new EntityCluster();\n\n        this._canvas = canvas;\n        this._camera = camera;\n        this._lastCameraView = {\n            position : defined(camera) ? Cartesian3.clone(camera.positionWC) : undefined,\n            direction : defined(camera) ? Cartesian3.clone(camera.directionWC) : undefined,\n            up : defined(camera) ? Cartesian3.clone(camera.upWC) : undefined,\n            bbox : defined(camera) ? camera.computeViewRectangle() : Rectangle.clone(Rectangle.MAX_VALUE)\n        };\n\n        this._ellipsoid = defaultValue(options.ellipsoid, Ellipsoid.WGS84);\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        this._credit = credit;\n\n        // Create a list of Credit's from the resource that the user can't remove\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided KML data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to a new KmlDataSource instance once the KML is loaded.\n     */\n    KmlDataSource.load = function(data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var dataSource = new KmlDataSource(options);\n        return dataSource.load(data, options);\n    };\n\n    Object.defineProperties(KmlDataSource.prototype, {\n        /**\n         * Gets or sets a human-readable name for this instance.\n         * This will be automatically be set to the KML document name on load.\n         * @memberof KmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            },\n            set : function(value) {\n                if (this._name !== value) {\n                    this._name = value;\n                    this._changed.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded KML. This represents the total\n         * availability interval for all time-dynamic data. If the KML does not contain\n         * time-dynamic data, this value is undefined.\n         * @memberof KmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source refreshes a network link.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        refreshEvent : {\n            get : function() {\n                return this._refresh;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source finds an unsupported node type.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        unsupportedNodeEvent : {\n            get : function() {\n                return this._unsupportedNode;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof KmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Asynchronously loads the provided KML data, replacing any existing data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground. If true, lines will use corridors so use Entity.corridor instead of Entity.polyline.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to this instances once the KML is loaded.\n     */\n    KmlDataSource.prototype.load = function(data, options) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        DataSource.setLoading(this, true);\n\n        var oldName = this._name;\n        this._name = undefined;\n        this._clampToGround = defaultValue(options.clampToGround, false);\n\n        var that = this;\n        return load(this, this._entityCollection, data, options).then(function() {\n            var clock;\n\n            var availability = that._entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var date;\n\n                //If start is min time just start at midnight this morning, local time\n                if (isMinStart) {\n                    date = new Date();\n                    date.setHours(0, 0, 0, 0);\n                    start = JulianDate.fromDate(date);\n                }\n\n                //If stop is max value just stop at midnight tonight, local time\n                if (isMaxStop) {\n                    date = new Date();\n                    date.setHours(24, 0, 0, 0);\n                    stop = JulianDate.fromDate(date);\n                }\n\n                clock = new DataSourceClock();\n                clock.startTime = start;\n                clock.stopTime = stop;\n                clock.currentTime = JulianDate.clone(start);\n                clock.clockRange = ClockRange.LOOP_STOP;\n                clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                clock.multiplier = Math.round(Math.min(Math.max(JulianDate.secondsDifference(stop, start) / 60, 1), 3.15569e7));\n            }\n\n            var changed = false;\n            if (clock !== that._clock) {\n                that._clock = clock;\n                changed = true;\n            }\n\n            if (oldName !== that._name) {\n                changed = true;\n            }\n\n            if (changed) {\n                that._changed.raiseEvent(that);\n            }\n\n            DataSource.setLoading(that, false);\n\n            return that;\n        }).otherwise(function(error) {\n            DataSource.setLoading(that, false);\n            that._error.raiseEvent(that, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    };\n\n    function mergeAvailabilityWithParent(child) {\n        var parent = child.parent;\n        if (defined(parent)) {\n            var parentAvailability = parent.availability;\n            if (defined(parentAvailability)) {\n                var childAvailability = child.availability;\n                if (defined(childAvailability)) {\n                    childAvailability.intersect(parentAvailability);\n                } else {\n                    child.availability = parentAvailability;\n                }\n            }\n        }\n    }\n\n    function getNetworkLinkUpdateCallback(dataSource, networkLink, newEntityCollection, networkLinks, processedHref) {\n        return function(rootElement) {\n            if (!networkLinks.contains(networkLink.id)) {\n                // Got into the odd case where a parent network link was updated while a child\n                //  network link update was in flight, so just throw it away.\n                return;\n            }\n            var remove = false;\n            var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n            var hasNetworkLinkControl = defined(networkLinkControl);\n\n            var minRefreshPeriod = 0;\n            if (hasNetworkLinkControl) {\n                if (defined(queryFirstNode(networkLinkControl, 'Update', namespaces.kml))) {\n                    oneTimeWarning('kml-networkLinkControl-update', 'KML - NetworkLinkControl updates aren\\'t supported.');\n                    networkLink.updating = false;\n                    networkLinks.remove(networkLink.id);\n                    return;\n                }\n                networkLink.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n            }\n\n            var now = JulianDate.now();\n            var refreshMode = networkLink.refreshMode;\n            if (refreshMode === RefreshMode.INTERVAL) {\n                if (defined(networkLinkControl)) {\n                    networkLink.time = Math.max(minRefreshPeriod, networkLink.time);\n                }\n            } else if (refreshMode === RefreshMode.EXPIRE) {\n                var expires;\n                if (defined(networkLinkControl)) {\n                    expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                }\n                if (defined(expires)) {\n                    try {\n                        var date = JulianDate.fromIso8601(expires);\n                        var diff = JulianDate.secondsDifference(date, now);\n                        if (diff > 0 && diff < minRefreshPeriod) {\n                            JulianDate.addSeconds(now, minRefreshPeriod, date);\n                        }\n                        networkLink.time = date;\n                    } catch (e) {\n                        oneTimeWarning('kml-networkLinkControl-expires', 'KML - NetworkLinkControl expires is not a valid date');\n                        remove = true;\n                    }\n                } else {\n                    oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                    remove = true;\n                }\n            }\n\n            var networkLinkEntity = networkLink.entity;\n            var entityCollection = dataSource._entityCollection;\n            var newEntities = newEntityCollection.values;\n\n            function removeChildren(entity) {\n                entityCollection.remove(entity);\n                var children = entity._children;\n                var count = children.length;\n                for (var i = 0; i < count; ++i) {\n                    removeChildren(children[i]);\n                }\n            }\n\n            // Remove old entities\n            entityCollection.suspendEvents();\n            var entitiesCopy = entityCollection.values.slice();\n            var i;\n            for (i = 0; i < entitiesCopy.length; ++i) {\n                var entityToRemove = entitiesCopy[i];\n                if (entityToRemove.parent === networkLinkEntity) {\n                    entityToRemove.parent = undefined;\n                    removeChildren(entityToRemove);\n                }\n            }\n            entityCollection.resumeEvents();\n\n            // Add new entities\n            entityCollection.suspendEvents();\n            for (i = 0; i < newEntities.length; i++) {\n                var newEntity = newEntities[i];\n                if (!defined(newEntity.parent)) {\n                    newEntity.parent = networkLinkEntity;\n                    mergeAvailabilityWithParent(newEntity);\n                }\n                entityCollection.add(newEntity);\n            }\n            entityCollection.resumeEvents();\n\n            // No refresh information remove it, otherwise update lastUpdate time\n            if (remove) {\n                networkLinks.remove(networkLink.id);\n            } else {\n                networkLink.lastUpdated = now;\n            }\n\n            var availability = entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var clock = dataSource._clock;\n\n                if (clock.startTime !== start || clock.stopTime !== stop) {\n                    clock.startTime = start;\n                    clock.stopTime = stop;\n                    dataSource._changed.raiseEvent(dataSource);\n                }\n            }\n\n            networkLink.updating = false;\n            networkLink.needsUpdate = false;\n            dataSource._refresh.raiseEvent(dataSource, processedHref.getUrlComponent(true));\n        };\n    }\n\n    var entitiesToIgnore = new AssociativeArray();\n\n    /**\n     * Updates any NetworkLink that require updating\n     * @function\n     *\n     * @param {JulianDate} time The simulation time.\n     * @returns {Boolean} True if this data source is ready to be displayed at the provided time, false otherwise.\n     */\n    KmlDataSource.prototype.update = function(time) {\n        var networkLinks = this._networkLinks;\n        if (networkLinks.length === 0) {\n            return true;\n        }\n\n        var now = JulianDate.now();\n        var that = this;\n\n        entitiesToIgnore.removeAll();\n\n        function recurseIgnoreEntities(entity) {\n            var children = entity._children;\n            var count = children.length;\n            for (var i = 0; i < count; ++i) {\n                var child = children[i];\n                entitiesToIgnore.set(child.id, child);\n                recurseIgnoreEntities(child);\n            }\n        }\n\n        var cameraViewUpdate = false;\n        var lastCameraView = this._lastCameraView;\n        var camera = this._camera;\n        if (defined(camera) &&\n            !(camera.positionWC.equalsEpsilon(lastCameraView.position, CesiumMath.EPSILON7) &&\n            camera.directionWC.equalsEpsilon(lastCameraView.direction, CesiumMath.EPSILON7) &&\n            camera.upWC.equalsEpsilon(lastCameraView.up, CesiumMath.EPSILON7))) {\n\n            // Camera has changed so update the last view\n            lastCameraView.position = Cartesian3.clone(camera.positionWC);\n            lastCameraView.direction = Cartesian3.clone(camera.directionWC);\n            lastCameraView.up = Cartesian3.clone(camera.upWC);\n            lastCameraView.bbox = camera.computeViewRectangle();\n            cameraViewUpdate = true;\n        }\n\n        var newNetworkLinks = new AssociativeArray();\n        var changed = false;\n        networkLinks.values.forEach(function(networkLink) {\n            var entity = networkLink.entity;\n            if (entitiesToIgnore.contains(entity.id)) {\n                return;\n            }\n\n            if (!networkLink.updating) {\n                var doUpdate = false;\n                if (networkLink.refreshMode === RefreshMode.INTERVAL) {\n                    if (JulianDate.secondsDifference(now, networkLink.lastUpdated) > networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n                else if (networkLink.refreshMode === RefreshMode.EXPIRE) {\n                    if (JulianDate.greaterThan(now, networkLink.time)) {\n                        doUpdate = true;\n                    }\n\n                } else if (networkLink.refreshMode === RefreshMode.STOP) {\n                    if (cameraViewUpdate) {\n                        networkLink.needsUpdate = true;\n                        networkLink.cameraUpdateTime = now;\n                    }\n\n                    if (networkLink.needsUpdate && JulianDate.secondsDifference(now, networkLink.cameraUpdateTime) >= networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n\n                if (doUpdate) {\n                    recurseIgnoreEntities(entity);\n                    networkLink.updating = true;\n                    var newEntityCollection = new EntityCollection();\n                    var href = networkLink.href.clone();\n\n                    href.setQueryParameters(networkLink.cookie);\n                    var ellipsoid = defaultValue(that._ellipsoid, Ellipsoid.WGS84);\n                    processNetworkLinkQueryString(href, that._camera, that._canvas, networkLink.viewBoundScale, lastCameraView.bbox, ellipsoid);\n\n                    load(that, newEntityCollection, href, {context : entity.id})\n                        .then(getNetworkLinkUpdateCallback(that, networkLink, newEntityCollection, newNetworkLinks, href))\n                        .otherwise(function(error) {\n                            var msg = 'NetworkLink ' + networkLink.href + ' refresh failed: ' + error;\n                            console.log(msg);\n                            that._error.raiseEvent(that, msg);\n                        });\n                    changed = true;\n                }\n            }\n            newNetworkLinks.set(networkLink.id, networkLink);\n        });\n\n        if (changed) {\n            this._networkLinks = newNetworkLinks;\n            this._changed.raiseEvent(this);\n        }\n\n        return true;\n    };\n\n    /**\n     * Contains KML Feature data loaded into the <code>Entity.kml</code> property by {@link KmlDataSource}.\n     * @alias KmlFeatureData\n     * @constructor\n     */\n    function KmlFeatureData() {\n        /**\n         * Gets the atom syndication format author field.\n         * @type Object\n         */\n        this.author = {\n            /**\n             * Gets the name.\n             * @type String\n             * @alias author.name\n             * @memberof! KmlFeatureData#\n             * @property author.name\n             */\n            name : undefined,\n            /**\n             * Gets the URI.\n             * @type String\n             * @alias author.uri\n             * @memberof! KmlFeatureData#\n             * @property author.uri\n             */\n            uri : undefined,\n            /**\n             * Gets the email.\n             * @type String\n             * @alias author.email\n             * @memberof! KmlFeatureData#\n             * @property author.email\n             */\n            email : undefined\n        };\n\n        /**\n         * Gets the link.\n         * @type Object\n         */\n        this.link = {\n            /**\n             * Gets the href.\n             * @type String\n             * @alias link.href\n             * @memberof! KmlFeatureData#\n             * @property link.href\n             */\n            href : undefined,\n            /**\n             * Gets the language of the linked resource.\n             * @type String\n             * @alias link.hreflang\n             * @memberof! KmlFeatureData#\n             * @property link.hreflang\n             */\n            hreflang : undefined,\n            /**\n             * Gets the link relation.\n             * @type String\n             * @alias link.rel\n             * @memberof! KmlFeatureData#\n             * @property link.rel\n             */\n            rel : undefined,\n            /**\n             * Gets the link type.\n             * @type String\n             * @alias link.type\n             * @memberof! KmlFeatureData#\n             * @property link.type\n             */\n            type : undefined,\n            /**\n             * Gets the link title.\n             * @type String\n             * @alias link.title\n             * @memberof! KmlFeatureData#\n             * @property link.title\n             */\n            title : undefined,\n            /**\n             * Gets the link length.\n             * @type String\n             * @alias link.length\n             * @memberof! KmlFeatureData#\n             * @property link.length\n             */\n            length : undefined\n        };\n\n        /**\n         * Gets the unstructured address field.\n         * @type String\n         */\n        this.address = undefined;\n        /**\n         * Gets the phone number.\n         * @type String\n         */\n        this.phoneNumber = undefined;\n        /**\n         * Gets the snippet.\n         * @type String\n         */\n        this.snippet = undefined;\n        /**\n         * Gets the extended data, parsed into a JSON object.\n         * Currently only the <code>Data</code> property is supported.\n         * <code>SchemaData</code> and custom data are ignored.\n         * @type String\n         */\n        this.extendedData = undefined;\n    }\n\n    // For testing\n    KmlDataSource._DeferredLoading = DeferredLoading;\n    KmlDataSource._getTimestamp = getTimestamp;\n\nexport default KmlDataSource;\n"],"sourceRoot":""}